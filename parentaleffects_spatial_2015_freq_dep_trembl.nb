(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    237552,       6461]
NotebookOptionsPosition[    224222,       6082]
NotebookOutlinePosition[    224665,       6100]
CellTagsIndexPosition[    224622,       6097]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Parental effects when selection is frequency-dependent", "Title",
 CellChangeTimes->{3.6818996774622307`*^9}],

Cell["Bram Kuijper & Rufus A. Johnstone", "Text",
 CellChangeTimes->{{3.682098419373761*^9, 3.682098425405418*^9}}],

Cell[CellGroupData[{

Cell["Functions and parameters", "Section",
 CellChangeTimes->{{3.684050105851204*^9, 3.684050108010929*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.681924447829236*^9, 3.681924455422717*^9}}],

Cell[CellGroupData[{

Cell["Probability of producing a hawk type offspring", "Subsection",
 CellChangeTimes->{{3.684050269632327*^9, 3.684050286911909*^9}}],

Cell["\<\
With probability 1-\[Epsilon], an individual will have the proper information \
about its own state, so it uses the strategy corresponding to its state. \
However, with probability \[Epsilon], it makes an error in assessing its own \
state, so is equally likely to use one of the three strategies that do not \
correspond to its actual state. Such 'trembling hand' probabilities assure \
convergence to the proper equilibria\
\>", "Text",
 CellChangeTimes->{{3.684050149122243*^9, 3.684050215297123*^9}, {
  3.690104183285851*^9, 3.690104202781234*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ph", "[", 
   RowBox[{"statefocal_", ",", "stateother_"}], "]"}], ":=", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"statefocal", ",", "stateother"}], "}"}], ",", "h"}], "]"}], 
     "\[Equal]", "2"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "err"}], ")"}], 
      RowBox[{"phh", "[", "2", "]"}]}], "+", 
     RowBox[{
      FractionBox["err", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pdh", "[", "0", "]"}], "+", 
        RowBox[{"pdh", "[", "1", "]"}], "+", 
        RowBox[{"phh", "[", "1", "]"}], "+", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}]}]}], ",", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", "statefocal", "}"}], ",", "h"}], "]"}], "\[Equal]", "1"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "err"}], ")"}], 
      RowBox[{"phh", "[", "1", "]"}]}], "+", 
     RowBox[{
      FractionBox["err", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pdh", "[", "0", "]"}], "+", 
        RowBox[{"pdh", "[", "1", "]"}], "+", 
        RowBox[{"phh", "[", "1", "]"}], "+", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"statefocal", ",", "stateother"}], "}"}], ",", "d"}], "]"}], 
     "\[Equal]", "2"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "err"}], ")"}], 
      RowBox[{"pdh", "[", "0", "]"}]}], "+", 
     RowBox[{
      FractionBox["err", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pdh", "[", "0", "]"}], "+", 
        RowBox[{"pdh", "[", "1", "]"}], "+", 
        RowBox[{"phh", "[", "1", "]"}], "+", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", "statefocal", "}"}], ",", "d"}], "]"}], "\[Equal]", "1"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "err"}], ")"}], 
      RowBox[{"pdh", "[", "1", "]"}]}], "+", 
     RowBox[{
      FractionBox["err", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pdh", "[", "0", "]"}], "+", 
        RowBox[{"pdh", "[", "1", "]"}], "+", 
        RowBox[{"phh", "[", "1", "]"}], "+", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.68404956158158*^9, 3.684049616729436*^9}, {
   3.684049791430171*^9, 3.684049820598483*^9}, {3.684049851477421*^9, 
   3.6840499022472887`*^9}, {3.684049956478529*^9, 3.684050076115114*^9}, 
   3.684050279134152*^9, {3.684051210313464*^9, 3.684051210961623*^9}, {
   3.68405555384797*^9, 3.684055581568616*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dph", "[", 
   RowBox[{"statefocal_", ",", "stateother_"}], "]"}], ":=", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"statefocal", ",", "stateother"}], "}"}], ",", "h"}], "]"}], 
     "\[Equal]", "2"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "err"}], ")"}], 
      RowBox[{"\[Delta]phh", "[", "2", "]"}]}], "+", 
     RowBox[{
      FractionBox["err", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Delta]pdh", "[", "0", "]"}], "+", 
        RowBox[{"\[Delta]pdh", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]phh", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]phh", "[", "2", "]"}]}], ")"}]}]}], ",", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", "statefocal", "}"}], ",", "h"}], "]"}], "\[Equal]", "1"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "err"}], ")"}], 
      RowBox[{"\[Delta]phh", "[", "1", "]"}]}], "+", 
     RowBox[{
      FractionBox["err", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Delta]pdh", "[", "0", "]"}], "+", 
        RowBox[{"\[Delta]pdh", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]phh", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]phh", "[", "2", "]"}]}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"statefocal", ",", "stateother"}], "}"}], ",", "d"}], "]"}], 
     "\[Equal]", "2"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "err"}], ")"}], 
      RowBox[{"\[Delta]pdh", "[", "0", "]"}]}], "+", 
     RowBox[{
      FractionBox["err", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Delta]pdh", "[", "0", "]"}], "+", 
        RowBox[{"\[Delta]pdh", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]phh", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]phh", "[", "2", "]"}]}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", "statefocal", "}"}], ",", "d"}], "]"}], "\[Equal]", "1"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "err"}], ")"}], 
      RowBox[{"\[Delta]pdh", "[", "1", "]"}]}], "+", 
     RowBox[{
      FractionBox["err", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Delta]pdh", "[", "0", "]"}], "+", 
        RowBox[{"\[Delta]pdh", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]phh", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]phh", "[", "2", "]"}]}], ")"}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.68404956158158*^9, 3.684049616729436*^9}, {
   3.684049791430171*^9, 3.684049820598483*^9}, {3.684049851477421*^9, 
   3.6840499022472887`*^9}, {3.684049956478529*^9, 3.684050076115114*^9}, {
   3.684050226582571*^9, 3.684050232559411*^9}, 3.684050280773467*^9, {
   3.684050316060474*^9, 3.684050358172432*^9}, {3.6840512076581297`*^9, 
   3.684051208275051*^9}, {3.6840568114228773`*^9, 3.684056847877692*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Patch frequencies", "Section",
 CellChangeTimes->{{3.68189965661395*^9, 3.6818996615808*^9}}],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "i"], TraditionalForm]]],
 " is the frequency of patches with ",
 StyleBox["i",
  FontSlant->"Italic"],
 " \[Element] {0,1,2} hawks and hence 2-",
 StyleBox["i",
  FontSlant->"Italic"],
 " doves."
}], "Text",
 CellChangeTimes->{{3.6819018342879744`*^9, 3.681901910549037*^9}, {
  3.681904152530301*^9, 3.681904152644826*^9}}],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", 
    RowBox[{"h", ",", "i"}]], TraditionalForm]]],
 " is the probability that a juvenile hawk is winning the vacant breeding \
spot in a patch which originally consisted of ",
 StyleBox["i",
  FontSlant->"Italic"],
 " hawks and hence 2-",
 StyleBox["i",
  FontSlant->"Italic"],
 " doves before mortality of one of the breeders. We divide everything by two \
as the total number of competing juveniles = (1-d) * ((px + 1-px) + (px + \
1-px)) + d * ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["f", "0"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " * 2 * (px + 1-px) + ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "1"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " * 2 * (px + 1-px) + ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "2"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " * 2 * ",
 "(px + 1-px)",
 ") = 2"
}], "Text",
 CellChangeTimes->{{3.6819039840971107`*^9, 3.681904066643919*^9}, {
  3.690115803825152*^9, 3.690115816846404*^9}, {3.690395401406747*^9, 
  3.69039549088083*^9}, {3.690395532136087*^9, 3.690395595932664*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bh", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"i", " ", 
          RowBox[{"ph", "[", 
           RowBox[{"h", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "\[Equal]", "1"}], ",", "d", ",", "h"}], "]"}]}], 
           "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "-", "i"}], ")"}], 
          RowBox[{"ph", "[", 
           RowBox[{"d", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "\[Equal]", "1"}], ",", "h", ",", "d"}], "]"}]}], 
           "]"}]}]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", 
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "==", "1"}], ",", "d", ",", "h"}], "]"}]}], 
              "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                "]"}]}], "]"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], "/", 
    "2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819039713714046`*^9, 3.681903978612687*^9}, {
  3.6819040771926947`*^9, 3.6819041023390837`*^9}, {3.681904163060503*^9, 
  3.681904270122064*^9}, {3.681904300185986*^9, 3.681904444729485*^9}, {
  3.6840508300520687`*^9, 3.68405086794526*^9}, {3.6840509309222307`*^9, 
  3.684050951728066*^9}, {3.684050983010207*^9, 3.6840510098942957`*^9}, {
  3.684051045216721*^9, 3.6840510468951178`*^9}}],

Cell["change in patches containing 0 hawks:", "Text",
 CellChangeTimes->{{3.681904530319077*^9, 3.6819045397030687`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"df0dt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"mh", "[", "1", "]"}], " ", 
     RowBox[{"f", "[", "1", "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"bh", "[", "1", "]"}]}], ")"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"md", "[", "0", "]"}], 
     RowBox[{"f", "[", "0", "]"}], 
     RowBox[{"bh", "[", "0", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681901913515662*^9, 3.681901919598167*^9}, {
  3.681902804112299*^9, 3.681902829255541*^9}, {3.681903958613819*^9, 
  3.681903963357703*^9}, {3.681904139317212*^9, 3.681904149933847*^9}, {
  3.6819044709174433`*^9, 3.6819045247990437`*^9}}],

Cell["change in patches containing 1 hawk:", "Text",
 CellChangeTimes->{{3.681904542038992*^9, 3.681904547814187*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"df1dt", "=", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"md", "[", "0", "]"}], 
     RowBox[{"f", "[", "0", "]"}], 
     RowBox[{"bh", "[", "0", "]"}]}], "+", 
    RowBox[{"2", 
     RowBox[{"mh", "[", "2", "]"}], 
     RowBox[{"f", "[", "2", "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"bh", "[", "2", "]"}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"mh", "[", "1", "]"}], 
     RowBox[{"f", "[", "1", "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"bh", "[", "1", "]"}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"md", "[", "1", "]"}], 
     RowBox[{"f", "[", "1", "]"}], 
     RowBox[{"bh", "[", "1", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819045488015738`*^9, 3.681904559170224*^9}, {
   3.681904591904851*^9, 3.681904600038515*^9}, {3.681905069986167*^9, 
   3.681905101778099*^9}, 3.681910678497465*^9}],

Cell["change in patches containing 2 hawks:", "Text",
 CellChangeTimes->{{3.6819075017920513`*^9, 3.6819075089205437`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"df2dt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"md", "[", "1", "]"}], 
     RowBox[{"f", "[", "1", "]"}], 
     RowBox[{"bh", "[", "1", "]"}]}], "-", 
    RowBox[{"2", 
     RowBox[{"mh", "[", "2", "]"}], 
     RowBox[{"f", "[", "2", "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"bh", "[", "2", "]"}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819075099561577`*^9, 3.6819075109303007`*^9}, {
  3.681910636246025*^9, 3.68191068067453*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfconstraint", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", "0", "]"}], "+", 
     RowBox[{"f", "[", "1", "]"}], "+", 
     RowBox[{"f", "[", "2", "]"}]}], "\[Equal]", "1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681923972397983*^9, 3.681923989853321*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans", "[", 
   RowBox[{
    RowBox[{"{", "ds_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"mh1_", ",", "mh2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"md0_", ",", "md1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"phh1_", ",", "phh2_", ",", "pdh0_", ",", "pdh1_"}], "}"}], ",", 
    
    RowBox[{"{", "\[Epsilon]_", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dfconstraint", ",", 
       RowBox[{"df1dt", "\[Equal]", "0"}], ",", 
       RowBox[{"df2dt", "\[Equal]", "0"}]}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"d", "\[Rule]", "ds"}], ",", 
       RowBox[{
        RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "mh1"}], ",", 
       RowBox[{
        RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "mh2"}], ",", 
       RowBox[{
        RowBox[{"md", "[", "0", "]"}], "\[Rule]", "md0"}], ",", 
       RowBox[{
        RowBox[{"md", "[", "1", "]"}], "\[Rule]", "md1"}], ",", 
       RowBox[{
        RowBox[{"md", "[", "2", "]"}], "\[Rule]", "md2"}], ",", 
       RowBox[{
        RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "phh1"}], ",", 
       RowBox[{
        RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "phh2"}], ",", 
       RowBox[{
        RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "pdh0"}], ",", 
       RowBox[{
        RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "pdh1"}], ",", 
       RowBox[{"err", "\[Rule]", "\[Epsilon]"}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "[", "0", "]"}], ",", 
      RowBox[{"1", "/", "3"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "[", "1", "]"}], ",", 
      RowBox[{"1", "/", "3"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "[", "2", "]"}], ",", 
      RowBox[{"1", "/", "3"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.681924118975501*^9, 3.681924156790517*^9}, {
  3.6819243122794027`*^9, 3.6819244818605423`*^9}, {3.681924517699847*^9, 
  3.681924534250153*^9}, {3.6840510767059526`*^9, 3.684051102297209*^9}, {
  3.684051290573268*^9, 3.684051324237236*^9}, {3.684055418536881*^9, 
  3.6840554219436207`*^9}, {3.690396265123137*^9, 3.690396289502267*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansalt", "[", 
   RowBox[{
    RowBox[{"{", "ds_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"mh1_", ",", "mh2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"md0_", ",", "md1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"phh1_", ",", "phh2_", ",", "pdh0_", ",", "pdh1_"}], "}"}], ",", 
    
    RowBox[{"{", "\[Epsilon]_", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"df0dt", "\[Equal]", "0"}], ",", 
       RowBox[{"df1dt", "\[Equal]", "0"}], ",", "dfconstraint"}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"d", "\[Rule]", "ds"}], ",", 
       RowBox[{
        RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "mh1"}], ",", 
       RowBox[{
        RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "mh2"}], ",", 
       RowBox[{
        RowBox[{"md", "[", "0", "]"}], "\[Rule]", "md0"}], ",", 
       RowBox[{
        RowBox[{"md", "[", "1", "]"}], "\[Rule]", "md1"}], ",", 
       RowBox[{
        RowBox[{"md", "[", "2", "]"}], "\[Rule]", "md2"}], ",", 
       RowBox[{
        RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "phh1"}], ",", 
       RowBox[{
        RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "phh2"}], ",", 
       RowBox[{
        RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "pdh0"}], ",", 
       RowBox[{
        RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "pdh1"}], ",", 
       RowBox[{"err", "\[Rule]", "\[Epsilon]"}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "[", "0", "]"}], ",", 
      RowBox[{"1", "/", "3"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "[", "1", "]"}], ",", 
      RowBox[{"1", "/", "3"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "[", "2", "]"}], ",", 
      RowBox[{"1", "/", "3"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.681924118975501*^9, 3.681924156790517*^9}, {
  3.6819243122794027`*^9, 3.6819244818605423`*^9}, {3.681924517699847*^9, 
  3.681924534250153*^9}, {3.681924565464492*^9, 3.681924593605667*^9}, {
  3.68200883114145*^9, 3.6820088312578363`*^9}, {3.684051086017952*^9, 
  3.684051110577001*^9}, {3.68405126927043*^9, 3.684051326339697*^9}, {
  3.6840554115931683`*^9, 3.684055415350945*^9}, {3.69039629554104*^9, 
  3.6903963020743637`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vx", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cx", "=", "0.2"}], ";"}]}], "Input",
 CellChangeTimes->{{3.68236123575275*^9, 3.682361245898793*^9}, {
  3.682411311012822*^9, 3.6824113134751883`*^9}, {3.690395912419448*^9, 
  3.690395913386785*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans", "[", 
  RowBox[{
   RowBox[{"{", "1.0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.75", ",", "1.275"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.875", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "0.5", ",", "0.3", ",", "0.4"}], "}"}], ",", 
   RowBox[{"{", "0.05", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6840512384308643`*^9, 3.6840512612458057`*^9}, {
  3.684054147010518*^9, 3.6840541473277273`*^9}, {3.690396304416255*^9, 
  3.690396306080844*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "0", "]"}], "\[Rule]", "0.43576984288528525`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", "1", "]"}], "\[Rule]", "0.4766176505771073`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", "2", "]"}], "\[Rule]", "0.08761250653760752`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6840512394022827`*^9, 3.684051261777645*^9}, 
   3.6840513336780567`*^9, 3.684053128920824*^9, 3.684054022665802*^9, 
   3.684054147999116*^9, 3.68405467871943*^9, 3.6840548241754293`*^9, 
   3.684054905003276*^9, 3.6840550078010798`*^9, 3.684055120945958*^9, 
   3.68405519380398*^9, 3.684055262726862*^9, 3.6840553746861877`*^9, 
   3.6840554319160137`*^9, 3.6840555932331963`*^9, 3.684057225945133*^9, 
   3.684059043151601*^9, 3.684060966549691*^9, 3.684061743220078*^9, 
   3.690267380095055*^9, 3.6902777790359793`*^9, 3.690292662985847*^9, 
   3.690369431921707*^9, 3.69039631939956*^9, 3.6903964171130533`*^9, 
   3.690397822242042*^9, 3.6904354082920837`*^9, 3.6904583619693613`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ansalt", "[", 
  RowBox[{
   RowBox[{"{", "1.0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.75", ",", "1.275"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.875", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "0.5", ",", "0.3", ",", "0.4"}], "}"}], ",", 
   RowBox[{"{", "0.05", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6819244867924747`*^9, 3.681924613239189*^9}, {
   3.6823384887850313`*^9, 3.682338488956525*^9}, {3.682338600628825*^9, 
   3.68233860443326*^9}, {3.682583980871499*^9, 3.682583982550872*^9}, {
   3.684051121226376*^9, 3.684051123025075*^9}, {3.6840512636793547`*^9, 
   3.684051264773897*^9}, {3.6840541502916813`*^9, 3.6840541508555326`*^9}, 
   3.690396311361999*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "0", "]"}], "\[Rule]", "0.43576984288528525`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", "1", "]"}], "\[Rule]", "0.4766176505771073`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", "2", "]"}], "\[Rule]", "0.08761250653760752`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6819245522259073`*^9, 3.681924615821735*^9}, 
   3.681926870831225*^9, {3.681928244463222*^9, 3.681928258248083*^9}, {
   3.682006505568344*^9, 3.68200653536981*^9}, 3.682006644064026*^9, {
   3.682006775439999*^9, 3.682006788362774*^9}, 3.682006826763332*^9, 
   3.6820069810580473`*^9, {3.682007119954248*^9, 3.6820071371740437`*^9}, {
   3.682007221068923*^9, 3.6820072418383083`*^9}, 3.6820073472384787`*^9, 
   3.6820074567725277`*^9, 3.682007544733746*^9, 3.682007646515525*^9, 
   3.682008293446879*^9, 3.68200883665275*^9, 3.682009896333275*^9, 
   3.6820099587828093`*^9, {3.6820154010983562`*^9, 3.6820154209843807`*^9}, 
   3.68209325692372*^9, 3.682094538599547*^9, 3.682094818166445*^9, 
   3.682094968278758*^9, 3.682097638630952*^9, 3.682147217990324*^9, 
   3.68214728893102*^9, 3.682147419568635*^9, 3.6821580452874537`*^9, 
   3.682158082363327*^9, 3.68215908409638*^9, 3.682159128818781*^9, 
   3.682159180091772*^9, 3.682159403664535*^9, 3.6821607726187677`*^9, {
   3.6821609091916437`*^9, 3.682160936826367*^9}, 3.682161203545829*^9, 
   3.682161516435955*^9, 3.682161568683557*^9, 3.68232751208876*^9, 
   3.682328817671764*^9, 3.6823384893732*^9, {3.682338601179194*^9, 
   3.682338604874834*^9}, 3.682360884714677*^9, 3.682362214049869*^9, 
   3.682399328955291*^9, 3.682402016398294*^9, 3.682411309257737*^9, 
   3.682411358355455*^9, 3.682583989573161*^9, 3.682593317443838*^9, 
   3.682610370154532*^9, 3.682610678940941*^9, 3.6826107094395943`*^9, 
   3.682680756137733*^9, 3.682685994128495*^9, 3.68275270248948*^9, 
   3.682756709097239*^9, 3.682756761360654*^9, 3.6827572406953506`*^9, 
   3.682760329591195*^9, 3.6829300883799543`*^9, 3.682945411827475*^9, 
   3.6829579517718887`*^9, 3.682958003681329*^9, 3.682959516786428*^9, 
   3.6829611565510817`*^9, 3.6830075540584183`*^9, 3.6830075867367268`*^9, 
   3.683007627661615*^9, 3.684042724683947*^9, 3.684051128561358*^9, 
   3.6840512305006447`*^9, 3.6840512651652107`*^9, 3.684051333722705*^9, 
   3.684053128962764*^9, 3.684054022721218*^9, 3.6840541513749857`*^9, 
   3.684054678753543*^9, 3.684054824233872*^9, 3.6840549050591593`*^9, 
   3.684055007863554*^9, 3.6840551210109367`*^9, 3.684055193862143*^9, 
   3.684055262770403*^9, 3.684055374736802*^9, 3.684055431953965*^9, 
   3.684055593277775*^9, 3.684057225986519*^9, 3.684059043184778*^9, 
   3.684060966680551*^9, 3.68406174324677*^9, 3.690267380141623*^9, 
   3.69027777908422*^9, 3.690292663029478*^9, 3.6903694319465733`*^9, 
   3.690396319429922*^9, 3.690396417156823*^9, 3.690397822296885*^9, 
   3.6904354083181133`*^9, 3.690458362006263*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Reproductive values", "Section",
 CellChangeTimes->{{3.681924625327195*^9, 3.6819246284621964`*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Dynamics of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", 
    RowBox[{"h", ",", "1"}]], TraditionalForm]]],
 ", the reproductive value of a focal hawk in a patch with a dove"
}], "Subsection",
 CellChangeTimes->{{3.681925845874449*^9, 3.681925917621695*^9}}],

Cell["\<\
Mortality of focal hawk and replaced by focal\[CloseCurlyQuote]s offspring of \
type dove (producing a hawk would result in no change in RV)\
\>", "Text",
 CellChangeTimes->{{3.6819259258548727`*^9, 3.681925945317912*^9}, {
  3.681927660932111*^9, 3.681927698193883*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt1", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ph", "[", 
       RowBox[{"h", ",", "d"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], "-", 
      RowBox[{"vh", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68192594726071*^9, 3.681925971758462*^9}, {
   3.6819260190855913`*^9, 3.681926130947208*^9}, {3.681926435242239*^9, 
   3.681926436818954*^9}, 3.681926482730927*^9, 3.682009057140668*^9, {
   3.684051384509453*^9, 3.684051388779916*^9}}],

Cell["Mortality of focal hawk and replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.68192633677034*^9, 3.681926359617897*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt2", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}], "+", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"vh", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681926361613797*^9, 3.6819263784774847`*^9}, {
   3.681926413492546*^9, 3.681926481130086*^9}, 3.682009059069139*^9}],

Cell["\<\
Mortality of the nonfocal dove and replaced by focal\[CloseCurlyQuote]s \
offspring of type dove\
\>", "Text",
 CellChangeTimes->{{3.681926317859852*^9, 3.681926334348077*^9}, 
   3.681926544690075*^9, {3.681926579360045*^9, 3.681926583510888*^9}, {
   3.681926636969471*^9, 3.6819266700431433`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt3", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ph", "[", 
       RowBox[{"h", ",", "d"}], "]"}]}], ")"}], 
    RowBox[{"vd", "[", "1", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681926485767674*^9, 3.6819264890139637`*^9}, {
   3.68192652486548*^9, 3.68192659653953*^9}, {3.681926628842537*^9, 
   3.681926682312171*^9}, {3.681926718791271*^9, 3.681926718817273*^9}, 
   3.682009060228359*^9, {3.682097592047633*^9, 3.68209759532474*^9}, 
   3.6840513971330748`*^9}],

Cell["\<\
Mortality of the nonfocal dove and replaced by focal\[CloseCurlyQuote]s \
offspring of type hawk\
\>", "Text",
 CellChangeTimes->{{3.681926317859852*^9, 3.681926334348077*^9}, 
   3.681926544690075*^9, {3.681926579360045*^9, 3.681926583510888*^9}, {
   3.681926697907278*^9, 3.681926699041252*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt4", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"ph", "[", 
     RowBox[{"h", ",", "d"}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"vh", "[", "2", "]"}]}], "-", 
      RowBox[{"vh", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681926485767674*^9, 3.6819264890139637`*^9}, {
   3.68192652486548*^9, 3.68192659653953*^9}, {3.681926628842537*^9, 
   3.6819266565170918`*^9}, 3.6820090618934*^9, 3.684051414453136*^9}],

Cell["\<\
Mortality of the nonfocal dove and replaced by nonfocal offspring of type hawk\
\>", "Text",
 CellChangeTimes->{{3.681926606554904*^9, 3.681926619259595*^9}, {
  3.681926733120963*^9, 3.681926735911662*^9}, {3.681927427092368*^9, 
  3.681927430092204*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt5", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"ph", "[", 
        RowBox[{"d", ",", "h"}], "]"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], "d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", 
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "d", ",", "h"}], 
                "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                "]"}]}], "]"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], "-", 
      RowBox[{"vh", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681926485767674*^9, 3.6819264890139637`*^9}, {
   3.68192652486548*^9, 3.68192659653953*^9}, {3.681926628842537*^9, 
   3.6819266565170918`*^9}, {3.6819267201356573`*^9, 3.681926784796221*^9}, {
   3.68192683930256*^9, 3.6819268756409187`*^9}, {3.681927243839273*^9, 
   3.6819273106996517`*^9}, {3.68200774527532*^9, 3.682007748906412*^9}, 
   3.682009063583851*^9, {3.684051420303596*^9, 3.684051456742074*^9}}],

Cell["\<\
Mortality of a remote hawk, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.6820091009966784`*^9, 3.6820091353626547`*^9}, {
  3.6820094084444447`*^9, 3.68200940878259*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt6", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], "k", " ", 
      RowBox[{"mh", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"h", ",", "d"}], "]"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "-", "1", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "d"}], "]"}]}], ")"}], 
         RowBox[{"vd", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820091378039627`*^9, 3.682009165972104*^9}, {
  3.682009196189785*^9, 3.6820092024320917`*^9}, {3.682009253476973*^9, 
  3.6820094372537603`*^9}, {3.68405149686185*^9, 3.684051505754917*^9}}],

Cell["\<\
Mortality of a remote dove, replaced by focal\[CloseCurlyQuote]s offspring \
\>", "Text",
 CellChangeTimes->{{3.682009384878317*^9, 3.682009395964232*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt7", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{"2", "-", "k"}], ")"}], " ", 
      RowBox[{"md", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"h", ",", "d"}], "]"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "d"}], "]"}]}], ")"}], 
         RowBox[{"vd", "[", "k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820093785847588`*^9, 3.682009382762863*^9}, {
  3.682009453671788*^9, 3.682009482504977*^9}, {3.684051510323995*^9, 
  3.68405151433932*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt", "=", 
   RowBox[{
   "dvh1dt1", "+", "dvh1dt2", "+", "dvh1dt3", "+", "dvh1dt4", "+", "dvh1dt5", 
    "+", "dvh1dt6", "+", "dvh1dt7"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819273292045794`*^9, 3.68192735687001*^9}, {
  3.682009488406528*^9, 3.682009495179122*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"md", "[", "1", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"md", "[", "0", "]"}], "\[Rule]", "m"}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.682097350179871*^9, 3.6820974696683493`*^9}, {
   3.682097517004548*^9, 3.682097520418336*^9}, 3.682097569106885*^9}],

Cell[BoxData[
 RowBox[{"d", " ", "m", " ", "v", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"f", "[", "0", "]"}], "+", 
    RowBox[{"f", "[", "1", "]"}], "+", 
    RowBox[{"f", "[", "2", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.684054678827107*^9, 3.684054824329323*^9, 
  3.684054905161017*^9, 3.684055007964148*^9, 3.684055121140687*^9, 
  3.684055193953126*^9, 3.684055262850893*^9, 3.6840553748299913`*^9, 
  3.684055432037038*^9, 3.684055593363665*^9, 3.684057226053115*^9, 
  3.684059043333147*^9, 3.6840609667475357`*^9, 3.684061743299694*^9, 
  3.69026738023944*^9, 3.690277779224806*^9, 3.6902926631451263`*^9, 
  3.69036943212773*^9, 3.690396417244822*^9, 3.690397822408772*^9, 
  3.6904354083942137`*^9, 3.6904583621587257`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dvh1dt", "/.", 
  RowBox[{"err", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.6840544188602448`*^9, 3.68405442538225*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"phh", "[", "1", "]"}]}], ")"}], " ", 
   RowBox[{"vd", "[", "1", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"phh", "[", "1", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"vd", "[", "0", "]"}], "-", 
     RowBox[{"vh", "[", "1", "]"}]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "d"}], "2"], "+", "d"}], ")"}], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"vh", "[", "1", "]"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"f", "[", "0", "]"}], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], " ", 
      RowBox[{"vh", "[", "1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "d", " ", 
   RowBox[{"f", "[", "1", "]"}], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], " ", 
      RowBox[{"vh", "[", "1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], " ", 
      RowBox[{"pdh", "[", "1", "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "0", "]"}], " ", 
         RowBox[{"pdh", "[", "0", "]"}]}], "+", 
        RowBox[{
         RowBox[{"f", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pdh", "[", "1", "]"}], "+", 
           RowBox[{"phh", "[", "1", "]"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "2", "]"}], " ", 
         RowBox[{"phh", "[", "2", "]"}]}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"vh", "[", "1", "]"}]}], "+", 
     RowBox[{"vh", "[", "2", "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"phh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"vh", "[", "1", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "d", " ", 
   RowBox[{"f", "[", "1", "]"}], " ", 
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"f", "[", "2", "]"}], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.684054420986073*^9, 3.68405442577022*^9}, 
   3.684054678854322*^9, 3.68405482433598*^9, 3.684054905213125*^9, 
   3.684055008016711*^9, 3.684055121147274*^9, 3.684055193994128*^9, 
   3.684055262857312*^9, 3.684055374876996*^9, 3.684055432043661*^9, 
   3.6840555933702602`*^9, 3.684057226084339*^9, 3.684059043356599*^9, 
   3.684060966777378*^9, 3.6840617433203087`*^9, 3.6902673802728786`*^9, 
   3.690277779275333*^9, 3.6902926631821823`*^9, 3.690369432161086*^9, 
   3.690396417281654*^9, 3.690397822414469*^9, 3.690435408419449*^9, 
   3.690458362198513*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Dynamics of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", 
    RowBox[{"d", ",", "1"}]], TraditionalForm]]],
 ", the reproductive value of a focal dove in a patch with a hawk"
}], "Subsection",
 CellChangeTimes->{{3.681925845874449*^9, 3.681925917621695*^9}, {
  3.6819276385562973`*^9, 3.681927643012681*^9}}],

Cell["\<\
Mortality of focal dove and replaced by focal\[CloseCurlyQuote]s offspring of \
type hawk\
\>", "Text",
 CellChangeTimes->{{3.681927646083029*^9, 3.68192766542691*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt1", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"ph", "[", 
     RowBox[{"d", ",", "h"}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], "-", 
      RowBox[{"vd", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819277026703978`*^9, 3.681927753911727*^9}, 
   3.68200906607246*^9, {3.684051580361616*^9, 3.684051587431323*^9}}],

Cell["Mortality of focal dove and replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.6819277589352093`*^9, 3.6819277678851347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt2", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}], "+", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"vd", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681927755599751*^9, 3.681927786037052*^9}, 
   3.682009067510016*^9}],

Cell["\<\
Mortality of nonfocal hawk and replaced by focal\[CloseCurlyQuote]s offspring \
of type hawk\
\>", "Text",
 CellChangeTimes->{{3.681927788198155*^9, 3.681927802268944*^9}, {
  3.6820047639760857`*^9, 3.682004764423377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt3", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"ph", "[", 
     RowBox[{"d", ",", "h"}], "]"}], 
    RowBox[{"vh", "[", "1", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819278039339848`*^9, 3.681927820192936*^9}, {
   3.681928010710494*^9, 3.681928022314131*^9}, 3.682009069053135*^9, 
   3.684051600343844*^9}],

Cell["\<\
Mortality of nonfocal hawk and replaced by focal\[CloseCurlyQuote]s offspring \
of type dove\
\>", "Text",
 CellChangeTimes->{{3.6819280252425003`*^9, 3.681928037744994*^9}, {
  3.681928107885906*^9, 3.68192810830996*^9}, {3.6820047654005413`*^9, 
  3.68200476557555*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt4", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ph", "[", 
       RowBox[{"d", ",", "h"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"vd", "[", "0", "]"}]}], "-", 
      RowBox[{"vd", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819280389798*^9, 3.681928097445298*^9}, 
   3.682009071318041*^9, {3.684052701313354*^9, 3.684052703662073*^9}}],

Cell["\<\
Mortality of the nonfocal hawk and replacement by nonfocal offspring of type \
dove\
\>", "Text",
 CellChangeTimes->{{3.6819281009568357`*^9, 3.681928127780846*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt5", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"ph", "[", 
          RowBox[{"h", ",", "d"}], "]"}]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ph", "[", 
                RowBox[{"h", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[Equal]", "1"}], ",", "d", ",", "h"}], 
                  "]"}]}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ph", "[", 
                RowBox[{"d", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                  "]"}]}], "]"}]}], ")"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], "-", 
      RowBox[{"vd", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681928129058757*^9, 3.681928229584217*^9}, {
  3.682009923518659*^9, 3.682009924206077*^9}, {3.684052713305813*^9, 
  3.684052739104916*^9}}],

Cell["\<\
Mortality of a remote hawk, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.6820096937515078`*^9, 3.68200970705304*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt6", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], "k", " ", 
      RowBox[{"mh", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"d", ",", "h"}], "]"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "-", "1", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ph", "[", 
            RowBox[{"d", ",", "h"}], "]"}]}], ")"}], 
         RowBox[{"vd", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682009716340624*^9, 3.682009741633101*^9}, {
  3.6840528841486473`*^9, 3.6840528873713093`*^9}}],

Cell["\<\
Mortality of a remote dove, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.682009751237131*^9, 3.682009760131051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt7", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{"2", "-", "k"}], ")"}], " ", 
      RowBox[{"md", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"d", ",", "h"}], "]"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ph", "[", 
            RowBox[{"d", ",", "h"}], "]"}]}], ")"}], 
         RowBox[{"vd", "[", "k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820093785847588`*^9, 3.682009382762863*^9}, {
  3.682009453671788*^9, 3.682009482504977*^9}, {3.682009770942122*^9, 
  3.682009781881384*^9}, {3.684052895604027*^9, 3.684052899291123*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt", "=", 
   RowBox[{
   "dvd1dt1", "+", "dvd1dt2", "+", "dvd1dt3", "+", "dvd1dt4", "+", "dvd1dt5", 
    "+", "dvd1dt6", "+", "dvd1dt7"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681928234441332*^9, 3.681928255802907*^9}, {
  3.682009785510764*^9, 3.682009790254716*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"md", "[", "1", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"md", "[", "0", "]"}], "\[Rule]", "m"}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.682097350179871*^9, 3.6820974696683493`*^9}, {
   3.682097517004548*^9, 3.682097520418336*^9}, 3.682097569106885*^9, {
   3.684053624419018*^9, 3.684053624604224*^9}}],

Cell[BoxData[
 RowBox[{"d", " ", "m", " ", "v", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"f", "[", "0", "]"}], "+", 
    RowBox[{"f", "[", "1", "]"}], "+", 
    RowBox[{"f", "[", "2", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.682097394191738*^9, {3.682097433845416*^9, 3.6820974700497913`*^9}, 
   3.682097521768173*^9, 3.682097569636636*^9, 3.682097601255558*^9, 
   3.6820976387372847`*^9, 3.682147218065579*^9, 3.682147288994258*^9, 
   3.682147419631425*^9, 3.682158045404702*^9, 3.68215808243069*^9, 
   3.682159084138859*^9, 3.682159128870865*^9, 3.682159180190117*^9, 
   3.682159403816338*^9, 3.6821607726694727`*^9, {3.6821609092370462`*^9, 
   3.68216093688869*^9}, 3.68216156874249*^9, 3.682327512165533*^9, 
   3.682328817726317*^9, 3.682362214177524*^9, 3.682399329072505*^9, 
   3.6824020165568*^9, 3.682411358533057*^9, 3.682584004969041*^9, 
   3.682593317519157*^9, 3.68261037022357*^9, 3.6826106790237007`*^9, 
   3.682610709661532*^9, 3.682680756290577*^9, 3.682685994244418*^9, 
   3.682752702572382*^9, 3.6827567092338047`*^9, 3.682756761428021*^9, 
   3.6827572408686647`*^9, 3.68276032969995*^9, 3.682930088482012*^9, 
   3.682945411884973*^9, 3.682957951861155*^9, 3.682958003862389*^9, 
   3.6829595169027777`*^9, 3.682961156630199*^9, 3.683007554178211*^9, 
   3.683007586843975*^9, 3.683007627769696*^9, 3.684042724756995*^9, 
   3.684051538214769*^9, 3.6840531290276623`*^9, 3.684053625139312*^9, 
   3.684054022891851*^9, 3.6840546789157667`*^9, 3.684054824421649*^9, 
   3.684054905305853*^9, 3.6840550081503773`*^9, 3.684055121314452*^9, 
   3.6840551940719233`*^9, 3.684055262934355*^9, 3.684055375050241*^9, 
   3.6840554321241198`*^9, 3.684055593454432*^9, 3.68405722613518*^9, 
   3.684059043413371*^9, 3.684060966826501*^9, 3.684061743361086*^9, 
   3.690267380338931*^9, 3.690277779337598*^9, 3.6902926632679453`*^9, 
   3.690369432248801*^9, 3.690396417361436*^9, 3.690397822561039*^9, 
   3.690435408484241*^9, 3.6904583622690563`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dvd1dt", "/.", 
  RowBox[{"err", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.684054661101465*^9, 3.684054673041004*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "1", "]"}]}], ")"}]}], "+", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "0", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"pdh", "[", "0", "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"f", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "-", 
           RowBox[{"pdh", "[", "1", "]"}], "-", 
           RowBox[{"phh", "[", "1", "]"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"phh", "[", "2", "]"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"vd", "[", "0", "]"}], "-", 
     RowBox[{"vd", "[", "1", "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"pdh", "[", "1", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "-", 
     RowBox[{"vd", "[", "1", "]"}]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "d"}], "2"], "+", "d"}], ")"}], " ", 
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"vd", "[", "1", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"pdh", "[", "1", "]"}], " ", 
   RowBox[{"vh", "[", "1", "]"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"f", "[", "0", "]"}], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"pdh", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], " ", 
      RowBox[{"vh", "[", "1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "d", " ", 
   RowBox[{"f", "[", "1", "]"}], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"pdh", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], " ", 
      RowBox[{"vh", "[", "1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"pdh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{"vh", "[", "2", "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "d", " ", 
   RowBox[{"f", "[", "1", "]"}], " ", 
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"pdh", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"f", "[", "2", "]"}], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"pdh", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.684054665899289*^9, 3.684054678920968*^9}, 
   3.6840548244281073`*^9, 3.684054905360785*^9, 3.684055008208132*^9, 
   3.6840551213545027`*^9, 3.684055194078199*^9, 3.6840552629405622`*^9, 
   3.684055375060198*^9, 3.6840554321303988`*^9, 3.684055593460711*^9, 
   3.684057226159148*^9, 3.684059043435792*^9, 3.6840609668509073`*^9, 
   3.6840617433787947`*^9, 3.690267380343773*^9, 3.690277779375139*^9, 
   3.690292663274581*^9, 3.690369432256613*^9, 3.690396417365705*^9, 
   3.690397822622465*^9, 3.690435408491411*^9, 3.690458362301083*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Dynamics of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", 
    RowBox[{"d", ",", "0"}]], TraditionalForm]]],
 ", the reproductive value of a focal dove in a patch with another dove"
}], "Subsection",
 CellChangeTimes->{{3.681928472202375*^9, 3.6819284868668833`*^9}}],

Cell["\<\
Mortality of focal dove, replaced by focal\[CloseCurlyQuote]s offspring of \
type hawk\
\>", "Text",
 CellChangeTimes->{{3.6819285036646957`*^9, 3.681928516554496*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt1", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"ph", "[", 
     RowBox[{"d", ",", "d"}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "-", 
      RowBox[{"vd", "[", "0", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681928488000746*^9, 3.681928535190276*^9}, {
  3.682008123544552*^9, 3.682008123743497*^9}, {3.6820099290143433`*^9, 
  3.682009929445161*^9}, {3.6820940048913813`*^9, 3.6820940051399307`*^9}, {
  3.684052921906323*^9, 3.684052923208544*^9}}],

Cell["Mortality of focal dove, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.681928537408855*^9, 3.68192854448831*^9}, {
  3.6819286771859627`*^9, 3.681928681520582*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt2", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}], "+", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"vd", "[", "0", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68192854640654*^9, 3.6819285603331327`*^9}, {
   3.68192866864113*^9, 3.6819286875374327`*^9}, 3.682006840764783*^9, {
   3.682009934024764*^9, 3.682009934468092*^9}}],

Cell["\<\
Mortality of nonfocal dove, replaced by focal\[CloseCurlyQuote]s offspring of \
type dove;\
\>", "Text",
 CellChangeTimes->{{3.68192869093843*^9, 3.681928711842268*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt3", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ph", "[", 
       RowBox[{"d", ",", "d"}], "]"}]}], ")"}], 
    RowBox[{"vd", "[", "0", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681928713865307*^9, 3.681928725483062*^9}, {
   3.6820047252771378`*^9, 3.682004746184661*^9}, 3.682005489217371*^9, {
   3.682008081799137*^9, 3.6820080916422997`*^9}, {3.6820081270402927`*^9, 
   3.682008127216434*^9}, {3.6820099356762047`*^9, 3.68200993705604*^9}, 
   3.684052928689547*^9}],

Cell["\<\
Mortality of nonfocal dove, replaced by focal\[CloseCurlyQuote]s offspring of \
type hawk;\
\>", "Text",
 CellChangeTimes->{{3.681928570567319*^9, 3.681928579606635*^9}, {
  3.6820047541665077`*^9, 3.6820047854705877`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt4", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"ph", "[", 
     RowBox[{"d", ",", "d"}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "+", 
      RowBox[{"vd", "[", "1", "]"}], "-", 
      RowBox[{"vd", "[", "0", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682004786630179*^9, 3.6820047933450336`*^9}, {
   3.68200487190224*^9, 3.68200488725364*^9}, 3.682005488213191*^9, {
   3.682008096919821*^9, 3.682008098044466*^9}, {3.6820081280839376`*^9, 
   3.682008128264373*^9}, {3.6820099390011463`*^9, 3.6820099394410963`*^9}, 
   3.6840529323860826`*^9}],

Cell["\<\
Mortality of nonfocal dove, replaced by nonfocal offspring of type hawk;\
\>", "Text",
 CellChangeTimes->{{3.682004953995056*^9, 3.682004965059964*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt5", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"ph", "[", 
        RowBox[{"d", ",", "d"}], "]"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", 
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "d", ",", "h"}], 
                "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                "]"}]}], "]"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], "-", 
      RowBox[{"vd", "[", "0", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68200496609521*^9, 3.682005090648181*^9}, 
   3.682005487388914*^9, {3.6820099436493692`*^9, 3.682009944105322*^9}, {
   3.684052935284096*^9, 3.684052964131206*^9}}],

Cell["\<\
Mortality of a remote hawk, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.6820096937515078`*^9, 3.68200970705304*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt6", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], "k", " ", 
      RowBox[{"mh", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"d", ",", "d"}], "]"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "-", "1", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ph", "[", 
            RowBox[{"d", ",", "d"}], "]"}]}], ")"}], 
         RowBox[{"vd", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682009716340624*^9, 3.682009741633101*^9}, {
  3.6820098070745173`*^9, 3.682009827951312*^9}, {3.684052972202599*^9, 
  3.6840529816896772`*^9}}],

Cell["\<\
Mortality of a remote dove, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.682009751237131*^9, 3.682009760131051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt7", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{"2", "-", "k"}], ")"}], " ", 
      RowBox[{"md", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"d", ",", "d"}], "]"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ph", "[", 
            RowBox[{"d", ",", "d"}], "]"}]}], ")"}], 
         RowBox[{"vd", "[", "k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820093785847588`*^9, 3.682009382762863*^9}, {
  3.682009453671788*^9, 3.682009482504977*^9}, {3.682009770942122*^9, 
  3.682009831013*^9}, {3.684052984834188*^9, 3.6840529880733147`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt", "=", 
   RowBox[{
   "dvd0dt1", "+", "dvd0dt2", "+", "dvd0dt3", "+", "dvd0dt4", "+", "dvd0dt5", 
    "+", "dvd0dt6", "+", "dvd0dt7"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820051000674963`*^9, 3.682005113434269*^9}, {
  3.682009833362094*^9, 3.682009839901073*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"md", "[", "1", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"md", "[", "0", "]"}], "\[Rule]", "m"}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.682097350179871*^9, 3.6820974696683493`*^9}, {
   3.682097517004548*^9, 3.682097520418336*^9}, 3.682097569106885*^9, {
   3.684053630628634*^9, 3.684053631379121*^9}}],

Cell[BoxData[
 RowBox[{"d", " ", "m", " ", "v", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"f", "[", "0", "]"}], "+", 
    RowBox[{"f", "[", "1", "]"}], "+", 
    RowBox[{"f", "[", "2", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.682097394191738*^9, {3.682097433845416*^9, 3.6820974700497913`*^9}, 
   3.682097521768173*^9, 3.682097569636636*^9, 3.682097601255558*^9, 
   3.6820976387372847`*^9, 3.682147218065579*^9, 3.682147288994258*^9, 
   3.682147419631425*^9, 3.682158045404702*^9, 3.68215808243069*^9, 
   3.682159084138859*^9, 3.682159128870865*^9, 3.682159180190117*^9, 
   3.682159403816338*^9, 3.6821607726694727`*^9, {3.6821609092370462`*^9, 
   3.68216093688869*^9}, 3.68216156874249*^9, 3.682327512165533*^9, 
   3.682328817726317*^9, 3.682362214177524*^9, 3.682399329072505*^9, 
   3.6824020165568*^9, 3.682411358533057*^9, 3.682584004969041*^9, 
   3.682593317519157*^9, 3.68261037022357*^9, 3.6826106790237007`*^9, 
   3.682610709661532*^9, 3.682680756290577*^9, 3.682685994244418*^9, 
   3.682752702572382*^9, 3.6827567092338047`*^9, 3.682756761428021*^9, 
   3.6827572408686647`*^9, 3.68276032969995*^9, 3.682930088482012*^9, 
   3.682945411884973*^9, 3.682957951861155*^9, 3.682958003862389*^9, 
   3.6829595169027777`*^9, 3.682961156630199*^9, 3.683007554178211*^9, 
   3.683007586843975*^9, 3.683007627769696*^9, 3.684042724756995*^9, 
   3.684051538214769*^9, 3.6840531290276623`*^9, 3.68405363183786*^9, 
   3.68405402297302*^9, 3.684054824537334*^9, 3.68405490546647*^9, 
   3.684055008403442*^9, 3.6840551214313593`*^9, 3.6840551941558657`*^9, 
   3.684055263013139*^9, 3.6840553751805677`*^9, 3.684055432213622*^9, 
   3.684055593542807*^9, 3.684057226208626*^9, 3.684059043486157*^9, 
   3.684060966901989*^9, 3.684061743416383*^9, 3.690267380408915*^9, 
   3.690277779436718*^9, 3.6902926633737183`*^9, 3.690369432325068*^9, 
   3.69039641743547*^9, 3.690397822739753*^9, 3.690435408558041*^9, 
   3.6904583623555527`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dvd0dt", "/.", 
  RowBox[{"err", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.684054808919869*^9, 3.684054813679307*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"1", "-", "d"}], "2"], "+", "d"}], ")"}]}], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"vd", "[", "0", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"pdh", "[", "0", "]"}]}], ")"}], " ", 
   RowBox[{"vd", "[", "0", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], " ", 
      RowBox[{"pdh", "[", "0", "]"}]}], "+", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "0", "]"}], " ", 
         RowBox[{"pdh", "[", "0", "]"}]}], "+", 
        RowBox[{
         RowBox[{"f", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pdh", "[", "1", "]"}], "+", 
           RowBox[{"phh", "[", "1", "]"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "2", "]"}], " ", 
         RowBox[{"phh", "[", "2", "]"}]}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{"vd", "[", "1", "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"pdh", "[", "0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{"vh", "[", "1", "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"pdh", "[", "0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{"vd", "[", "1", "]"}], "+", 
     RowBox[{"vh", "[", "1", "]"}]}], ")"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"f", "[", "0", "]"}], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"pdh", "[", "0", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], " ", 
      RowBox[{"vh", "[", "1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "d", " ", 
   RowBox[{"f", "[", "1", "]"}], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"pdh", "[", "0", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], " ", 
      RowBox[{"vh", "[", "1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "d", " ", 
   RowBox[{"f", "[", "1", "]"}], " ", 
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"pdh", "[", "0", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"f", "[", "2", "]"}], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"pdh", "[", "0", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.684054824544074*^9, 3.684054905472835*^9, 
  3.684055008409711*^9, 3.6840551214374733`*^9, 3.684055194196385*^9, 
  3.684055263049754*^9, 3.684055375187129*^9, 3.684055432219675*^9, 
  3.6840555935487747`*^9, 3.684057226236171*^9, 3.684059043490416*^9, 
  3.684060966905901*^9, 3.6840617434342213`*^9, 3.690267380445854*^9, 
  3.69027777944033*^9, 3.6902926634102163`*^9, 3.690369432331251*^9, 
  3.690396417438902*^9, 3.690397822754614*^9, 3.690435408563304*^9, 
  3.690458362378354*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Dynamics of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", 
    RowBox[{"h", ",", "2"}]], TraditionalForm]]],
 ", the reproductive value of a focal hawk in a patch with another hawk"
}], "Subsection",
 CellChangeTimes->{{3.6820051204203377`*^9, 3.6820051414023237`*^9}}],

Cell["\<\
Mortality of focal hawk, replaced by focal\[CloseCurlyQuote]s offspring of \
type dove\
\>", "Text",
 CellChangeTimes->{{3.68200543372608*^9, 3.682005443846343*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt1", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ph", "[", 
       RowBox[{"h", ",", "h"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], "-", 
      RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68200544554594*^9, 3.68200548235351*^9}, {
  3.6820075364919767`*^9, 3.682007536707572*^9}, {3.682009947460268*^9, 
  3.6820099478831043`*^9}, {3.68209399338303*^9, 3.682093994300618*^9}, {
  3.684053005352357*^9, 3.6840530066790457`*^9}}],

Cell["Mortality of focal hawk, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.6820054917001877`*^9, 3.6820055010911818`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt2", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}], "+", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005511622324*^9, 3.682005520743215*^9}, {
  3.6820055709159184`*^9, 3.682005592142858*^9}, {3.682009949305634*^9, 
  3.682009950569125*^9}}],

Cell["\<\
Mortality of nonfocal hawk, replaced by focal\[CloseCurlyQuote]s offspring of \
type hawk;\
\>", "Text",
 CellChangeTimes->{{3.682005595151394*^9, 3.682005607998982*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt3", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"ph", "[", 
     RowBox[{"h", ",", "h"}], "]"}], 
    RowBox[{"vh", "[", "2", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005625606286*^9, 3.682005653450034*^9}, {
   3.682009951425269*^9, 3.6820099518704348`*^9}, 3.6840530115832233`*^9}],

Cell["\<\
Mortality of nonfocal hawk, replaced by focal\[CloseCurlyQuote]s offspring of \
type dove;\
\>", "Text",
 CellChangeTimes->{{3.682005655188333*^9, 3.682005667452868*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt4", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ph", "[", 
       RowBox[{"h", ",", "h"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "+", 
      RowBox[{"vd", "[", "1", "]"}], "-", 
      RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005673808475*^9, 3.68200571825278*^9}, {
   3.682009953470873*^9, 3.6820099539351482`*^9}, 3.684053014344287*^9}],

Cell["\<\
Mortality of nonfocal hawk, replaced by nonfocal offspring of type dove;\
\>", "Text",
 CellChangeTimes->{{3.68200572017826*^9, 3.682005731785377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt5", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"ph", "[", 
          RowBox[{"h", ",", "h"}], "]"}]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ph", "[", 
                RowBox[{"h", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[Equal]", "1"}], ",", "d", ",", "h"}], 
                  "]"}]}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ph", "[", 
                RowBox[{"d", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                  "]"}]}], "]"}]}], ")"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "-", 
      RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005733843959*^9, 3.682005795637632*^9}, {
  3.682009955258163*^9, 3.68200995571586*^9}, {3.684053017194581*^9, 
  3.684053047181785*^9}}],

Cell["\<\
Mortality of a remote hawk, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.6820096937515078`*^9, 3.68200970705304*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt6", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], "k", " ", 
      RowBox[{"mh", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"h", ",", "h"}], "]"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "-", "1", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "h"}], "]"}]}], ")"}], 
         RowBox[{"vd", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682009716340624*^9, 3.682009741633101*^9}, {
  3.6820098070745173`*^9, 3.682009827951312*^9}, {3.6820098626023417`*^9, 
  3.682009883796426*^9}, {3.6840530507287283`*^9, 3.6840530571515093`*^9}}],

Cell["\<\
Mortality of a remote dove, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.682009751237131*^9, 3.682009760131051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt7", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{"2", "-", "k"}], ")"}], " ", 
      RowBox[{"md", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"h", ",", "h"}], "]"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "h"}], "]"}]}], ")"}], 
         RowBox[{"vd", "[", "k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820093785847588`*^9, 3.682009382762863*^9}, {
  3.682009453671788*^9, 3.682009482504977*^9}, {3.682009770942122*^9, 
  3.682009831013*^9}, {3.6820098698972397`*^9, 3.682009885856658*^9}, {
  3.6840530614807253`*^9, 3.684053064679775*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt", "=", 
   RowBox[{
   "dvh2dt1", "+", "dvh2dt2", "+", "dvh2dt3", "+", "dvh2dt4", "+", "dvh2dt5", 
    "+", "dvh2dt6", "+", "dvh2dt7"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005798415985*^9, 3.682005812226226*^9}, {
  3.682009878826271*^9, 3.682009893253294*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"md", "[", "1", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"md", "[", "0", "]"}], "\[Rule]", "m"}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.682097350179871*^9, 3.6820974696683493`*^9}, {
   3.682097517004548*^9, 3.682097520418336*^9}, 3.682097569106885*^9, {
   3.684053656387624*^9, 3.684053657314364*^9}}],

Cell[BoxData[
 RowBox[{"d", " ", "m", " ", "v", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"f", "[", "0", "]"}], "+", 
    RowBox[{"f", "[", "1", "]"}], "+", 
    RowBox[{"f", "[", "2", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.682097394191738*^9, {3.682097433845416*^9, 3.6820974700497913`*^9}, 
   3.682097521768173*^9, 3.682097569636636*^9, 3.682097601255558*^9, 
   3.6820976387372847`*^9, 3.682147218065579*^9, 3.682147288994258*^9, 
   3.682147419631425*^9, 3.682158045404702*^9, 3.68215808243069*^9, 
   3.682159084138859*^9, 3.682159128870865*^9, 3.682159180190117*^9, 
   3.682159403816338*^9, 3.6821607726694727`*^9, {3.6821609092370462`*^9, 
   3.68216093688869*^9}, 3.68216156874249*^9, 3.682327512165533*^9, 
   3.682328817726317*^9, 3.682362214177524*^9, 3.682399329072505*^9, 
   3.6824020165568*^9, 3.682411358533057*^9, 3.682584004969041*^9, 
   3.682593317519157*^9, 3.68261037022357*^9, 3.6826106790237007`*^9, 
   3.682610709661532*^9, 3.682680756290577*^9, 3.682685994244418*^9, 
   3.682752702572382*^9, 3.6827567092338047`*^9, 3.682756761428021*^9, 
   3.6827572408686647`*^9, 3.68276032969995*^9, 3.682930088482012*^9, 
   3.682945411884973*^9, 3.682957951861155*^9, 3.682958003862389*^9, 
   3.6829595169027777`*^9, 3.682961156630199*^9, 3.683007554178211*^9, 
   3.683007586843975*^9, 3.683007627769696*^9, 3.684042724756995*^9, 
   3.684051538214769*^9, 3.6840531290276623`*^9, 3.684053657912099*^9, 
   3.684054023053887*^9, 3.684054905565474*^9, 3.684055008774221*^9, 
   3.684055121511073*^9, 3.68405519427037*^9, 3.684055263127097*^9, 
   3.684055375266695*^9, 3.684055432300997*^9, 3.6840555936363773`*^9, 
   3.684057226287693*^9, 3.684059043547467*^9, 3.6840609669522877`*^9, 
   3.684061743569497*^9, 3.6902673805098658`*^9, 3.6902777795011168`*^9, 
   3.6902926634952602`*^9, 3.690369432392983*^9, 3.6903964176672287`*^9, 
   3.690397822984511*^9, 3.6904354086223*^9, 3.6904583624546967`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dvh2dt", "/.", 
  RowBox[{"err", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.684054887064372*^9, 3.684054893099985*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", " ", 
   RowBox[{"f", "[", "0", "]"}], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], " ", 
      RowBox[{"vh", "[", "1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "d", " ", 
   RowBox[{"f", "[", "1", "]"}], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], " ", 
      RowBox[{"vh", "[", "1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"phh", "[", "2", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"vd", "[", "1", "]"}], "-", 
     RowBox[{"vh", "[", "2", "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "0", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"pdh", "[", "0", "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"f", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "-", 
           RowBox[{"pdh", "[", "1", "]"}], "-", 
           RowBox[{"phh", "[", "1", "]"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"phh", "[", "2", "]"}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"vh", "[", "1", "]"}], "-", 
     RowBox[{"vh", "[", "2", "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"phh", "[", "2", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"vd", "[", "1", "]"}], "+", 
     RowBox[{"vh", "[", "1", "]"}], "-", 
     RowBox[{"vh", "[", "2", "]"}]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "d"}], "2"], "+", "d"}], ")"}], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"vh", "[", "2", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"phh", "[", "2", "]"}], " ", 
   RowBox[{"vh", "[", "2", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "d", " ", 
   RowBox[{"f", "[", "1", "]"}], " ", 
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"f", "[", "2", "]"}], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.684054905570537*^9, 3.68405500887488*^9, 
  3.684055121548369*^9, 3.68405519427645*^9, 3.684055263132992*^9, 
  3.684055375272498*^9, 3.6840554323406878`*^9, 3.684055593642733*^9, 
  3.6840572263126173`*^9, 3.684059043569991*^9, 3.6840609669562483`*^9, 
  3.684061743575081*^9, 3.690267380514826*^9, 3.6902777795047007`*^9, 
  3.690292663501527*^9, 3.690369432398746*^9, 3.690396417673389*^9, 
  3.690397822989719*^9, 3.690435408627158*^9, 3.690458362476756*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Numerical solutions", "Subsection",
 CellChangeTimes->{{3.682005845371214*^9, 3.682005847763522*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sysRV", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dvh1dt", "\[Equal]", "0"}], ",", 
     RowBox[{"dvd1dt", "\[Equal]", "0"}], ",", 
     RowBox[{"dvd0dt", "\[Equal]", "0"}], ",", 
     RowBox[{"dvh2dt", "\[Equal]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rvconstraint", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"f", "[", "1", "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vh", "[", "1", "]"}], "+", 
        RowBox[{"vd", "[", "1", "]"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"f", "[", "0", "]"}], 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"f", "[", "2", "]"}], 
      RowBox[{"vh", "[", "2", "]"}]}]}], "\[Equal]", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sysRVc1", "=", 
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"sysRV", ",", 
      RowBox[{"1", "\[Rule]", "rvconstraint"}]}], "]"}], "//", "Simplify"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sysRVc2", "=", 
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"sysRV", ",", 
      RowBox[{"3", "\[Rule]", "rvconstraint"}]}], "]"}], "//", "Simplify"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rvstart", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vh", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vd", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vd", "[", "0", "]"}], ",", "1.0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vh", "[", "2", "]"}], ",", "1.0"}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682006006497418*^9, 3.682006028294641*^9}, {
  3.682006112204694*^9, 3.682006211136118*^9}, {3.682006456059708*^9, 
  3.682006483164312*^9}, {3.682006514855074*^9, 3.6820065328236427`*^9}, {
  3.682008574510376*^9, 3.682008578472673*^9}, {3.682008687537403*^9, 
  3.682008687786172*^9}, {3.682094942000249*^9, 3.682094959003921*^9}, {
  3.6820978062927094`*^9, 3.682097807568782*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansRV", "[", 
   RowBox[{
    RowBox[{"{", "ds_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"mh1_", ",", "mh2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"md0_", ",", "md1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"phh1_", ",", "phh2_", ",", "pdh0_", ",", "pdh1_"}], "}"}], ",", 
    
    RowBox[{"{", "\[Epsilon]_", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "freqs", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"freqs", "=", 
      RowBox[{"ans", "[", 
       RowBox[{
        RowBox[{"{", "ds", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mh1", ",", "mh2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"md0", ",", "md1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phh1", ",", "phh2", ",", "pdh0", ",", "pdh1"}], "}"}], ",", 
        
        RowBox[{"{", "\[Epsilon]", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sysRVc2", "/.", "freqs"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"d", "\[Rule]", "ds"}], ",", 
          RowBox[{
           RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "mh1"}], ",", 
          RowBox[{
           RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "mh2"}], ",", 
          RowBox[{
           RowBox[{"md", "[", "0", "]"}], "\[Rule]", "md0"}], ",", 
          RowBox[{
           RowBox[{"md", "[", "1", "]"}], "\[Rule]", "md1"}], ",", 
          RowBox[{
           RowBox[{"md", "[", "2", "]"}], "\[Rule]", "md2"}], ",", 
          RowBox[{
           RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "phh1"}], ",", 
          RowBox[{
           RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "phh2"}], ",", 
          RowBox[{
           RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "pdh0"}], ",", 
          RowBox[{
           RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "pdh1"}], ",", 
          RowBox[{"err", "\[Rule]", "\[Epsilon]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vd", "[", "0", "]"}], ",", "1.0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vd", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vh", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vh", "[", "2", "]"}], ",", "1.0"}], "}"}]}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.682005993747673*^9, 3.682006002986651*^9}, {
   3.682006213367695*^9, 3.682006283888545*^9}, {3.682006350101067*^9, 
   3.682006350443767*^9}, {3.682006388565139*^9, 3.6820064172865562`*^9}, 
   3.6820066374754143`*^9, {3.6820068963546953`*^9, 3.682006897038889*^9}, {
   3.6820076384534807`*^9, 3.682007642204445*^9}, {3.684053241919829*^9, 
   3.684053268575892*^9}, {3.6840534075730658`*^9, 3.684053408051874*^9}, {
   3.690395301588725*^9, 3.69039530381113*^9}, {3.69039632895479*^9, 
   3.690396348946302*^9}, {3.69039643852354*^9, 3.690396443805937*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansRValt", "[", 
   RowBox[{
    RowBox[{"{", "ds_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"mh1_", ",", "mh2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"md0_", ",", "md1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"phh1_", ",", "phh2_", ",", "pdh0_", ",", "pdh1_"}], "}"}], ",", 
    
    RowBox[{"{", "\[Epsilon]_", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "freqs", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"freqs", "=", 
      RowBox[{"ans", "[", 
       RowBox[{
        RowBox[{"{", "ds", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mh1", ",", "mh2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"md0", ",", "md1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phh1", ",", "phh2", ",", "pdh0", ",", "pdh1"}], "}"}], ",", 
        
        RowBox[{"{", "\[Epsilon]", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sysRVc1", "/.", "freqs"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"d", "\[Rule]", "ds"}], ",", 
          RowBox[{
           RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "mh1"}], ",", 
          RowBox[{
           RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "mh2"}], ",", 
          RowBox[{
           RowBox[{"md", "[", "0", "]"}], "\[Rule]", "md0"}], ",", 
          RowBox[{
           RowBox[{"md", "[", "1", "]"}], "\[Rule]", "md1"}], ",", 
          RowBox[{
           RowBox[{"md", "[", "2", "]"}], "\[Rule]", "md2"}], ",", 
          RowBox[{
           RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "phh1"}], ",", 
          RowBox[{
           RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "phh2"}], ",", 
          RowBox[{
           RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "pdh0"}], ",", 
          RowBox[{
           RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "pdh1"}], ",", 
          RowBox[{"err", "\[Rule]", "\[Epsilon]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vd", "[", "0", "]"}], ",", "1.0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vd", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vh", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vh", "[", "2", "]"}], ",", "1.0"}], "}"}]}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.682005993747673*^9, 3.682006002986651*^9}, {
   3.682006213367695*^9, 3.682006283888545*^9}, {3.682006350101067*^9, 
   3.682006350443767*^9}, {3.682006388565139*^9, 3.6820064282719593`*^9}, 
   3.682006636641142*^9, {3.682006942350235*^9, 3.6820069443661222`*^9}, {
   3.682006976604924*^9, 3.682006978411319*^9}, {3.682007115285718*^9, 
   3.682007134347156*^9}, {3.6820071710511093`*^9, 3.682007239620407*^9}, {
   3.682007504810028*^9, 3.682007509808412*^9}, 3.682007643997302*^9, {
   3.684053273071854*^9, 3.684053280719903*^9}, {3.68405334311769*^9, 
   3.684053361764162*^9}, {3.6840534034930983`*^9, 3.6840534040357656`*^9}, {
   3.690395256785295*^9, 3.690395293020096*^9}, {3.6903963568172417`*^9, 
   3.6903963652109003`*^9}, 3.690396450620799*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansRVtest", "[", 
   RowBox[{
    RowBox[{"{", "ds_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"mh1_", ",", "mh2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"md0_", ",", "md1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"phh1_", ",", "phh2_", ",", "pdh0_", ",", "pdh1_"}], "}"}], ",", 
    
    RowBox[{"{", "\[Epsilon]_", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "freqs", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"freqs", "=", 
      RowBox[{"ans", "[", 
       RowBox[{
        RowBox[{"{", "ds", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mh1", ",", "mh2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"md0", ",", "md1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phh1", ",", "phh2", ",", "pdh0", ",", "pdh1"}], "}"}], ",", 
        
        RowBox[{"{", "\[Epsilon]", "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sysRVc1", "/.", "freqs"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"d", "\[Rule]", "ds"}], ",", 
          RowBox[{
           RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "mh1"}], ",", 
          RowBox[{
           RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "mh2"}], ",", 
          RowBox[{
           RowBox[{"md", "[", "0", "]"}], "\[Rule]", "md0"}], ",", 
          RowBox[{
           RowBox[{"md", "[", "1", "]"}], "\[Rule]", "md1"}], ",", 
          RowBox[{
           RowBox[{"md", "[", "2", "]"}], "\[Rule]", "md2"}], ",", 
          RowBox[{
           RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "phh1"}], ",", 
          RowBox[{
           RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "phh2"}], ",", 
          RowBox[{
           RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "pdh0"}], ",", 
          RowBox[{
           RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "pdh1"}], ",", 
          RowBox[{"err", "\[Rule]", "\[Epsilon]"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"vh", "[", "1", "]"}], "\[Rule]", "1.0"}], ",", 
         RowBox[{
          RowBox[{"vd", "[", "1", "]"}], "\[Rule]", "1.0"}], ",", 
         RowBox[{
          RowBox[{"vd", "[", "0", "]"}], "\[Rule]", "1.0"}], ",", 
         RowBox[{
          RowBox[{"vh", "[", "2", "]"}], "\[Rule]", "1.0"}]}], "}"}]}], "]"}],
      ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.682005993747673*^9, 3.682006002986651*^9}, {
   3.682006213367695*^9, 3.682006283888545*^9}, {3.682006350101067*^9, 
   3.682006350443767*^9}, {3.682006388565139*^9, 3.6820064172865562`*^9}, {
   3.682006562310053*^9, 3.682006628311502*^9}, {3.6820066841848097`*^9, 
   3.682006685014596*^9}, {3.682007078337799*^9, 3.68200707944947*^9}, 
   3.682007110202232*^9, {3.684053334424116*^9, 3.6840533388565073`*^9}, {
   3.684053369063999*^9, 3.684053398868802*^9}, {3.6903963691546926`*^9, 
   3.690396376743732*^9}, 3.690396455315569*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ansRVtest", "[", 
  RowBox[{
   RowBox[{"{", "0.1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0", ",", "3.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.0", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1", ",", "0.5", ",", "0.3", ",", "0.2"}], "}"}], ",", 
   RowBox[{"{", "0.0", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6819244867924747`*^9, 3.6819245518322287`*^9}, {
   3.681924603462893*^9, 3.681924608373921*^9}, {3.6820064993026323`*^9, 
   3.682006501182838*^9}, {3.682006601836994*^9, 3.6820066022622347`*^9}, {
   3.682006641596554*^9, 3.6820066610865498`*^9}, {3.684053382454425*^9, 
   3.68405338539715*^9}, 3.684053436117866*^9, {3.6903963920616837`*^9, 
   3.6903963948685837`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "False", ",", "False", ",", "False"}], "}"}]], "Output",\

 CellChangeTimes->{{3.682006629715184*^9, 3.682006686256686*^9}, 
   3.682006788580572*^9, 3.682006912610461*^9, 3.6820069812759857`*^9, 
   3.682007081142764*^9, {3.682007120155374*^9, 3.682007137381365*^9}, {
   3.6820072213263407`*^9, 3.682007242052065*^9}, 3.68200734765228*^9, 
   3.682007462127399*^9, 3.682007549551097*^9, 3.682007654292025*^9, 
   3.682008663125298*^9, 3.682008703323143*^9, 3.6820101593099737`*^9, 
   3.682015469297134*^9, 3.682094753946865*^9, 3.682094921024509*^9, 
   3.6820950618890057`*^9, 3.682097779954672*^9, 3.682097864783193*^9, 
   3.6821472193890963`*^9, 3.682147290126*^9, 3.682147420820318*^9, 
   3.682158046548373*^9, 3.682158083625486*^9, 3.682159085210239*^9, 
   3.682159129984549*^9, 3.6821591813591633`*^9, 3.6821594049125633`*^9, 
   3.6821607738567123`*^9, {3.6821609103212223`*^9, 3.682160938127224*^9}, 
   3.6821615703454514`*^9, 3.682327513561829*^9, 3.682328818812336*^9, 
   3.6823622666763573`*^9, 3.682399386118856*^9, 3.682402066903783*^9, 
   3.6824113599402027`*^9, 3.682584006312084*^9, 3.682593369048612*^9, 
   3.682610421689636*^9, 3.682610757091447*^9, 3.6826807575491123`*^9, 
   3.682685995390851*^9, 3.682752703927721*^9, 3.682756710385521*^9, 
   3.6827567626567583`*^9, 3.6827572420103693`*^9, 3.682760330956875*^9, 
   3.68293008983488*^9, 3.682945412986216*^9, 3.6829580564181843`*^9, 
   3.682959576637784*^9, 3.682961209401308*^9, 3.683007555581382*^9, 
   3.683007588282722*^9, 3.6830076290058823`*^9, 3.6840427261174383`*^9, {
   3.6840533775918083`*^9, 3.684053436787055*^9}, 3.684054025678679*^9, 
   3.68405506622408*^9, 3.684055124114149*^9, 3.6840551968476477`*^9, 
   3.684055265714631*^9, 3.684055378094589*^9, 3.684055434925769*^9, 
   3.6840555972086143`*^9, 3.68405566645572*^9, 3.68405722906215*^9, 
   3.684059046433106*^9, 3.684060969708486*^9, 3.684061746350895*^9, 
   3.690267384233502*^9, 3.690277782130014*^9, 3.690369437372136*^9, 
   3.690395310190751*^9, 3.6903964217505093`*^9, 3.690396462772704*^9, 
   3.690397829514999*^9, 3.690435414325596*^9, 3.690458367236836*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"ansRValt", "[", 
   RowBox[{
    RowBox[{"{", ".1", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1.0", ",", "2.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2.0", ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.2", ",", "0.5", ",", "0.3", ",", "0.2"}], "}"}], ",", 
    RowBox[{"{", "0.1", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6819244867924747`*^9, 3.681924613239189*^9}, {
   3.682006502965962*^9, 3.682006503184844*^9}, {3.682007339842572*^9, 
   3.682007341538625*^9}, {3.682010212600904*^9, 3.6820102126547737`*^9}, {
   3.682095545604151*^9, 3.682095559850863*^9}, {3.6820961257511883`*^9, 
   3.682096128024069*^9}, 3.682097785179929*^9, {3.6820978739439573`*^9, 
   3.682097874152995*^9}, {3.682147243644649*^9, 3.68214724483466*^9}, {
   3.682584011849226*^9, 3.682584012630147*^9}, {3.684053416925481*^9, 
   3.684053438358245*^9}, 3.684053688656171*^9, {3.684053803679262*^9, 
   3.684053831509054*^9}, {3.684054034772662*^9, 3.684054035835428*^9}, {
   3.6840553595195312`*^9, 3.6840553625651407`*^9}, {3.684055444541293*^9, 
   3.684055471153578*^9}, {3.6903963964681597`*^9, 3.690396398517734*^9}, {
   3.69039646991433*^9, 3.690396470106316*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"vd", "[", "0", "]"}], "\[Rule]", "0.9724567281789245`"}], ",", 
   RowBox[{
    RowBox[{"vd", "[", "1", "]"}], "\[Rule]", "1.008737564407177`"}], ",", 
   RowBox[{
    RowBox[{"vh", "[", "1", "]"}], "\[Rule]", "1.0292998994947358`"}], ",", 
   RowBox[{
    RowBox[{"vh", "[", "2", "]"}], "\[Rule]", "0.9924393061619103`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.682007221364996*^9, 3.682007242088386*^9}, 
   3.682007347719256*^9, 3.682007462169137*^9, 3.68200751447617*^9, 
   3.682007549602613*^9, 3.682007654333085*^9, 3.6820086642450666`*^9, 
   3.682008704595725*^9, 3.682010159990218*^9, 3.682010220474802*^9, 
   3.68201546934896*^9, 3.6820947540168743`*^9, 3.6820949210821123`*^9, 
   3.682095061942852*^9, {3.682095547410922*^9, 3.6820955601861753`*^9}, 
   3.682096133055738*^9, {3.682097780770935*^9, 3.682097785715047*^9}, {
   3.682097864868885*^9, 3.6820978745729933`*^9}, {3.6821472194323072`*^9, 
   3.68214724614016*^9}, 3.682147290162792*^9, 3.682147420876945*^9, 
   3.6821580465885878`*^9, 3.682158083669642*^9, 3.6821590852494717`*^9, 
   3.68215913003168*^9, 3.6821591814039497`*^9, 3.68215940494991*^9, 
   3.6821607738949537`*^9, {3.682160910358983*^9, 3.682160938182597*^9}, 
   3.682161570401362*^9, 3.6823275135966063`*^9, 3.682328818842012*^9, 
   3.682362266710607*^9, 3.682399386169623*^9, 3.6824020669502983`*^9, 
   3.682411360001964*^9, {3.682584006456417*^9, 3.682584012943288*^9}, 
   3.68259336908654*^9, 3.68261042172297*^9, 3.682610757156258*^9, 
   3.682680757605901*^9, 3.682685995435246*^9, 3.682752703975341*^9, 
   3.682756710437125*^9, 3.682756762758123*^9, 3.682757242067258*^9, 
   3.682760331014629*^9, 3.6829300898649282`*^9, 3.6829454130170794`*^9, 
   3.682958056460651*^9, 3.682959576692205*^9, 3.682961209439979*^9, 
   3.683007555619376*^9, 3.683007588353498*^9, 3.6830076290661*^9, 
   3.684042726166909*^9, 3.6840533775977583`*^9, {3.684053413792161*^9, 
   3.684053438815708*^9}, 3.684053689215856*^9, {3.684053823988698*^9, 
   3.684053832914747*^9}, {3.684054025733224*^9, 3.684054036577394*^9}, 
   3.6840550662856216`*^9, 3.684055124192114*^9, 3.684055196882992*^9, 
   3.684055265757432*^9, {3.68405536404053*^9, 3.68405537814047*^9}, {
   3.6840554349832077`*^9, 3.684055471679751*^9}, 3.684055597266782*^9, 
   3.684055666548593*^9, 3.6840572291345787`*^9, 3.6840590465028543`*^9, 
   3.684060969760747*^9, 3.684061746403102*^9, 3.6902673842839537`*^9, 
   3.690277782182482*^9, 3.690369437390234*^9, 3.6903953102161217`*^9, 
   3.690396422025445*^9, {3.6903964627900677`*^9, 3.6903964744560833`*^9}, 
   3.6903978295578747`*^9, 3.6904354143528214`*^9, 3.6904583672628183`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"ansRV", "[", 
   RowBox[{
    RowBox[{"{", ".1", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1.0", ",", "2.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2.0", ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.2", ",", "0.5", ",", "0.3", ",", "0.2"}], "}"}], ",", 
    RowBox[{"{", "0.1", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6819244867924747`*^9, 3.681924613239189*^9}, {
   3.682006502965962*^9, 3.682006503184844*^9}, {3.682007339842572*^9, 
   3.682007341538625*^9}, {3.682007662410421*^9, 3.6820076626999607`*^9}, {
   3.6820102165856123`*^9, 3.682010217700611*^9}, {3.682095549699923*^9, 
   3.6820955565215893`*^9}, {3.682096129366428*^9, 3.682096130480509*^9}, 
   3.682097787995255*^9, {3.682097872591572*^9, 3.682097872815242*^9}, {
   3.682147248453183*^9, 3.6821472486830673`*^9}, {3.682584008608981*^9, 
   3.6825840093506317`*^9}, {3.6840534206777573`*^9, 3.6840534412619953`*^9}, 
   3.68405369097586*^9, {3.684053804765416*^9, 3.684053830548877*^9}, 
   3.684054032221051*^9, 3.6840553817586803`*^9, {3.684055440620582*^9, 
   3.684055473409932*^9}, {3.690396401276314*^9, 3.690396402319828*^9}, {
   3.6903964722023897`*^9, 3.6903964729290524`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"vd", "[", "0", "]"}], "\[Rule]", "0.9724567281789248`"}], ",", 
   RowBox[{
    RowBox[{"vd", "[", "1", "]"}], "\[Rule]", "1.0087375644071772`"}], ",", 
   RowBox[{
    RowBox[{"vh", "[", "1", "]"}], "\[Rule]", "1.0292998994947353`"}], ",", 
   RowBox[{
    RowBox[{"vh", "[", "2", "]"}], "\[Rule]", "0.9924393061619102`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.682007221364996*^9, 3.682007242088386*^9}, 
   3.682007347719256*^9, 3.682007462169137*^9, 3.68200751447617*^9, 
   3.682007549602613*^9, {3.682007654333085*^9, 3.682007663251109*^9}, 
   3.682008666037369*^9, 3.682008705738957*^9, 3.68201016150253*^9, 
   3.682010218258814*^9, 3.682015469392117*^9, 3.68209475407593*^9, 
   3.682094921138577*^9, 3.682095062000119*^9, {3.6820955503781013`*^9, 
   3.6820955569779043`*^9}, 3.682096130919537*^9, 3.68209778872359*^9, {
   3.682097864933618*^9, 3.6820978768701963`*^9}, {3.682147219472802*^9, 
   3.682147249099347*^9}, 3.682147290194667*^9, 3.682147420926458*^9, 
   3.682158046624893*^9, 3.682158083709901*^9, 3.682159085285591*^9, 
   3.682159130075419*^9, 3.6821591814466887`*^9, 3.68215940498383*^9, 
   3.6821607739306*^9, {3.682160910396274*^9, 3.682160938216776*^9}, 
   3.6821615704396544`*^9, 3.682327513638838*^9, 3.682328818881503*^9, 
   3.6823622667436533`*^9, 3.68239938622464*^9, 3.682402066996818*^9, 
   3.682411360029169*^9, {3.68258400659305*^9, 3.6825840096979017`*^9}, 
   3.682593369123049*^9, 3.682610421755641*^9, 3.682610757219206*^9, 
   3.682680757678116*^9, 3.682685995476046*^9, 3.682752704018092*^9, 
   3.682756710487393*^9, 3.682756762813251*^9, 3.682757242121088*^9, 
   3.682760331069257*^9, 3.682930089909143*^9, 3.682945413063436*^9, 
   3.682958056503264*^9, 3.6829595767492733`*^9, 3.682961209478853*^9, 
   3.683007555678288*^9, 3.683007588422323*^9, 3.683007629108288*^9, 
   3.684042726213551*^9, 3.684053377869603*^9, {3.684053422347171*^9, 
   3.6840534416074266`*^9}, 3.684053691457821*^9, {3.6840538256685953`*^9, 
   3.684053834247693*^9}, {3.684054025818329*^9, 3.684054037993121*^9}, 
   3.684055066342107*^9, 3.6840551242891283`*^9, 3.684055196918578*^9, 
   3.684055265797901*^9, 3.6840553828833847`*^9, {3.684055435020185*^9, 
   3.684055474200086*^9}, 3.684055597304861*^9, 3.6840556666281347`*^9, 
   3.684057229185067*^9, 3.684059046573504*^9, 3.684060969811079*^9, 
   3.684061746453833*^9, 3.690267384358655*^9, 3.690277782232836*^9, 
   3.690369437408227*^9, 3.690395310243186*^9, 3.6903964222508383`*^9, {
   3.690396462802981*^9, 3.690396475415902*^9}, 3.69039782960385*^9, 
   3.6904354143821287`*^9, 3.690458367287253*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Relatedness coefficients", "Section",
 CellChangeTimes->{{3.682098378907537*^9, 3.682098383041769*^9}}],

Cell[CellGroupData[{

Cell["Relatedness between two hawks", "Subsection",
 CellChangeTimes->{{3.6821006797907877`*^9, 3.682100685580933*^9}}],

Cell["Hawk dies on a site with two hawks, replaced by a new hawk", "Text",
 CellChangeTimes->{{3.682100716875992*^9, 3.682100768505619*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drhhdt1", "=", 
   RowBox[{"2", 
    RowBox[{"mh", "[", "2", "]"}], 
    RowBox[{"f", "[", "2", "]"}], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"ph", "[", 
       RowBox[{"h", ",", "h"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "2"], "+", 
        RowBox[{
         FractionBox["1", "2"], "rhh"}]}], ")"}]}], ")"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6821007405129757`*^9, 3.68210076008748*^9}, {
   3.682101608030251*^9, 3.682101644192315*^9}, 3.6821360594660063`*^9, {
   3.682141187951529*^9, 3.6821412205583982`*^9}, {3.682141333123571*^9, 
   3.682141333553995*^9}, {3.6821414171216307`*^9, 3.68214141936082*^9}, {
   3.682141456727585*^9, 3.682141513756228*^9}, {3.684055834432432*^9, 
   3.684055848068902*^9}}],

Cell["\<\
Dove dies on a site with one hawk, one dove, replaced by hawk\
\>", "Text",
 CellChangeTimes->{{3.682141517854609*^9, 3.6821415358148403`*^9}, {
  3.6821416320519533`*^9, 3.682141647443302*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drhhdt2", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    RowBox[{"f", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"ph", "[", 
        RowBox[{"d", ",", "h"}], "]"}], "rhd"}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"ph", "[", 
        RowBox[{"h", ",", "d"}], "]"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682141648378459*^9, 3.682141712724134*^9}, {
  3.6840558383753357`*^9, 3.684055850084552*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drhhdt", "=", 
   RowBox[{"rhh", "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"drhhdt1", "+", "drhhdt2"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"mh", "[", "2", "]"}], " ", 
        RowBox[{"f", "[", "2", "]"}], 
        RowBox[{"bh", "[", "2", "]"}]}], "+", 
       RowBox[{
        RowBox[{"md", "[", "1", "]"}], 
        RowBox[{"f", "[", "1", "]"}], 
        RowBox[{"bh", "[", "1", "]"}]}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6821417331900177`*^9, 3.682141747884907*^9}, {
  3.6901135741663923`*^9, 3.6901135885190897`*^9}, {3.690113670061862*^9, 
  3.690113671108466*^9}, {3.690115932802968*^9, 3.690115953266563*^9}, {
  3.690116071209846*^9, 3.690116086216729*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relatedness between hawk and dove", "Subsection",
 CellChangeTimes->{{3.682141756601061*^9, 3.68214176251266*^9}}],

Cell["Hawk dies on a site with two hawks, replaced by dove", "Text",
 CellChangeTimes->{{3.682141845414377*^9, 3.682141856414472*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drhddt1", "=", 
   RowBox[{"2", 
    RowBox[{"mh", "[", "2", "]"}], 
    RowBox[{"f", "[", "2", "]"}], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"ph", "[", 
         RowBox[{"h", ",", "h"}], "]"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "2"], "+", 
        RowBox[{
         FractionBox["1", "2"], "rhh"}]}], ")"}]}], ")"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6821417637067013`*^9, 3.682141767650845*^9}, {
  3.6821418652733927`*^9, 3.682141885185811*^9}, {3.6840558880713243`*^9, 
  3.684055889211667*^9}}],

Cell["Dove dies on a site with a hawk and dove, replaced by dove", "Text",
 CellChangeTimes->{{3.6821418893497257`*^9, 3.6821418990135317`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drhddt2", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    RowBox[{"f", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"ph", "[", 
          RowBox[{"d", ",", "h"}], "]"}]}], ")"}], "rhd"}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"ph", "[", 
          RowBox[{"h", ",", "d"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6821418999046926`*^9, 3.6821419675189133`*^9}, {
  3.6840558928876667`*^9, 3.684055909411965*^9}}],

Cell["Hawk dies on a site with a hawk and dove, replaced by hawk", "Text",
 CellChangeTimes->{{3.6821419699798107`*^9, 3.682141987483364*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drhddt3", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    RowBox[{"f", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"ph", "[", 
        RowBox[{"d", ",", "h"}], "]"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"ph", "[", 
        RowBox[{"h", ",", "d"}], "]"}], "rhd"}]}], ")"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6821425645549917`*^9, 3.68214261382229*^9}, {
  3.684055912374627*^9, 3.684055916692327*^9}}],

Cell["Dove dies on a site with two doves, replaced by hawk", "Text",
 CellChangeTimes->{{3.682142617572853*^9, 3.682142617980744*^9}, {
  3.682144509138755*^9, 3.68214451605048*^9}, {3.6821465067974854`*^9, 
  3.6821465161819973`*^9}, {3.68214655234869*^9, 3.682146560459737*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drhddt4", "=", 
   RowBox[{"2", 
    RowBox[{"md", "[", "0", "]"}], 
    RowBox[{"f", "[", "0", "]"}], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"ph", "[", 
       RowBox[{"d", ",", "d"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "2"], "+", 
        RowBox[{
         FractionBox["1", "2"], "rdd"}]}], ")"}]}], ")"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.682146518017878*^9, 3.6821465268665857`*^9}, {
   3.682146567368115*^9, 3.682146579169458*^9}, {3.682146769582816*^9, 
   3.68214679272392*^9}, 3.6821468351442633`*^9, {3.684055921493247*^9, 
   3.684055924875222*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drhddt", "=", 
   RowBox[{"rhd", "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"drhddt1", "+", "drhddt2", "+", "drhddt3", "+", "drhddt4"}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"mh", "[", "2", "]"}], 
        RowBox[{"f", "[", "2", "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"bh", "[", "2", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"md", "[", "1", "]"}], 
        RowBox[{"f", "[", "1", "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"bh", "[", "1", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"mh", "[", "1", "]"}], 
        RowBox[{"f", "[", "1", "]"}], 
        RowBox[{"bh", "[", "1", "]"}]}], "+", 
       RowBox[{"2", 
        RowBox[{"md", "[", "0", "]"}], 
        RowBox[{"f", "[", "0", "]"}], 
        RowBox[{"bh", "[", "0", "]"}]}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682147175494446*^9, 3.6821471906979847`*^9}, {
  3.682147275682651*^9, 3.682147281304256*^9}, {3.6902669820917263`*^9, 
  3.690266984786256*^9}, {3.690267087800963*^9, 3.690267090417594*^9}, {
  3.690267123392787*^9, 3.690267133292448*^9}, {3.690267222019134*^9, 
  3.690267252771645*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relatedness between two doves", "Subsection",
 CellChangeTimes->{{3.682146801022192*^9, 3.68214680408639*^9}}],

Cell["Dove dies on a site with two doves, replaced by dove", "Text",
 CellChangeTimes->{{3.682146846189437*^9, 3.682146857101396*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drdddt1", "=", 
   RowBox[{"2", " ", 
    RowBox[{"md", "[", "0", "]"}], 
    RowBox[{"f", "[", "0", "]"}], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"ph", "[", 
         RowBox[{"d", ",", "d"}], "]"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "2"], "+", 
        RowBox[{
         FractionBox["1", "2"], "rdd"}]}], ")"}]}], ")"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.682146806183455*^9, 3.6821468712957067`*^9}, {
  3.684056565783762*^9, 3.68405656739631*^9}}],

Cell["\<\
Hawk dies on a site with a hawk and a dove, replaced by a dove\
\>", "Text",
 CellChangeTimes->{{3.682147056353011*^9, 3.6821470646085033`*^9}, {
  3.683009009922729*^9, 3.6830090129059362`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drdddt2", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    RowBox[{"f", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"ph", "[", 
          RowBox[{"h", ",", "d"}], "]"}]}], ")"}], "rhd"}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"ph", "[", 
          RowBox[{"d", ",", "h"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6821470668189507`*^9, 3.682147069651259*^9}, {
  3.682147135098391*^9, 3.6821471682563887`*^9}, {3.68405657134317*^9, 
  3.684056579099928*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drdddt", "=", 
   RowBox[{"rdd", "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"drdddt1", "+", "drdddt2"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"md", "[", "0", "]"}], 
        RowBox[{"f", "[", "0", "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"bh", "[", "0", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"mh", "[", "1", "]"}], 
        RowBox[{"f", "[", "1", "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"bh", "[", "1", "]"}]}], ")"}]}]}], ")"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6821471957690287`*^9, 3.682147215232978*^9}, {
  3.682147285209251*^9, 3.6821472859992523`*^9}, {3.69026726493967*^9, 
  3.690267269451809*^9}, {3.69026735166504*^9, 3.690267392262415*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving the relatedness equations", "Subsection",
 CellChangeTimes->{{3.682147299698036*^9, 3.68214730516171*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"drdddt1", "+", "drdddt2"}], "//", "Variables"}]], "Input",
 CellChangeTimes->{{3.682147340476369*^9, 3.682147350715621*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"d", ",", "rdd", ",", 
   RowBox[{"f", "[", "0", "]"}], ",", 
   RowBox[{"md", "[", "0", "]"}], ",", "err", ",", 
   RowBox[{"pdh", "[", "0", "]"}], ",", 
   RowBox[{"pdh", "[", "1", "]"}], ",", 
   RowBox[{"phh", "[", "1", "]"}], ",", 
   RowBox[{"phh", "[", "2", "]"}], ",", 
   RowBox[{"f", "[", "1", "]"}], ",", 
   RowBox[{"mh", "[", "1", "]"}], ",", "rhd"}], "}"}]], "Output",
 CellChangeTimes->{
  3.682147351217752*^9, 3.682147421004189*^9, 3.6821580467774267`*^9, 
   3.682158083784499*^9, 3.682159085353016*^9, 3.68215913015455*^9, 
   3.682159181522254*^9, 3.682159405031416*^9, 3.6821607739781637`*^9, {
   3.682160910445315*^9, 3.682160938437458*^9}, 3.682161570678198*^9, 
   3.6823275136944113`*^9, 3.682328818938621*^9, 3.682362266813208*^9, 
   3.682399386321525*^9, 3.682402067125486*^9, 3.682411360284794*^9, 
   3.6825840206219263`*^9, 3.682584093128592*^9, 3.682593369192642*^9, 
   3.682610421822907*^9, 3.682610757323366*^9, 3.6826807577834806`*^9, 
   3.682685995539568*^9, 3.682752704080024*^9, 3.682756710549314*^9, 
   3.682756762888173*^9, 3.682757242186266*^9, 3.682760331137525*^9, 
   3.682930089974743*^9, 3.682945413274658*^9, 3.6829580566055593`*^9, 
   3.682959576881282*^9, 3.682961209563833*^9, 3.683007555757666*^9, 
   3.6830075885993757`*^9, 3.683007629202836*^9, 3.6840427262794657`*^9, 
   3.684056617357226*^9, 3.684057229251049*^9, 3.684059046630975*^9, 
   3.684060969867423*^9, 3.684061746503068*^9, {3.690267384537334*^9, 
   3.690267395299157*^9}, 3.690277782320251*^9, 3.690293603095882*^9, 
   3.690369437528015*^9, 3.6903964940156603`*^9, 3.6903978297646637`*^9, 
   3.690435414535337*^9, 3.690458367342082*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rsys", "=", 
   RowBox[{"{", 
    RowBox[{"drdddt", ",", "drhddt", ",", "drhhdt"}], "}"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.690293687374529*^9, 3.6902937003487663`*^9}}],

Cell["\<\
To prevent indeterminate expressions when d->1.0, simply the things\
\>", "Text",
 CellChangeTimes->{{3.6826111286934*^9, 3.682611147532548*^9}}],

Cell["Some numerical exmples", "Text",
 CellChangeTimes->{{3.682362121072191*^9, 3.682362131223483*^9}, 
   3.690267594189509*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ansRel", "[", 
    RowBox[{
     RowBox[{"{", "ds_", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"mh1_", ",", "mh2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"md0_", ",", "md1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"phh1_", ",", "phh2_", ",", "pdh0_", ",", "pdh1_"}], "}"}], ",", 
     RowBox[{"{", "\[Epsilon]_", "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "freqs", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"freqs", "=", 
       RowBox[{"ans", "[", 
        RowBox[{
         RowBox[{"{", "ds", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mh1", ",", "mh2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"md0", ",", "md1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"phh1", ",", "phh2", ",", "pdh0", ",", "pdh1"}], "}"}], ",", 
         RowBox[{"{", "\[Epsilon]", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"rsys", "/.", "freqs"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"d", "\[Rule]", "ds"}], ",", 
            RowBox[{
             RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "mh1"}], ",", 
            RowBox[{
             RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "mh2"}], ",", 
            RowBox[{
             RowBox[{"md", "[", "0", "]"}], "\[Rule]", "md0"}], ",", 
            RowBox[{
             RowBox[{"md", "[", "1", "]"}], "\[Rule]", "md1"}], ",", 
            RowBox[{
             RowBox[{"md", "[", "2", "]"}], "\[Rule]", "md2"}], ",", 
            RowBox[{
             RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "phh1"}], ",", 
            RowBox[{
             RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "phh2"}], ",", 
            RowBox[{
             RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "pdh0"}], ",", 
            RowBox[{
             RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "pdh1"}], ",", 
            RowBox[{"err", "\[Rule]", "\[Epsilon]"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rdd", ",", "0.1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"rhh", ",", "0.1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"rhd", ",", "0.1"}], "}"}]}], "}"}]}], "]"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682362154307127*^9, 3.68236219633923*^9}, {
  3.6823622611929893`*^9, 3.6823622755329533`*^9}, {3.68405658761171*^9, 
  3.684056606130188*^9}, {3.6902936711475887`*^9, 3.690293740432849*^9}, {
  3.690303771117406*^9, 3.690303797112385*^9}, {3.6903697896321907`*^9, 
  3.690369808432822*^9}, {3.6903707940621243`*^9, 3.690370829465378*^9}, {
  3.6903931703675337`*^9, 3.690393173231933*^9}, {3.690396125804125*^9, 
  3.690396147760172*^9}, {3.690396230790365*^9, 3.690396246871107*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vx", "=", "0.2"}]], "Input",
 CellChangeTimes->{{3.682945983408217*^9, 3.682945991492906*^9}, 
   3.690303491824445*^9, {3.690395929505424*^9, 3.6903959296159277`*^9}}],

Cell[BoxData["0.2`"], "Output",
 CellChangeTimes->{{3.68294598465029*^9, 3.682945992513949*^9}, 
   3.6829580579849253`*^9, 3.682959578407529*^9, 3.6829612106851177`*^9, 
   3.683007557361162*^9, 3.683007589660178*^9, 3.683007630321295*^9, 
   3.684042727852531*^9, 3.68405662885247*^9, 3.684057237716599*^9, 
   3.6840590556382236`*^9, 3.6840609786391497`*^9, 3.684061755316242*^9, 
   3.6902673901888037`*^9, 3.690267600276897*^9, 3.6902777825357513`*^9, 
   3.690303492690208*^9, 3.6903694375670223`*^9, 3.6903959595269547`*^9, 
   3.6903964941627207`*^9, 3.690397829820149*^9, 3.690435414575597*^9, 
   3.690458367372119*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cx", "=", "0.8"}]], "Input",
 CellChangeTimes->{{3.6829459937708473`*^9, 3.6829459955242987`*^9}, 
   3.6903034946537867`*^9, {3.690395957255395*^9, 3.690395957510757*^9}}],

Cell[BoxData["0.8`"], "Output",
 CellChangeTimes->{3.682945996426029*^9, 3.682958058030014*^9, 
  3.682959578455127*^9, 3.682961210717236*^9, 3.683007557401263*^9, 
  3.683007589666937*^9, 3.683007630370891*^9, 3.684042727858489*^9, 
  3.684056628890251*^9, 3.684057237747374*^9, 3.684059055658136*^9, 
  3.684060978664926*^9, 3.684061755336371*^9, 3.69026739019313*^9, 
  3.690267601400638*^9, 3.690277782541218*^9, 3.690303495723605*^9, 
  3.690369437588477*^9, 3.6903959603836946`*^9, 3.69039649424317*^9, 
  3.6903978298592663`*^9, 3.6904354146067743`*^9, 3.690458367393631*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Denominator", "[", 
     RowBox[{"drhhdt", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], "}"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "0", "]"}], "\[Rule]", "1"}], ",", 
     RowBox[{
      RowBox[{"f", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"f", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.6903698706099358`*^9, 3.6903699384820766`*^9}, {
  3.69037040581914*^9, 3.690370424354068*^9}}],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{{3.690369887160469*^9, 3.690369939149629*^9}, {
   3.6903704073171597`*^9, 3.690370424835017*^9}, 3.690396494310554*^9, 
   3.6903978299238997`*^9, 3.6904354146362267`*^9, 3.690458367415159*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans", "[", 
  RowBox[{
   RowBox[{"{", "1.0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.690303730196712*^9, 3.690303758599628*^9}}],

Cell[BoxData[
 RowBox[{"ans", "[", 
  RowBox[{
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5`", ",", "0.5`"}], "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.690303758890399*^9, 3.690369437609831*^9, 
  3.690369813686322*^9, 3.6903959682639914`*^9, 3.6903964943731537`*^9, 
  3.6903978299709167`*^9, 3.690435414661256*^9, 3.690458367435466*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ansRel", "[", 
  RowBox[{
   RowBox[{"{", "1.0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1.0", "-", "vx"}], ",", 
     RowBox[{"1.0", "-", 
      RowBox[{".5", "*", 
       RowBox[{"(", 
        RowBox[{"vx", "-", "cx"}], ")"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1.0", "-", 
      RowBox[{"vx", "/", "2"}]}], ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{".999", ",", "0.0004", ",", "0.999", ",", "0.999"}], "}"}], ",", 
   RowBox[{"{", "0.0", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.682362277214612*^9, 3.682362374222139*^9}, {
   3.682584023186549*^9, 3.682584024584736*^9}, {3.682945971089429*^9, 
   3.682945971143819*^9}, {3.68294986488445*^9, 3.682949865190816*^9}, {
   3.683008843432417*^9, 3.683008844678714*^9}, {3.684056612499538*^9, 
   3.6840566139938393`*^9}, {3.690292652417376*^9, 3.690292652840889*^9}, {
   3.690293764158939*^9, 3.690293768477059*^9}, {3.6903034730027857`*^9, 
   3.690303473885704*^9}, {3.690303521760014*^9, 3.690303551041053*^9}, {
   3.690303611886602*^9, 3.690303614534658*^9}, {3.6903698318016768`*^9, 
   3.6903698385831823`*^9}, {3.69037084978493*^9, 3.6903708509273233`*^9}, {
   3.690395997985273*^9, 3.690395998319405*^9}, {3.690396038766157*^9, 
   3.690396043640218*^9}, {3.69039610623073*^9, 3.690396106715342*^9}, {
   3.690396161408269*^9, 3.690396201078533*^9}, 3.6903965211134567`*^9, {
   3.690396551208996*^9, 3.690396551845142*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"rdd", "\[Rule]", "0.`"}], ",", 
   RowBox[{"rhh", "\[Rule]", "0.`"}], ",", 
   RowBox[{"rhd", "\[Rule]", "0.`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.690293744235985*^9, 3.690293769162442*^9}, {
   3.690303474452598*^9, 3.690303496755786*^9}, {3.6903035411052732`*^9, 
   3.6903035514252243`*^9}, 3.6903036150537567`*^9, 3.690303800404714*^9, 
   3.6903694376295557`*^9, {3.690369815172617*^9, 3.690369839455264*^9}, {
   3.690370834309664*^9, 3.69037085130048*^9}, 3.690372244855934*^9, 
   3.6903931787637653`*^9, {3.690395971247054*^9, 3.690395998822221*^9}, 
   3.690396044427843*^9, 3.690396150863715*^9, {3.690396201889648*^9, 
   3.690396216968059*^9}, 3.690396494418994*^9, {3.690396526131219*^9, 
   3.690396552195475*^9}, 3.690397830017241*^9, 3.690435414686079*^9, 
   3.690458367462903*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Selection gradient", "Section",
 CellChangeTimes->{{3.6826870995883617`*^9, 3.682687107204843*^9}, {
  3.6827040779053926`*^9, 3.682704079385676*^9}, {3.684057597740849*^9, 
  3.684057598227005*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "D",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SubscriptBox["v", 
     RowBox[{"h", ",", "1"}]]}], TraditionalForm]]],
 ",\[Delta]p], effect of mutant hawk on its reproductive value when in patch \
with a dove"
}], "Subsection",
 CellChangeTimes->{{3.681925845874449*^9, 3.681925917621695*^9}, {
   3.682148625830776*^9, 3.68214864606923*^9}, {3.6821489079950533`*^9, 
   3.682148939575816*^9}, {3.68215840601661*^9, 3.682158407037374*^9}, 
   3.6827045414829397`*^9, {3.684057900678673*^9, 3.684057903349881*^9}}],

Cell["\<\
Mortality of focal hawk and replaced by focal\[CloseCurlyQuote]s offspring of \
type dove (producing a hawk would result in no change in RV)\
\>", "Text",
 CellChangeTimes->{{3.6819259258548727`*^9, 3.681925945317912*^9}, {
  3.681927660932111*^9, 3.681927698193883*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt1\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ph", "[", 
         RowBox[{"h", ",", "d"}], "]"}], "+", 
        RowBox[{"dph", "[", 
         RowBox[{"h", ",", "d"}], "]"}]}], ")"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], "-", 
      RowBox[{"vh", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68192594726071*^9, 3.681925971758462*^9}, {
   3.6819260190855913`*^9, 3.681926130947208*^9}, {3.681926435242239*^9, 
   3.681926436818954*^9}, 3.681926482730927*^9, 3.682009057140668*^9, {
   3.6821486572470617`*^9, 3.6821486643165693`*^9}, {3.6821487087565107`*^9, 
   3.682148710002554*^9}, {3.682704091033469*^9, 3.682704091486333*^9}, {
   3.684057118350216*^9, 3.684057125358927*^9}, 3.6840579076345663`*^9}],

Cell["Mortality of focal hawk and replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.68192633677034*^9, 3.681926359617897*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt2\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}], "+", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"vh", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681926361613797*^9, 3.6819263784774847`*^9}, {
   3.681926413492546*^9, 3.681926481130086*^9}, 3.682009059069139*^9, {
   3.682148714117815*^9, 3.682148714571002*^9}, 3.682704095171871*^9, {
   3.684057909302668*^9, 3.6840579104212837`*^9}}],

Cell["\<\
Mortality of the nonfocal dove and replaced by focal\[CloseCurlyQuote]s \
offspring of type dove\
\>", "Text",
 CellChangeTimes->{{3.681926317859852*^9, 3.681926334348077*^9}, 
   3.681926544690075*^9, {3.681926579360045*^9, 3.681926583510888*^9}, {
   3.681926636969471*^9, 3.6819266700431433`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt3\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ph", "[", 
         RowBox[{"h", ",", "d"}], "]"}], "+", 
        RowBox[{"dph", "[", 
         RowBox[{"h", ",", "d"}], "]"}]}], ")"}]}], ")"}], 
    RowBox[{"vd", "[", "1", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681926485767674*^9, 3.6819264890139637`*^9}, {
   3.68192652486548*^9, 3.68192659653953*^9}, {3.681926628842537*^9, 
   3.681926682312171*^9}, {3.681926718791271*^9, 3.681926718817273*^9}, 
   3.682009060228359*^9, {3.682097592047633*^9, 3.68209759532474*^9}, {
   3.6821487171734858`*^9, 3.68214872548204*^9}, 3.6827040983451023`*^9, 
   3.684057134552238*^9, {3.684057911440186*^9, 3.684057911999263*^9}}],

Cell["\<\
Mortality of the nonfocal dove and replaced by focal\[CloseCurlyQuote]s \
offspring of type hawk\
\>", "Text",
 CellChangeTimes->{{3.681926317859852*^9, 3.681926334348077*^9}, 
   3.681926544690075*^9, {3.681926579360045*^9, 3.681926583510888*^9}, {
   3.681926697907278*^9, 3.681926699041252*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt4\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ph", "[", 
       RowBox[{"h", ",", "d"}], "]"}], "+", 
      RowBox[{"dph", "[", 
       RowBox[{"h", ",", "d"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"vh", "[", "2", "]"}]}], "-", 
      RowBox[{"vh", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681926485767674*^9, 3.6819264890139637`*^9}, {
   3.68192652486548*^9, 3.68192659653953*^9}, {3.681926628842537*^9, 
   3.6819266565170918`*^9}, 3.6820090618934*^9, {3.682148727877877*^9, 
   3.682148736116351*^9}, 3.682704101151885*^9, 3.6840571372398033`*^9, {
   3.6840579129598494`*^9, 3.6840579132468576`*^9}}],

Cell["\<\
Mortality of the nonfocal dove and replaced by nonfocal offspring of type hawk\
\>", "Text",
 CellChangeTimes->{{3.681926606554904*^9, 3.681926619259595*^9}, {
  3.681926733120963*^9, 3.681926735911662*^9}, {3.681927427092368*^9, 
  3.681927430092204*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt5\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"d", ",", "h"}], "]"}], "+", 
         RowBox[{"rhd", " ", 
          RowBox[{"dph", "[", 
           RowBox[{"d", ",", "h"}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], "d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", 
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "d", ",", "h"}], 
                "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                "]"}]}], "]"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], "-", 
      RowBox[{"vh", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681926485767674*^9, 3.6819264890139637`*^9}, {
   3.68192652486548*^9, 3.68192659653953*^9}, {3.681926628842537*^9, 
   3.6819266565170918`*^9}, {3.6819267201356573`*^9, 3.681926784796221*^9}, {
   3.68192683930256*^9, 3.6819268756409187`*^9}, {3.681927243839273*^9, 
   3.6819273106996517`*^9}, {3.68200774527532*^9, 3.682007748906412*^9}, 
   3.682009063583851*^9, {3.682148740738834*^9, 3.682148741375119*^9}, 
   3.68270410325672*^9, {3.684057146892337*^9, 3.6840571899850817`*^9}, {
   3.684057790543395*^9, 3.684057812205989*^9}, {3.684057914309525*^9, 
   3.684057914601864*^9}}],

Cell["\<\
Mortality of a remote hawk, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.6820091009966784`*^9, 3.6820091353626547`*^9}, {
  3.6820094084444447`*^9, 3.68200940878259*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt6\[Delta]p", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], "k", " ", 
      RowBox[{"mh", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "d"}], "]"}], "+", 
           RowBox[{"dph", "[", 
            RowBox[{"h", ",", "d"}], "]"}]}], ")"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "-", "1", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", "d"}], "]"}], "+", 
             RowBox[{"dph", "[", 
              RowBox[{"h", ",", "d"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"vd", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820091378039627`*^9, 3.682009165972104*^9}, {
   3.682009196189785*^9, 3.6820092024320917`*^9}, {3.682009253476973*^9, 
   3.6820094372537603`*^9}, {3.682148767622493*^9, 3.682148804946928*^9}, 
   3.682704105806418*^9, {3.6840572044811974`*^9, 3.6840572112870703`*^9}, {
   3.684057917209785*^9, 3.684057917522463*^9}}],

Cell["\<\
Mortality of a remote dove, replaced by focal\[CloseCurlyQuote]s offspring \
\>", "Text",
 CellChangeTimes->{{3.682009384878317*^9, 3.682009395964232*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt7\[Delta]p", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{"2", "-", "k"}], ")"}], " ", 
      RowBox[{"md", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "d"}], "]"}], "+", 
           RowBox[{"dph", "[", 
            RowBox[{"h", ",", "d"}], "]"}]}], ")"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", "d"}], "]"}], "+", 
             RowBox[{"dph", "[", 
              RowBox[{"h", ",", "d"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"vd", "[", "k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820093785847588`*^9, 3.682009382762863*^9}, {
   3.682009453671788*^9, 3.682009482504977*^9}, {3.682148808823868*^9, 
   3.682148831019637*^9}, 3.682704108681299*^9, {3.6840572145380983`*^9, 
   3.6840572174382877`*^9}, {3.684057920050753*^9, 3.6840579203590593`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt\[Delta]p", "=", 
   RowBox[{
   "dvh1dt1\[Delta]p", "+", "dvh1dt2\[Delta]p", "+", "dvh1dt3\[Delta]p", "+", 
    "dvh1dt4\[Delta]p", "+", "dvh1dt5\[Delta]p", "+", "dvh1dt6\[Delta]p", "+",
     "dvh1dt7\[Delta]p"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819273292045794`*^9, 3.68192735687001*^9}, {
  3.682009488406528*^9, 3.682009495179122*^9}, {3.682148837062303*^9, 
  3.6821488500140753`*^9}, {3.6827041110376787`*^9, 3.6827041237452803`*^9}, {
  3.684057921917987*^9, 3.68405794581289*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "D",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SubscriptBox["v", 
     RowBox[{"d", ",", "1"}]]}], TraditionalForm]]],
 ",\[Delta]p], effect of mutant dove on its reproductive value when in patch \
with a hawk"
}], "Subsection",
 CellChangeTimes->{{3.681925845874449*^9, 3.681925917621695*^9}, {
   3.6819276385562973`*^9, 3.681927643012681*^9}, {3.6821489492086563`*^9, 
   3.682148962709304*^9}, 3.6827045443476753`*^9, {3.684058127648767*^9, 
   3.684058130464773*^9}}],

Cell["\<\
Mortality of focal dove and replaced by focal\[CloseCurlyQuote]s offspring of \
type hawk\
\>", "Text",
 CellChangeTimes->{{3.681927646083029*^9, 3.68192766542691*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt1\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ph", "[", 
       RowBox[{"d", ",", "h"}], "]"}], "+", 
      RowBox[{"dph", "[", 
       RowBox[{"d", ",", "h"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], "-", 
      RowBox[{"vd", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819277026703978`*^9, 3.681927753911727*^9}, 
   3.68200906607246*^9, {3.6821490399016943`*^9, 3.6821490404193993`*^9}, {
   3.682704537230804*^9, 3.682704538312809*^9}, {3.684057630653081*^9, 
   3.684057649443519*^9}, {3.684057953520206*^9, 3.6840579538050127`*^9}}],

Cell["Mortality of focal dove and replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.6819277589352093`*^9, 3.6819277678851347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt2\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}], "+", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"vd", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681927755599751*^9, 3.681927786037052*^9}, 
   3.682009067510016*^9, 3.682149043590345*^9, {3.682704558373361*^9, 
   3.6827045606927767`*^9}, {3.682756678236326*^9, 3.6827566832790737`*^9}, {
   3.684057955020836*^9, 3.684057955316642*^9}}],

Cell["\<\
Mortality of nonfocal hawk and replaced by focal\[CloseCurlyQuote]s offspring \
of type hawk\
\>", "Text",
 CellChangeTimes->{{3.681927788198155*^9, 3.681927802268944*^9}, {
  3.6820047639760857`*^9, 3.682004764423377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt3\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ph", "[", 
       RowBox[{"d", ",", "h"}], "]"}], "+", 
      RowBox[{"dph", "[", 
       RowBox[{"d", ",", "h"}], "]"}]}], ")"}], 
    RowBox[{"vh", "[", "1", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819278039339848`*^9, 3.681927820192936*^9}, {
   3.681928010710494*^9, 3.681928022314131*^9}, 3.682009069053135*^9, 
   3.682149046100585*^9, {3.682704563013505*^9, 3.682704563717565*^9}, 
   3.682756684086083*^9, 3.684057667012927*^9, {3.6840579635260487`*^9, 
   3.684057963819777*^9}}],

Cell["\<\
Mortality of nonfocal hawk and replaced by focal\[CloseCurlyQuote]s offspring \
of type dove\
\>", "Text",
 CellChangeTimes->{{3.6819280252425003`*^9, 3.681928037744994*^9}, {
  3.681928107885906*^9, 3.68192810830996*^9}, {3.6820047654005413`*^9, 
  3.68200476557555*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt4\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ph", "[", 
         RowBox[{"d", ",", "h"}], "]"}], "+", 
        RowBox[{"dph", "[", 
         RowBox[{"d", ",", "h"}], "]"}]}], ")"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"vd", "[", "0", "]"}]}], "-", 
      RowBox[{"vd", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819280389798*^9, 3.681928097445298*^9}, 
   3.682009071318041*^9, 3.6821490481735897`*^9, {3.682704565767733*^9, 
   3.68270456653341*^9}, 3.682756685022587*^9, 3.684057709293703*^9, {
   3.684057965054367*^9, 3.684057965358054*^9}}],

Cell["\<\
Mortality of the nonfocal hawk and replacement by nonfocal offspring of type \
dove\
\>", "Text",
 CellChangeTimes->{{3.6819281009568357`*^9, 3.681928127780846*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt5\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "d"}], "]"}], "+", 
           RowBox[{"rhd", " ", 
            RowBox[{"dph", "[", 
             RowBox[{"h", ",", "d"}], "]"}]}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ph", "[", 
                RowBox[{"h", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[Equal]", "1"}], ",", "d", ",", "h"}], 
                  "]"}]}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ph", "[", 
                RowBox[{"d", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                  "]"}]}], "]"}]}], ")"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], "-", 
      RowBox[{"vd", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681928129058757*^9, 3.681928229584217*^9}, {
   3.682009923518659*^9, 3.682009924206077*^9}, {3.682148974050123*^9, 
   3.6821489874304943`*^9}, 3.682149050456653*^9, {3.682704577373246*^9, 
   3.682704578697135*^9}, {3.684057739863696*^9, 3.684057752173274*^9}, {
   3.6840578283640127`*^9, 3.684057871324401*^9}, {3.684057966537676*^9, 
   3.6840579668428373`*^9}}],

Cell["\<\
Mortality of a remote hawk, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.6820096937515078`*^9, 3.68200970705304*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt6\[Delta]p", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], "k", " ", 
      RowBox[{"mh", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"d", ",", "h"}], "]"}], "+", 
           RowBox[{"dph", "[", 
            RowBox[{"d", ",", "h"}], "]"}]}], ")"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "-", "1", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", "h"}], "]"}], "+", 
             RowBox[{"dph", "[", 
              RowBox[{"d", ",", "h"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"vd", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682009716340624*^9, 3.682009741633101*^9}, 
   3.6821490525599318`*^9, {3.682704595726223*^9, 3.68270459678769*^9}, 
   3.6827566877124863`*^9, {3.684057881971327*^9, 3.684057886113173*^9}, {
   3.684057969216827*^9, 3.6840579703364773`*^9}}],

Cell["\<\
Mortality of a remote dove, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.682009751237131*^9, 3.682009760131051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt7\[Delta]p", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{"2", "-", "k"}], ")"}], " ", 
      RowBox[{"md", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"d", ",", "h"}], "]"}], "+", 
           RowBox[{"dph", "[", 
            RowBox[{"d", ",", "h"}], "]"}]}], ")"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", "h"}], "]"}], "+", 
             RowBox[{"dph", "[", 
              RowBox[{"d", ",", "h"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"vd", "[", "k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820093785847588`*^9, 3.682009382762863*^9}, {
   3.682009453671788*^9, 3.682009482504977*^9}, {3.682009770942122*^9, 
   3.682009781881384*^9}, 3.682149054682516*^9, {3.6827045992456703`*^9, 
   3.682704599907331*^9}, 3.6827566884804296`*^9, {3.6840578898938513`*^9, 
   3.684057893098241*^9}, {3.684058107101688*^9, 3.684058107452001*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt\[Delta]p", "=", 
   RowBox[{
   "dvd1dt1\[Delta]p", "+", "dvd1dt2\[Delta]p", "+", "dvd1dt3\[Delta]p", "+", 
    "dvd1dt4\[Delta]p", "+", "dvd1dt5\[Delta]p", "+", "dvd1dt6\[Delta]p", "+",
     "dvd1dt7\[Delta]p"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681928234441332*^9, 3.681928255802907*^9}, {
  3.682009785510764*^9, 3.682009790254716*^9}, {3.682149056610606*^9, 
  3.682149066561804*^9}, {3.682704601956284*^9, 3.682704617248904*^9}, {
  3.6840581086914043`*^9, 3.68405811944986*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "D[",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", 
    RowBox[{"d", ",", "0"}]], TraditionalForm]]],
 ",\[Delta]p]"
}], "Subsection",
 CellChangeTimes->{{3.681928472202375*^9, 3.6819284868668833`*^9}, {
  3.684058160354732*^9, 3.684058167583535*^9}}],

Cell["\<\
Mortality of focal dove, replaced by focal\[CloseCurlyQuote]s offspring of \
type hawk\
\>", "Text",
 CellChangeTimes->{{3.6819285036646957`*^9, 3.681928516554496*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt1\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ph", "[", 
       RowBox[{"d", ",", "d"}], "]"}], "+", 
      RowBox[{"dph", "[", 
       RowBox[{"d", ",", "d"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "-", 
      RowBox[{"vd", "[", "0", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681928488000746*^9, 3.681928535190276*^9}, {
  3.682008123544552*^9, 3.682008123743497*^9}, {3.6820099290143433`*^9, 
  3.682009929445161*^9}, {3.6820940048913813`*^9, 3.6820940051399307`*^9}, {
  3.684052921906323*^9, 3.684052923208544*^9}, {3.6840581911848288`*^9, 
  3.684058197208365*^9}, {3.684058255327778*^9, 3.6840582564701643`*^9}}],

Cell["Mortality of focal dove, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.681928537408855*^9, 3.68192854448831*^9}, {
  3.6819286771859627`*^9, 3.681928681520582*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt2\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}], "+", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"vd", "[", "0", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68192854640654*^9, 3.6819285603331327`*^9}, {
   3.68192866864113*^9, 3.6819286875374327`*^9}, 3.682006840764783*^9, {
   3.682009934024764*^9, 3.682009934468092*^9}, 3.684058259615391*^9}],

Cell["\<\
Mortality of nonfocal dove, replaced by focal\[CloseCurlyQuote]s offspring of \
type dove;\
\>", "Text",
 CellChangeTimes->{{3.68192869093843*^9, 3.681928711842268*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt3\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ph", "[", 
         RowBox[{"d", ",", "d"}], "]"}], "+", 
        RowBox[{"dph", "[", 
         RowBox[{"d", ",", "d"}], "]"}]}], ")"}]}], ")"}], 
    RowBox[{"vd", "[", "0", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681928713865307*^9, 3.681928725483062*^9}, {
   3.6820047252771378`*^9, 3.682004746184661*^9}, 3.682005489217371*^9, {
   3.682008081799137*^9, 3.6820080916422997`*^9}, {3.6820081270402927`*^9, 
   3.682008127216434*^9}, {3.6820099356762047`*^9, 3.68200993705604*^9}, 
   3.684052928689547*^9, 3.684058213481688*^9, 3.684058261902732*^9}],

Cell["\<\
Mortality of nonfocal dove, replaced by focal\[CloseCurlyQuote]s offspring of \
type hawk;\
\>", "Text",
 CellChangeTimes->{{3.681928570567319*^9, 3.681928579606635*^9}, {
  3.6820047541665077`*^9, 3.6820047854705877`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt4\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ph", "[", 
       RowBox[{"d", ",", "d"}], "]"}], "+", 
      RowBox[{"dph", "[", 
       RowBox[{"d", ",", "d"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "+", 
      RowBox[{"vd", "[", "1", "]"}], "-", 
      RowBox[{"vd", "[", "0", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682004786630179*^9, 3.6820047933450336`*^9}, {
   3.68200487190224*^9, 3.68200488725364*^9}, 3.682005488213191*^9, {
   3.682008096919821*^9, 3.682008098044466*^9}, {3.6820081280839376`*^9, 
   3.682008128264373*^9}, {3.6820099390011463`*^9, 3.6820099394410963`*^9}, 
   3.6840529323860826`*^9, 3.684058219065732*^9, 3.684058264016094*^9}],

Cell["\<\
Mortality of nonfocal dove, replaced by nonfocal offspring of type hawk;\
\>", "Text",
 CellChangeTimes->{{3.682004953995056*^9, 3.682004965059964*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt5\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"d", ",", "d"}], "]"}], "+", 
         RowBox[{"rdd", " ", 
          RowBox[{"dph", "[", 
           RowBox[{"d", ",", "d"}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", 
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "d", ",", "h"}], 
                "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                "]"}]}], "]"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], "-", 
      RowBox[{"vd", "[", "0", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68200496609521*^9, 3.682005090648181*^9}, 
   3.682005487388914*^9, {3.6820099436493692`*^9, 3.682009944105322*^9}, {
   3.684052935284096*^9, 3.684052964131206*^9}, {3.6840582242539587`*^9, 
   3.6840582274833937`*^9}, 3.684058266275481*^9}],

Cell["\<\
Mortality of a remote hawk, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.6820096937515078`*^9, 3.68200970705304*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt6\[Delta]p", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], "k", " ", 
      RowBox[{"mh", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"d", ",", "d"}], "]"}], "+", 
           RowBox[{"dph", "[", 
            RowBox[{"d", ",", "d"}], "]"}]}], ")"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "-", "1", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", "d"}], "]"}], "+", 
             RowBox[{"dph", "[", 
              RowBox[{"d", ",", "d"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"vd", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682009716340624*^9, 3.682009741633101*^9}, {
  3.6820098070745173`*^9, 3.682009827951312*^9}, {3.684052972202599*^9, 
  3.6840529816896772`*^9}, {3.684058238251268*^9, 3.684058269009716*^9}}],

Cell["\<\
Mortality of a remote dove, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.682009751237131*^9, 3.682009760131051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt7\[Delta]p", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{"2", "-", "k"}], ")"}], " ", 
      RowBox[{"md", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"d", ",", "d"}], "]"}], "+", 
           RowBox[{"dph", "[", 
            RowBox[{"d", ",", "d"}], "]"}]}], ")"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", "d"}], "]"}], "+", 
             RowBox[{"dph", "[", 
              RowBox[{"d", ",", "d"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"vd", "[", "k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820093785847588`*^9, 3.682009382762863*^9}, {
  3.682009453671788*^9, 3.682009482504977*^9}, {3.682009770942122*^9, 
  3.682009831013*^9}, {3.684052984834188*^9, 3.6840529880733147`*^9}, {
  3.684058245307209*^9, 3.6840582733942947`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt\[Delta]p", "=", 
   RowBox[{
   "dvd0dt1\[Delta]p", "+", "dvd0dt2\[Delta]p", "+", "dvd0dt3\[Delta]p", "+", 
    "dvd0dt4\[Delta]p", "+", "dvd0dt5\[Delta]p", "+", "dvd0dt6\[Delta]p", "+",
     "dvd0dt7\[Delta]p"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820051000674963`*^9, 3.682005113434269*^9}, {
  3.682009833362094*^9, 3.682009839901073*^9}, {3.6840582807635*^9, 
  3.684058289886343*^9}, {3.684058378241352*^9, 3.684058378935938*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "D[",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", 
    RowBox[{"h", ",", "2"}]], TraditionalForm]]],
 ",\[Delta]p]"
}], "Subsection",
 CellChangeTimes->{{3.6820051204203377`*^9, 3.6820051414023237`*^9}, {
  3.68405817222786*^9, 3.684058176431323*^9}}],

Cell["\<\
Mortality of focal hawk, replaced by focal\[CloseCurlyQuote]s offspring of \
type dove\
\>", "Text",
 CellChangeTimes->{{3.68200543372608*^9, 3.682005443846343*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt1\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ph", "[", 
         RowBox[{"h", ",", "h"}], "]"}], "+", 
        RowBox[{"dph", "[", 
         RowBox[{"h", ",", "h"}], "]"}]}], ")"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], "-", 
      RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68200544554594*^9, 3.68200548235351*^9}, {
  3.6820075364919767`*^9, 3.682007536707572*^9}, {3.682009947460268*^9, 
  3.6820099478831043`*^9}, {3.68209399338303*^9, 3.682093994300618*^9}, {
  3.684053005352357*^9, 3.6840530066790457`*^9}, {3.6840584529222527`*^9, 
  3.684058459817465*^9}, {3.684058520208346*^9, 3.6840585211199713`*^9}}],

Cell["Mortality of focal hawk, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.6820054917001877`*^9, 3.6820055010911818`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt2\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}], "+", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005511622324*^9, 3.682005520743215*^9}, {
   3.6820055709159184`*^9, 3.682005592142858*^9}, {3.682009949305634*^9, 
   3.682009950569125*^9}, 3.6840585250253773`*^9}],

Cell["\<\
Mortality of nonfocal hawk, replaced by focal\[CloseCurlyQuote]s offspring of \
type hawk;\
\>", "Text",
 CellChangeTimes->{{3.682005595151394*^9, 3.682005607998982*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt3\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ph", "[", 
       RowBox[{"h", ",", "h"}], "]"}], "+", 
      RowBox[{"dph", "[", 
       RowBox[{"h", ",", "h"}], "]"}]}], ")"}], 
    RowBox[{"vh", "[", "2", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005625606286*^9, 3.682005653450034*^9}, {
   3.682009951425269*^9, 3.6820099518704348`*^9}, 3.6840530115832233`*^9, 
   3.684058465618194*^9, 3.684058527095973*^9}],

Cell["\<\
Mortality of nonfocal hawk, replaced by focal\[CloseCurlyQuote]s offspring of \
type dove;\
\>", "Text",
 CellChangeTimes->{{3.682005655188333*^9, 3.682005667452868*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt4\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ph", "[", 
         RowBox[{"h", ",", "h"}], "]"}], "+", 
        RowBox[{"dph", "[", 
         RowBox[{"h", ",", "h"}], "]"}]}], ")"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "+", 
      RowBox[{"vd", "[", "1", "]"}], "-", 
      RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005673808475*^9, 3.68200571825278*^9}, {
   3.682009953470873*^9, 3.6820099539351482`*^9}, 3.684053014344287*^9, 
   3.684058468995248*^9, 3.6840585286015263`*^9}],

Cell["\<\
Mortality of nonfocal hawk, replaced by nonfocal offspring of type dove;\
\>", "Text",
 CellChangeTimes->{{3.68200572017826*^9, 3.682005731785377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt5\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "h"}], "]"}], "+", 
           RowBox[{"rhh", " ", 
            RowBox[{"dph", "[", 
             RowBox[{"h", ",", "h"}], "]"}]}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ph", "[", 
                RowBox[{"h", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[Equal]", "1"}], ",", "d", ",", "h"}], 
                  "]"}]}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ph", "[", 
                RowBox[{"d", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                  "]"}]}], "]"}]}], ")"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "-", 
      RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005733843959*^9, 3.682005795637632*^9}, {
   3.682009955258163*^9, 3.68200995571586*^9}, {3.684053017194581*^9, 
   3.684053047181785*^9}, {3.6840584733770523`*^9, 3.684058475654405*^9}, 
   3.684058530478479*^9}],

Cell["\<\
Mortality of a remote hawk, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.6820096937515078`*^9, 3.68200970705304*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt6\[Delta]p", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], "k", " ", 
      RowBox[{"mh", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "h"}], "]"}], "+", 
           RowBox[{"dph", "[", 
            RowBox[{"h", ",", "h"}], "]"}]}], ")"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "-", "1", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", "h"}], "]"}], "+", 
             RowBox[{"dph", "[", 
              RowBox[{"h", ",", "h"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"vd", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682009716340624*^9, 3.682009741633101*^9}, {
  3.6820098070745173`*^9, 3.682009827951312*^9}, {3.6820098626023417`*^9, 
  3.682009883796426*^9}, {3.6840530507287283`*^9, 3.6840530571515093`*^9}, {
  3.684058502027246*^9, 3.684058537634962*^9}}],

Cell["\<\
Mortality of a remote dove, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.682009751237131*^9, 3.682009760131051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt7\[Delta]p", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{"2", "-", "k"}], ")"}], " ", 
      RowBox[{"md", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "h"}], "]"}], "+", 
           RowBox[{"dph", "[", 
            RowBox[{"h", ",", "h"}], "]"}]}], ")"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", "h"}], "]"}], "+", 
             RowBox[{"dph", "[", 
              RowBox[{"h", ",", "h"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"vd", "[", "k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820093785847588`*^9, 3.682009382762863*^9}, {
  3.682009453671788*^9, 3.682009482504977*^9}, {3.682009770942122*^9, 
  3.682009831013*^9}, {3.6820098698972397`*^9, 3.682009885856658*^9}, {
  3.6840530614807253`*^9, 3.684053064679775*^9}, {3.684058511755145*^9, 
  3.6840585403308573`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt\[Delta]p", "=", 
   RowBox[{
   "dvh2dt1\[Delta]p", "+", "dvh2dt2\[Delta]p", "+", "dvh2dt3\[Delta]p", "+", 
    "dvh2dt4\[Delta]p", "+", "dvh2dt5\[Delta]p", "+", "dvh2dt6\[Delta]p", "+",
     "dvh2dt7\[Delta]p"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005798415985*^9, 3.682005812226226*^9}, {
  3.682009878826271*^9, 3.682009893253294*^9}, {3.684058542606262*^9, 
  3.684058551816244*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final selection gradient", "Subsection",
 CellChangeTimes->{{3.684058592998148*^9, 3.684058595278048*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dv\[Delta]p", "[", "var_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", "0", "]"}], 
     RowBox[{"D", "[", 
      RowBox[{"dvd0dt\[Delta]p", ",", "var"}], "]"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"f", "[", "1", "]"}], "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"dvd1dt\[Delta]p", ",", "var"}], "]"}], "+", 
       RowBox[{"D", "[", 
        RowBox[{"dvh1dt\[Delta]p", ",", "var"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"f", "[", "2", "]"}], 
     RowBox[{"D", "[", 
      RowBox[{"dvh2dt\[Delta]p", ",", "var"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.684058596285364*^9, 3.684058712092133*^9}, {
  3.6840587489261103`*^9, 3.684058749318337*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dv\[Delta]p", "[", 
   RowBox[{"\[Delta]pdh", "[", "1", "]"}], "]"}], "/.", 
  RowBox[{"err", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.690458395478394*^9, 3.69045840911987*^9}, {
  3.69045857568731*^9, 3.6904585827997713`*^9}, {3.6904589713501463`*^9, 
  3.69045897154888*^9}, {3.690459051833549*^9, 3.6904590532332497`*^9}, {
  3.6904591263512087`*^9, 3.690459127495878*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"f", "[", "1", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], " ", 
     RowBox[{"mh", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"vd", "[", "0", "]"}]}], "-", 
       RowBox[{"vd", "[", "1", "]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], " ", 
     RowBox[{"mh", "[", "1", "]"}], " ", 
     RowBox[{"vh", "[", "1", "]"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"f", "[", "0", "]"}], " ", 
     RowBox[{"md", "[", "0", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"vd", "[", "0", "]"}]}], "+", 
       RowBox[{"vh", "[", "1", "]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "d", " ", 
     RowBox[{"f", "[", "1", "]"}], " ", 
     RowBox[{"mh", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"vd", "[", "0", "]"}]}], "+", 
       RowBox[{"vh", "[", "1", "]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], " ", 
     RowBox[{"md", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"vd", "[", "1", "]"}]}], "+", 
       RowBox[{"vh", "[", "2", "]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "d", " ", 
     RowBox[{"f", "[", "1", "]"}], " ", 
     RowBox[{"md", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"vd", "[", "1", "]"}]}], "+", 
       RowBox[{"vh", "[", "2", "]"}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"f", "[", "2", "]"}], " ", 
     RowBox[{"mh", "[", "2", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"vd", "[", "1", "]"}]}], "+", 
       RowBox[{"vh", "[", "2", "]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], " ", "rhd", " ", 
     RowBox[{"md", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"vh", "[", "1", "]"}]}], "+", 
       RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.6904585769522676`*^9, 3.69045858318743*^9}, 
   3.690458972543562*^9, 3.690459053972062*^9, 3.690459128035317*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export pdh1, pdh0, phh2, phh1 to C for numerical iterations", "Section",
 CellChangeTimes->{{3.682160783295267*^9, 3.682160788447118*^9}, {
  3.6826813294969597`*^9, 3.6826813320013933`*^9}, {3.682685866808383*^9, 
  3.68268586743937*^9}, {3.6827523487657824`*^9, 3.682752354629344*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toC", "[", "x_", "]"}], ":=", 
   RowBox[{"ToString", "[", 
    RowBox[{"CForm", "[", "x", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682161456693557*^9, 3.682161470196316*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"destdir", "=", 
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/freq_dep/src/numerical/all_p/\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682161717565921*^9, 3.6821617711984797`*^9}, {
   3.6825933994944*^9, 3.682593404584663*^9}, {3.682679951619446*^9, 
   3.6826799539863863`*^9}, 3.682686016773263*^9, {3.682752360836028*^9, 
   3.68275236201057*^9}, 3.68295961553316*^9, 3.683007623426265*^9, {
   3.690304350161018*^9, 3.690304350458255*^9}}],

Cell["Recursions patch frequencies:", "Text",
 CellChangeTimes->{{3.682161882166662*^9, 3.682161885670203*^9}, 
   3.6821624505393877`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subslistpi", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", "2", "]"}], "\[Rule]", 
     RowBox[{"1", "-", 
      RowBox[{"f", "[", "0", "]"}], "-", 
      RowBox[{"f", "[", "1", "]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682327597044585*^9, 3.6823276298697863`*^9}, {
   3.6823290359971857`*^9, 3.6823290417312613`*^9}, {3.6823357302793207`*^9, 
   3.68233578154373*^9}, {3.682335821498516*^9, 3.682335823800241*^9}, 
   3.6827523658025503`*^9, {3.6827564582527313`*^9, 3.682756459747501*^9}, {
   3.684042122362256*^9, 3.684042122696566*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "\"\<\ndouble df0dt = 0;\\n\ndouble df1dt = 0;\\n\nfor (int \
rtime=0;rtime<1e7;++rtime)\n{\\n\n df0dt=\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "0", "]"}], "+", 
       RowBox[{"0.01", "*", "df0dt"}]}], "/.", "subslistpi"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<df1dt=\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "1", "]"}], "+", 
       RowBox[{"0.01", "*", "df1dt"}]}], "/.", "subslistpi"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<if (fabs(df0dt-f(0))<1e-7 && fabs(df1dt-f(1))<1e-7)\n{\\n\n\
f(0)=bound01(df0dt);\\n\nf(1)=bound01(df1dt);\\n\nbreak;\n}\n\
f(0)=bound01(df0dt);\\n\nf(1)=bound01(df1dt);\\n\n}\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<gsl_vector_set(f,0,df0dt);\\ngsl_vector_set(f,1,df1dt);\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<patchrecurs.txt\>\""}], ",", "str"}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.682161887133985*^9, 3.682161949262312*^9}, {
  3.682162010303856*^9, 3.682162042156077*^9}, {3.682162104640438*^9, 
  3.682162123237709*^9}, {3.6821623891143293`*^9, 3.6821623939367723`*^9}, {
  3.682327392744194*^9, 3.682327394573818*^9}, {3.682327621755862*^9, 
  3.682327634169639*^9}, {3.68232903178618*^9, 3.682329034215569*^9}, {
  3.682332675735446*^9, 3.682332726798011*^9}, {3.682336840329123*^9, 
  3.682336959051839*^9}, {3.682337019281827*^9, 3.682337159552997*^9}, {
  3.6823374847557*^9, 3.682337501625996*^9}, {3.682338636259857*^9, 
  3.68233863667269*^9}, {3.6827564631202908`*^9, 3.682756464077887*^9}, {
  3.6903053899018297`*^9, 3.690305394771337*^9}}],

Cell["Selection gradients:", "Text",
 CellChangeTimes->{{3.682162445075205*^9, 3.682162448753883*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"\"\<double phh1tplus1=bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"phh", "[", "1", "]"}], "+", 
       RowBox[{"0.01", "*", 
        RowBox[{"dv\[Delta]p", "[", 
         RowBox[{"\[Delta]phh", "[", "1", "]"}], "]"}]}]}], "/.", 
      "subslistpi"}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double phh2tplus1=bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"phh", "[", "2", "]"}], "+", 
       RowBox[{"0.01", "*", 
        RowBox[{"dv\[Delta]p", "[", 
         RowBox[{"\[Delta]phh", "[", "2", "]"}], "]"}]}]}], "/.", 
      "subslistpi"}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double pdh1tplus1=bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pdh", "[", "1", "]"}], "+", 
       RowBox[{"0.01", "*", 
        RowBox[{"dv\[Delta]p", "[", 
         RowBox[{"\[Delta]pdh", "[", "1", "]"}], "]"}]}]}], "/.", 
      "subslistpi"}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double pdh0tplus1=bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pdh", "[", "0", "]"}], "+", 
       RowBox[{"0.01", "*", 
        RowBox[{"dv\[Delta]p", "[", 
         RowBox[{"\[Delta]pdh", "[", "0", "]"}], "]"}]}]}], "/.", 
      "subslistpi"}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<gsl_vector_set(f,0, phh1tplus1);\n\\ngsl_vector_set(f,1, \
phh2tplus1);\n\\ngsl_vector_set(f,2, pdh1tplus1);\n\\ngsl_vector_set(f,3, \
pdh0tplus1);\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<selgrad.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682160858838086*^9, 3.682160917127363*^9}, {
   3.68216096750389*^9, 3.682160979262237*^9}, {3.68216147288342*^9, 
   3.682161509821845*^9}, {3.682161587471574*^9, 3.6821615946291447`*^9}, {
   3.682161690631402*^9, 3.682161714530292*^9}, {3.682161774243383*^9, 
   3.682161790857154*^9}, {3.682161877146689*^9, 3.682161878065649*^9}, {
   3.682162324817855*^9, 3.682162351559415*^9}, 3.68232740484098*^9, {
   3.6823278149584618`*^9, 3.682327820410331*^9}, {3.682330388675725*^9, 
   3.6823303901044064`*^9}, {3.682330509454705*^9, 3.682330519485196*^9}, {
   3.6823305878318453`*^9, 3.682330603857889*^9}, {3.682332631808494*^9, 
   3.682332664849325*^9}, 3.682332701627718*^9, {3.682336292270938*^9, 
   3.682336334159027*^9}, {3.682337473173208*^9, 3.6823374733079033`*^9}, {
   3.6825931524741697`*^9, 3.682593158474628*^9}, {3.6827523758443413`*^9, 
   3.682752471623835*^9}, 3.6827527870913343`*^9, {3.682755722838686*^9, 
   3.6827557242862*^9}, {3.6827564661991787`*^9, 3.6827564688454523`*^9}, {
   3.684058922741806*^9, 3.6840589589719887`*^9}, {3.69030532973639*^9, 
   3.690305336210227*^9}}],

Cell["Reproductive values", "Text",
 CellChangeTimes->{{3.682593141350663*^9, 3.682593144663989*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], ",", "1.0"}], "}"}]}], "}"}], 
  ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "\"\<\n\tdouble vh_1_tplus1;\n\tdouble vh_2_tplus1;\n\tdouble vd_0_tplus1;\
\n\tdouble vd_1_tplus1;\n\tfor (int rtime=0;rtime<1e07;++rtime) {\n\t\t\
vh_1_tplus1 = bound0(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vh", "[", "1", "]"}], "+", 
       RowBox[{"0.01", 
        RowBox[{"(", "dvh1dt", ")"}]}]}], "/.", "subslistpi"}], "]"}], "<>", 
    "\"\<);\n\t\tvh_2_tplus1 = bound0(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vh", "[", "2", "]"}], "+", 
       RowBox[{"0.01", 
        RowBox[{"(", "dvh2dt", ")"}]}]}], "/.", "subslistpi"}], "]"}], "<>", 
    "\"\<);\n\t\tvd_0_tplus1 = bound0(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vd", "[", "0", "]"}], "+", 
       RowBox[{"0.01", 
        RowBox[{"(", "dvd0dt", ")"}]}]}], "/.", "subslistpi"}], "]"}], "<>", 
    "\"\<);\n\t\tvd_1_tplus1 = bound0(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vd", "[", "1", "]"}], "+", 
       RowBox[{"0.01", 
        RowBox[{"(", "dvd1dt", ")"}]}]}], "/.", "subslistpi"}], "]"}], "<>", 
    "\"\<);\n\n\t\tif (fabs(vh_1_tplus1 - vh(1)) < 1e-7 &&\n\t\t\t\t\
fabs(vh_2_tplus1 - vh(2)) < 1e-7 &&\n\t\t\t\tfabs(vd_0_tplus1 - vd(0)) < 1e-7 \
&&\n\t\t\t\tfabs(vd_1_tplus1 - vd(1)) < 1e-7)\n\t\t{\n\t\t\tbreak;\n\t\t}\n\n\
\t\tvh(1) = vh_1_tplus1;\n\t\tvh(2) = vh_2_tplus1;\n\t\tvd(0) = vd_0_tplus1;\n\
\t\tvd(1) = vd_1_tplus1;\n\t}\n\tgsl_vector_set(f, 0, vh(1));\n\t\
gsl_vector_set(f, 1, vh(2));\n\tgsl_vector_set(f, 2, vd(0));\n\t\
gsl_vector_set(f, 3, vd(1));\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<repvals.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682593250402199*^9, 3.682593294323497*^9}, {
  3.6825934273266077`*^9, 3.682593500088787*^9}, {3.682593596267352*^9, 
  3.682593626105576*^9}, {3.68259371776462*^9, 3.682593719783543*^9}, {
  3.6825939700484*^9, 3.682593984356481*^9}, {3.6825942579923477`*^9, 
  3.682594281286126*^9}, {3.68259457678067*^9, 3.682594579536339*^9}, {
  3.682610346972528*^9, 3.682610366288414*^9}, {3.682756471064345*^9, 
  3.6827564728786907`*^9}, {3.684060719316674*^9, 3.6840607240580273`*^9}, {
  3.690293937603519*^9, 3.690294042466384*^9}, {3.690294210847473*^9, 
  3.6902945034401503`*^9}, {3.690298607256329*^9, 3.690298607789392*^9}, {
  3.6903000954813232`*^9, 3.690300124369986*^9}, {3.6903001765543747`*^9, 
  3.690300190948062*^9}, {3.690304700080634*^9, 3.690304705460288*^9}, {
  3.690305450228828*^9, 3.690305456464353*^9}}],

Cell["Relatedness coefficients", "Text",
 CellChangeTimes->{{3.68259363336897*^9, 3.6825936366162*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "\"\<\n\tdouble rhhtplus1;\n\tdouble rhdtplus1;\n\tdouble rddtplus1;\n\t\
for (int rtime=0; rtime<1e07; ++rtime) {\n\t\trhhtplus1 = bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"drhhdt", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/.", "subslistpi"}], "]"}], "<>", 
    "\"\<);\n\t\trhdtplus1 = bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"drhddt", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/.", "subslistpi"}], "]"}], "<>", 
    "\"\<);\n\t\trddtplus1 = bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"drdddt", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/.", "subslistpi"}], "]"}], "<>", 
    "\"\<);\n\n\t\tif (\n\t\t\t\tfabs(rhhtplus1 - rhh) < 1e-07 &&\n\t\t\t\t\
fabs(rhdtplus1 - rhd) < 1e-07 &&\n\t\t\t\tfabs(rddtplus1 - rdd) < 1e-07\n\t\t\
\t)\n\t\t{\n\t\t\tbreak;\n\t\t}\n\t\trhh = rhhtplus1;\n\t\trhd = rhdtplus1;\n\
\t\trdd = rddtplus1;\n\t}\n\tgsl_vector_set(f, 0, rhh);\n\tgsl_vector_set(f, \
1, rhd);\n\tgsl_vector_set(f, 2, rdd);\>\""}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<relvals.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQXffYrOxv/mvHsO6eWhD974N8M4gObrveCqJTGJq7
QLT4x+UTQLRB894ZINprs8IsEK3xy2oziM4427kTRMtERz0E0SeU0sE0xx3d
FyDaaIoJmN7xxNvmH5Be0h9iB6KTu1fcYS147Wj26et9EP2LPZWDDUhv26jB
BaIvObq99wHSzg2lYHrbB/7fvkB6hoTKHxDNHX/s2Mmi145uojLHQbSAaNu8
9XVAfxRfXwSi/y+ctRlE+/D83Q6iq+bcYtsApNtfu3CBaN8XrEogWvrZI1UQ
vUY22QFEHzDVdwTREum+biCa44aKN4junL45GETPWDAvDER3LVbKA9E2i68V
g2jzWaIzN4Hka1+Dab7NB6MuAmk1p3nRIBoAP/LHew==
  "]],

Cell["Parameters:", "Text",
 CellChangeTimes->{{3.6821624526654873`*^9, 3.682162453913859*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{"d", ",", 
     RowBox[{"md", "[", "0", "]"}], ",", 
     RowBox[{"mh", "[", "1", "]"}], ",", 
     RowBox[{"md", "[", "1", "]"}], ",", 
     RowBox[{"mh", "[", "2", "]"}], ",", "pdhinit", ",", "phhinit", ",", 
     "err"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"variables", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"params", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", "0", "]"}], ",", 
        RowBox[{"f", "[", "1", "]"}], ",", 
        RowBox[{"pdh", "[", "1", "]"}], ",", 
        RowBox[{"pdh", "[", "0", "]"}], ",", 
        RowBox[{"phh", "[", "1", "]"}], ",", 
        RowBox[{"phh", "[", "2", "]"}], ",", "rhh", ",", "rhd", ",", "rdd", 
        ",", 
        RowBox[{"vh", "[", "1", "]"}], ",", 
        RowBox[{"vh", "[", "2", "]"}], ",", 
        RowBox[{"vd", "[", "0", "]"}], ",", 
        RowBox[{"vd", "[", "1", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iter", "=", "1"}], ",", 
    RowBox[{"iter", "<=", 
     RowBox[{"Length", "[", "params", "]"}]}], ",", 
    RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
       RowBox[{"toC", "[", 
        RowBox[{"params", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", "\"\<;\\n\>\""}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<params.txt\>\""}], ",", "str"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iter", "=", "1"}], ",", 
    RowBox[{"iter", "<=", 
     RowBox[{"Length", "[", "variables", "]"}]}], ",", 
    RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
       RowBox[{"toC", "[", 
        RowBox[{"variables", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", "\"\<;\\n\>\""}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<variables.txt\>\""}], ",", "str"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.682328066784473*^9, 3.6823281140851583`*^9}, {
   3.682328224431203*^9, 3.682328322993704*^9}, {3.682328487512398*^9, 
   3.682328527081253*^9}, {3.682328814505022*^9, 3.6823288434444647`*^9}, 
   3.6823289446691017`*^9, 3.6823290482043056`*^9, {3.682335793054305*^9, 
   3.682335793435977*^9}, {3.682594969037878*^9, 3.682594980745699*^9}, {
   3.682613114300337*^9, 3.682613122530101*^9}, {3.682752486814995*^9, 
   3.682752494529079*^9}, 3.684042260607793*^9, {3.684042371194415*^9, 
   3.6840423773158703`*^9}, {3.690304603632051*^9, 3.690304604163265*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export p to C for numerical iterations", "Section",
 CellChangeTimes->{{3.682160783295267*^9, 3.682160788447118*^9}, {
   3.6826813294969597`*^9, 3.6826813320013933`*^9}, {3.682685866808383*^9, 
   3.68268586743937*^9}, {3.6827523487657824`*^9, 3.682752354629344*^9}, 
   3.684060565499308*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toC", "[", "x_", "]"}], ":=", 
   RowBox[{"ToString", "[", 
    RowBox[{"CForm", "[", "x", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682161456693557*^9, 3.682161470196316*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"destdir", "=", 
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/freq_dep/src/numerical/p_only/\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682161717565921*^9, 3.6821617711984797`*^9}, {
   3.6825933994944*^9, 3.682593404584663*^9}, {3.682679951619446*^9, 
   3.6826799539863863`*^9}, 3.682686016773263*^9, {3.682752360836028*^9, 
   3.68275236201057*^9}, 3.68295961553316*^9, 3.683007623426265*^9, {
   3.684060579440638*^9, 3.684060580326228*^9}, 3.690294538886232*^9}],

Cell["Recursions patch frequencies:", "Text",
 CellChangeTimes->{{3.682161882166662*^9, 3.682161885670203*^9}, 
   3.6821624505393877`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subslistponly", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "2", "]"}], "\[Rule]", 
      RowBox[{"1", "-", 
       RowBox[{"f", "[", "0", "]"}], "-", 
       RowBox[{"f", "[", "1", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "p"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.682327597044585*^9, 3.6823276298697863`*^9}, {
   3.6823290359971857`*^9, 3.6823290417312613`*^9}, {3.6823357302793207`*^9, 
   3.68233578154373*^9}, {3.682335821498516*^9, 3.682335823800241*^9}, 
   3.6827523658025503`*^9, {3.6827564582527313`*^9, 3.682756459747501*^9}, {
   3.684042122362256*^9, 3.684042122696566*^9}, {3.6840605034147863`*^9, 
   3.6840605188031683`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "\"\<\ndouble df0dt = 0;\\n\ndouble df1dt = 0;\\n\nfor (int \
rtime=0;rtime<1e7;++rtime)\n{\\n\n df0dt=\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "0", "]"}], "+", 
       RowBox[{"0.01", "*", "df0dt"}]}], "/.", "subslistponly"}], "]"}], 
    "<>", "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<df1dt=\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "1", "]"}], "+", 
       RowBox[{"0.01", "*", "df1dt"}]}], "/.", "subslistponly"}], "]"}], 
    "<>", "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<if (fabs(df0dt-f(0))<1e-7 && fabs(df1dt-f(1))<1e-7)\n{\\n\n\
f(0)=bound01(df0dt);\\n\nf(1)=bound01(df1dt);\\n\nbreak;\n}\n\
f(0)=bound01(df0dt);\\n\nf(1)=bound01(df1dt);\\n\n}\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<gsl_vector_set(f,0,df0dt);\\ngsl_vector_set(f,1,df1dt);\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<patchrecurs.txt\>\""}], ",", "str"}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.682161887133985*^9, 3.682161949262312*^9}, {
  3.682162010303856*^9, 3.682162042156077*^9}, {3.682162104640438*^9, 
  3.682162123237709*^9}, {3.6821623891143293`*^9, 3.6821623939367723`*^9}, {
  3.682327392744194*^9, 3.682327394573818*^9}, {3.682327621755862*^9, 
  3.682327634169639*^9}, {3.68232903178618*^9, 3.682329034215569*^9}, {
  3.682332675735446*^9, 3.682332726798011*^9}, {3.682336840329123*^9, 
  3.682336959051839*^9}, {3.682337019281827*^9, 3.682337159552997*^9}, {
  3.6823374847557*^9, 3.682337501625996*^9}, {3.682338636259857*^9, 
  3.68233863667269*^9}, {3.6827564631202908`*^9, 3.682756464077887*^9}, {
  3.684060654639913*^9, 3.6840606568830214`*^9}, {3.690294352420126*^9, 
  3.690294359768035*^9}}],

Cell["Selection gradients:", "Text",
 CellChangeTimes->{{3.682162445075205*^9, 3.682162448753883*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"\"\<double ptplus1=bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"p", "+", 
       RowBox[{"0.01", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dv\[Delta]p", "[", 
           RowBox[{"\[Delta]phh", "[", "1", "]"}], "]"}], "+", 
          RowBox[{"dv\[Delta]p", "[", 
           RowBox[{"\[Delta]phh", "[", "2", "]"}], "]"}], "+", 
          RowBox[{"dv\[Delta]p", "[", 
           RowBox[{"\[Delta]pdh", "[", "0", "]"}], "]"}], "+", 
          RowBox[{"dv\[Delta]p", "[", 
           RowBox[{"\[Delta]pdh", "[", "1", "]"}], "]"}]}], ")"}]}]}], "/.", 
      "subslistponly"}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<gsl_vector_set(f,0, ptplus1);\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<selgrad.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682160858838086*^9, 3.682160917127363*^9}, {
   3.68216096750389*^9, 3.682160979262237*^9}, {3.68216147288342*^9, 
   3.682161509821845*^9}, {3.682161587471574*^9, 3.6821615946291447`*^9}, {
   3.682161690631402*^9, 3.682161714530292*^9}, {3.682161774243383*^9, 
   3.682161790857154*^9}, {3.682161877146689*^9, 3.682161878065649*^9}, {
   3.682162324817855*^9, 3.682162351559415*^9}, 3.68232740484098*^9, {
   3.6823278149584618`*^9, 3.682327820410331*^9}, {3.682330388675725*^9, 
   3.6823303901044064`*^9}, {3.682330509454705*^9, 3.682330519485196*^9}, {
   3.6823305878318453`*^9, 3.682330603857889*^9}, {3.682332631808494*^9, 
   3.682332664849325*^9}, 3.682332701627718*^9, {3.682336292270938*^9, 
   3.682336334159027*^9}, {3.682337473173208*^9, 3.6823374733079033`*^9}, {
   3.6825931524741697`*^9, 3.682593158474628*^9}, {3.6827523758443413`*^9, 
   3.682752471623835*^9}, 3.6827527870913343`*^9, {3.682755722838686*^9, 
   3.6827557242862*^9}, {3.6827564661991787`*^9, 3.6827564688454523`*^9}, {
   3.684058922741806*^9, 3.6840589589719887`*^9}, {3.684060588091708*^9, 
   3.684060692588243*^9}, {3.69029821848623*^9, 3.690298218835876*^9}}],

Cell["Reproductive values", "Text",
 CellChangeTimes->{{3.682593141350663*^9, 3.682593144663989*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], ",", "1.0"}], "}"}]}], "}"}], 
  ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "\"\<\n\tdouble vh_1_tplus1;\n\tdouble vh_2_tplus1;\n\tdouble vd_0_tplus1;\
\n\tdouble vd_1_tplus1;\n\tfor (int rtime=0;rtime<1e07;++rtime) {\n\t\t\
vh_1_tplus1 = bound0(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vh", "[", "1", "]"}], "+", 
       RowBox[{"0.01", 
        RowBox[{"(", "dvh1dt", ")"}]}]}], "/.", "subslistponly"}], "]"}], 
    "<>", "\"\<);\n\t\tvh_2_tplus1 = bound0(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vh", "[", "2", "]"}], "+", 
       RowBox[{"0.01", 
        RowBox[{"(", "dvh2dt", ")"}]}]}], "/.", "subslistponly"}], "]"}], 
    "<>", "\"\<);\n\t\tvd_0_tplus1 = bound0(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vd", "[", "0", "]"}], "+", 
       RowBox[{"0.01", 
        RowBox[{"(", "dvd0dt", ")"}]}]}], "/.", "subslistponly"}], "]"}], 
    "<>", "\"\<);\n\t\tvd_1_tplus1 = bound0(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vd", "[", "1", "]"}], "+", 
       RowBox[{"0.01", 
        RowBox[{"(", "dvd1dt", ")"}]}]}], "/.", "subslistponly"}], "]"}], 
    "<>", "\"\<);\n\n\t\tif (fabs(vh_1_tplus1 - vh(1)) < 1e-7 &&\n\t\t\t\t\
fabs(vh_2_tplus1 - vh(2)) < 1e-7 &&\n\t\t\t\tfabs(vd_0_tplus1 - vd(0)) < 1e-7 \
&&\n\t\t\t\tfabs(vd_1_tplus1 - vd(1)) < 1e-7)\n\t\t{\n\t\t\tbreak;\n\t\t}\n\n\
\t\tvh(1) = vh_1_tplus1;\n\t\tvh(2) = vh_2_tplus1;\n\t\tvd(0) = vd_0_tplus1;\n\
\t\tvd(1) = vd_1_tplus1;\n\t}\n\tgsl_vector_set(f, 0, vh(1));\n\t\
gsl_vector_set(f, 1, vh(2));\n\tgsl_vector_set(f, 2, vd(0));\n\t\
gsl_vector_set(f, 3, vd(1));\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<repvals.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682593250402199*^9, 3.682593294323497*^9}, {
  3.6825934273266077`*^9, 3.682593500088787*^9}, {3.682593596267352*^9, 
  3.682593626105576*^9}, {3.68259371776462*^9, 3.682593719783543*^9}, {
  3.6825939700484*^9, 3.682593984356481*^9}, {3.6825942579923477`*^9, 
  3.682594281286126*^9}, {3.68259457678067*^9, 3.682594579536339*^9}, {
  3.682610346972528*^9, 3.682610366288414*^9}, {3.682756471064345*^9, 
  3.6827564728786907`*^9}, {3.684060719316674*^9, 3.6840607240580273`*^9}, {
  3.690293937603519*^9, 3.690294042466384*^9}, {3.690294210847473*^9, 
  3.6902945034401503`*^9}, {3.690298607256329*^9, 3.690298607789392*^9}, {
  3.6903000954813232`*^9, 3.690300124369986*^9}, {3.6903001765543747`*^9, 
  3.690300190948062*^9}, {3.690436006177135*^9, 3.690436012176351*^9}}],

Cell["Relatedness coefficients", "Text",
 CellChangeTimes->{{3.68259363336897*^9, 3.6825936366162*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "\"\<\n\tdouble rhhtplus1;\n\tdouble rhdtplus1;\n\tdouble rddtplus1;\n\t\
for (int rtime=0; rtime<1e07; ++rtime) {\n\t\trhhtplus1 = bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"drhhdt", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/.", "subslistponly"}], "]"}], "<>", 
    "\"\<);\n\t\trhdtplus1 = bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"drhddt", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/.", "subslistponly"}], "]"}], "<>", 
    "\"\<);\n\t\trddtplus1 = bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"drdddt", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/.", "subslistponly"}], "]"}], "<>", 
    "\"\<);\n\n\t\tif (\n\t\t\t\tfabs(rhhtplus1 - rhh) < 1e-07 &&\n\t\t\t\t\
fabs(rhdtplus1 - rhd) < 1e-07 &&\n\t\t\t\tfabs(rddtplus1 - rdd) < 1e-07\n\t\t\
\t)\n\t\t{\n\t\t\tbreak;\n\t\t}\n\t\trhh = rhhtplus1;\n\t\trhd = rhdtplus1;\n\
\t\trdd = rddtplus1;\n\t}\n\tgsl_vector_set(f, 0, rhh);\n\tgsl_vector_set(f, \
1, rhd);\n\tgsl_vector_set(f, 2, rdd);\>\""}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<relvals.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQXffYrOxv/mvHsO6eWhD974N8M4gObrveCqJTGJq7
QLT4x+UTQLRB894ZINprs8IsEK3xy2oziM4427kTRMtERz0E0SeU0sE0xx3d
FyDaaIoJmN7xxNvmH5Be0h9iB6KTu1fcYS147Wj26et9EP2LPZWDDUhv26jB
BaIvObq99wHSzg2lYHrbB/7fvkB6hoTKHxDNHX/s2Mmi145uojLHQbSAaNu8
9XVAfxRfXwSi/y+ctRlE+/D83Q6iq+bcYtsApNtfu3CBaN8XrEogWvrZI1UQ
vUY22QFEHzDVdwTREum+biCa44aKN4junL45GETPWDAvDER3LVbKA9E2i68V
g2jzWaIzN4Hka1+Dab7NB6MuAmk1p3nRIFrXSHf5JyB99/xUMA0AAYDQzw==

  "]],

Cell["Parameters:", "Text",
 CellChangeTimes->{{3.6821624526654873`*^9, 3.682162453913859*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{"d", ",", 
     RowBox[{"md", "[", "0", "]"}], ",", 
     RowBox[{"mh", "[", "1", "]"}], ",", 
     RowBox[{"md", "[", "1", "]"}], ",", 
     RowBox[{"mh", "[", "2", "]"}], ",", "pinit", ",", "err"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"variables", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"params", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", "0", "]"}], ",", 
        RowBox[{"f", "[", "1", "]"}], ",", "p", ",", "rhh", ",", "rhd", ",", 
        "rdd", ",", 
        RowBox[{"vh", "[", "1", "]"}], ",", 
        RowBox[{"vh", "[", "2", "]"}], ",", 
        RowBox[{"vd", "[", "0", "]"}], ",", 
        RowBox[{"vd", "[", "1", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iter", "=", "1"}], ",", 
    RowBox[{"iter", "<=", 
     RowBox[{"Length", "[", "params", "]"}]}], ",", 
    RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
       RowBox[{"toC", "[", 
        RowBox[{"params", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", "\"\<;\\n\>\""}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<params.txt\>\""}], ",", "str"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iter", "=", "1"}], ",", 
    RowBox[{"iter", "<=", 
     RowBox[{"Length", "[", "variables", "]"}]}], ",", 
    RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
       RowBox[{"toC", "[", 
        RowBox[{"variables", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", "\"\<;\\n\>\""}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<variables.txt\>\""}], ",", "str"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.682328066784473*^9, 3.6823281140851583`*^9}, {
   3.682328224431203*^9, 3.682328322993704*^9}, {3.682328487512398*^9, 
   3.682328527081253*^9}, {3.682328814505022*^9, 3.6823288434444647`*^9}, 
   3.6823289446691017`*^9, 3.6823290482043056`*^9, {3.682335793054305*^9, 
   3.682335793435977*^9}, {3.682594969037878*^9, 3.682594980745699*^9}, {
   3.682613114300337*^9, 3.682613122530101*^9}, {3.682752486814995*^9, 
   3.682752494529079*^9}, 3.684042260607793*^9, {3.684042371194415*^9, 
   3.6840423773158703`*^9}, {3.684060741429792*^9, 3.6840607476403303`*^9}, {
   3.6902796413810577`*^9, 3.6902796421848583`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export phh,pdh to C for numerical iterations", "Section",
 CellChangeTimes->{{3.682160783295267*^9, 3.682160788447118*^9}, {
   3.6826813294969597`*^9, 3.6826813320013933`*^9}, {3.682685866808383*^9, 
   3.68268586743937*^9}, {3.6827523487657824`*^9, 3.682752354629344*^9}, 
   3.684060565499308*^9, {3.684060769661354*^9, 3.6840607706527443`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toC", "[", "x_", "]"}], ":=", 
   RowBox[{"ToString", "[", 
    RowBox[{"CForm", "[", "x", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682161456693557*^9, 3.682161470196316*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"destdir", "=", 
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/freq_dep/src/numerical/simple/\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682161717565921*^9, 3.6821617711984797`*^9}, {
   3.6825933994944*^9, 3.682593404584663*^9}, {3.682679951619446*^9, 
   3.6826799539863863`*^9}, 3.682686016773263*^9, {3.682752360836028*^9, 
   3.68275236201057*^9}, 3.68295961553316*^9, 3.683007623426265*^9, {
   3.684060579440638*^9, 3.684060580326228*^9}, {3.684060776394454*^9, 
   3.6840607795534782`*^9}, 3.690435351119248*^9}],

Cell["Recursions patch frequencies:", "Text",
 CellChangeTimes->{{3.682161882166662*^9, 3.682161885670203*^9}, 
   3.6821624505393877`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subslistpx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "2", "]"}], "\[Rule]", 
      RowBox[{"1", "-", 
       RowBox[{"f", "[", "0", "]"}], "-", 
       RowBox[{"f", "[", "1", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "phh"}], ",", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "phh"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "pdh"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "pdh"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.682327597044585*^9, 3.6823276298697863`*^9}, {
   3.6823290359971857`*^9, 3.6823290417312613`*^9}, {3.6823357302793207`*^9, 
   3.68233578154373*^9}, {3.682335821498516*^9, 3.682335823800241*^9}, 
   3.6827523658025503`*^9, {3.6827564582527313`*^9, 3.682756459747501*^9}, {
   3.684042122362256*^9, 3.684042122696566*^9}, {3.6840605034147863`*^9, 
   3.6840605188031683`*^9}, {3.684060798725954*^9, 3.684060807893133*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "\"\<\ndouble df0dt = 0;\\n\ndouble df1dt = 0;\\n\nfor (int \
rtime=0;rtime<1e7;++rtime)\n{\\n\n df0dt=\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "0", "]"}], "+", 
       RowBox[{"0.01", "*", "df0dt"}]}], "/.", "subslistpx"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<df1dt=\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "1", "]"}], "+", 
       RowBox[{"0.01", "*", "df1dt"}]}], "/.", "subslistpx"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<if (fabs(df0dt-f(0))<1e-7 && fabs(df1dt-f(1))<1e-7)\n{\\n\n\
f(0)=bound01(df0dt);\\n\nf(1)=bound01(df1dt);\\n\nbreak;\n}\n\
f(0)=bound01(df0dt);\\n\nf(1)=bound01(df1dt);\\n\n}\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<gsl_vector_set(f,0,df0dt);\\ngsl_vector_set(f,1,df1dt);\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<patchrecurs.txt\>\""}], ",", "str"}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.682161887133985*^9, 3.682161949262312*^9}, {
  3.682162010303856*^9, 3.682162042156077*^9}, {3.682162104640438*^9, 
  3.682162123237709*^9}, {3.6821623891143293`*^9, 3.6821623939367723`*^9}, {
  3.682327392744194*^9, 3.682327394573818*^9}, {3.682327621755862*^9, 
  3.682327634169639*^9}, {3.68232903178618*^9, 3.682329034215569*^9}, {
  3.682332675735446*^9, 3.682332726798011*^9}, {3.682336840329123*^9, 
  3.682336959051839*^9}, {3.682337019281827*^9, 3.682337159552997*^9}, {
  3.6823374847557*^9, 3.682337501625996*^9}, {3.682338636259857*^9, 
  3.68233863667269*^9}, {3.6827564631202908`*^9, 3.682756464077887*^9}, {
  3.684060654639913*^9, 3.6840606568830214`*^9}, {3.68406081087127*^9, 
  3.684060813064576*^9}, {3.690436795903681*^9, 3.690436803141881*^9}}],

Cell["Selection gradients:", "Text",
 CellChangeTimes->{{3.682162445075205*^9, 3.682162448753883*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"\"\<double phhtplus1=bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"phh", "+", 
       RowBox[{"0.01", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dv\[Delta]p", "[", 
           RowBox[{"\[Delta]phh", "[", "1", "]"}], "]"}], "+", 
          RowBox[{"dv\[Delta]p", "[", 
           RowBox[{"\[Delta]phh", "[", "2", "]"}], "]"}]}], ")"}]}]}], "/.", 
      "subslistpx"}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double pdhtplus1=bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"pdh", "+", 
       RowBox[{"0.01", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dv\[Delta]p", "[", 
           RowBox[{"\[Delta]pdh", "[", "1", "]"}], "]"}], "+", 
          RowBox[{"dv\[Delta]p", "[", 
           RowBox[{"\[Delta]pdh", "[", "0", "]"}], "]"}]}], ")"}]}]}], "/.", 
      "subslistpx"}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<gsl_vector_set(f,0, phhtplus1);\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<gsl_vector_set(f,1, pdhtplus1);\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<selgrad.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682160858838086*^9, 3.682160917127363*^9}, {
   3.68216096750389*^9, 3.682160979262237*^9}, {3.68216147288342*^9, 
   3.682161509821845*^9}, {3.682161587471574*^9, 3.6821615946291447`*^9}, {
   3.682161690631402*^9, 3.682161714530292*^9}, {3.682161774243383*^9, 
   3.682161790857154*^9}, {3.682161877146689*^9, 3.682161878065649*^9}, {
   3.682162324817855*^9, 3.682162351559415*^9}, 3.68232740484098*^9, {
   3.6823278149584618`*^9, 3.682327820410331*^9}, {3.682330388675725*^9, 
   3.6823303901044064`*^9}, {3.682330509454705*^9, 3.682330519485196*^9}, {
   3.6823305878318453`*^9, 3.682330603857889*^9}, {3.682332631808494*^9, 
   3.682332664849325*^9}, 3.682332701627718*^9, {3.682336292270938*^9, 
   3.682336334159027*^9}, {3.682337473173208*^9, 3.6823374733079033`*^9}, {
   3.6825931524741697`*^9, 3.682593158474628*^9}, {3.6827523758443413`*^9, 
   3.682752471623835*^9}, 3.6827527870913343`*^9, {3.682755722838686*^9, 
   3.6827557242862*^9}, {3.6827564661991787`*^9, 3.6827564688454523`*^9}, {
   3.684058922741806*^9, 3.6840589589719887`*^9}, {3.684060588091708*^9, 
   3.684060692588243*^9}, {3.68406081736339*^9, 3.684060896162661*^9}, {
   3.690436760717145*^9, 3.6904367630523033`*^9}}],

Cell["Reproductive values", "Text",
 CellChangeTimes->{{3.682593141350663*^9, 3.682593144663989*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], ",", "1.0"}], "}"}]}], "}"}], 
  ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "\"\<\n\tdouble vh_1_tplus1;\n\tdouble vh_2_tplus1;\n\tdouble vd_0_tplus1;\
\n\tdouble vd_1_tplus1;\n\tfor (int rtime=0;rtime<1e07;++rtime) {\n\t\t\
vh_1_tplus1 = bound0(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vh", "[", "1", "]"}], "+", 
       RowBox[{"0.01", 
        RowBox[{"(", "dvh1dt", ")"}]}]}], "/.", "subslistpx"}], "]"}], "<>", 
    "\"\<);\n\t\tvh_2_tplus1 = bound0(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vh", "[", "2", "]"}], "+", 
       RowBox[{"0.01", 
        RowBox[{"(", "dvh2dt", ")"}]}]}], "/.", "subslistpx"}], "]"}], "<>", 
    "\"\<);\n\t\tvd_0_tplus1 = bound0(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vd", "[", "0", "]"}], "+", 
       RowBox[{"0.01", 
        RowBox[{"(", "dvd0dt", ")"}]}]}], "/.", "subslistpx"}], "]"}], "<>", 
    "\"\<);\n\t\tvd_1_tplus1 = bound0(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vd", "[", "1", "]"}], "+", 
       RowBox[{"0.01", 
        RowBox[{"(", "dvd1dt", ")"}]}]}], "/.", "subslistpx"}], "]"}], "<>", 
    "\"\<);\n\n\t\tif (fabs(vh_1_tplus1 - vh(1)) < 1e-7 &&\n\t\t\t\t\
fabs(vh_2_tplus1 - vh(2)) < 1e-7 &&\n\t\t\t\tfabs(vd_0_tplus1 - vd(0)) < 1e-7 \
&&\n\t\t\t\tfabs(vd_1_tplus1 - vd(1)) < 1e-7)\n\t\t{\n\t\t\tbreak;\n\t\t}\n\n\
\t\tvh(1) = vh_1_tplus1;\n\t\tvh(2) = vh_2_tplus1;\n\t\tvd(0) = vd_0_tplus1;\n\
\t\tvd(1) = vd_1_tplus1;\n\t}\n\tgsl_vector_set(f, 0, vh(1));\n\t\
gsl_vector_set(f, 1, vh(2));\n\tgsl_vector_set(f, 2, vd(0));\n\t\
gsl_vector_set(f, 3, vd(1));\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<repvals.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682593250402199*^9, 3.682593294323497*^9}, {
  3.6825934273266077`*^9, 3.682593500088787*^9}, {3.682593596267352*^9, 
  3.682593626105576*^9}, {3.68259371776462*^9, 3.682593719783543*^9}, {
  3.6825939700484*^9, 3.682593984356481*^9}, {3.6825942579923477`*^9, 
  3.682594281286126*^9}, {3.68259457678067*^9, 3.682594579536339*^9}, {
  3.682610346972528*^9, 3.682610366288414*^9}, {3.682756471064345*^9, 
  3.6827564728786907`*^9}, {3.684060719316674*^9, 3.6840607240580273`*^9}, {
  3.690293937603519*^9, 3.690294042466384*^9}, {3.690294210847473*^9, 
  3.6902945034401503`*^9}, {3.690298607256329*^9, 3.690298607789392*^9}, {
  3.6903000954813232`*^9, 3.690300124369986*^9}, {3.6903001765543747`*^9, 
  3.690300190948062*^9}, {3.690435908333384*^9, 3.690435912553088*^9}, {
  3.69043594533533*^9, 3.690435950029908*^9}}],

Cell["Relatedness coefficients", "Text",
 CellChangeTimes->{{3.68259363336897*^9, 3.6825936366162*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "\"\<\n\tdouble rhhtplus1;\n\tdouble rhdtplus1;\n\tdouble rddtplus1;\n\t\
for (int rtime=0; rtime<1e07; ++rtime) {\n\t\trhhtplus1 = bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"drhhdt", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/.", "subslistpx"}], "]"}], "<>", 
    "\"\<);\n\t\trhdtplus1 = bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"drhddt", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/.", "subslistpx"}], "]"}], "<>", 
    "\"\<);\n\t\trddtplus1 = bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"drdddt", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/.", "subslistpx"}], "]"}], "<>", 
    "\"\<);\n\n\t\tif (\n\t\t\t\tfabs(rhhtplus1 - rhh) < 1e-07 &&\n\t\t\t\t\
fabs(rhdtplus1 - rhd) < 1e-07 &&\n\t\t\t\tfabs(rddtplus1 - rdd) < 1e-07\n\t\t\
\t)\n\t\t{\n\t\t\tbreak;\n\t\t}\n\t\trhh = rhhtplus1;\n\t\trhd = rhdtplus1;\n\
\t\trdd = rddtplus1;\n\t}\n\tgsl_vector_set(f, 0, rhh);\n\tgsl_vector_set(f, \
1, rhd);\n\tgsl_vector_set(f, 2, rdd);\>\""}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<relvals.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQXffYrOxv/mvHsO6eWhD974N8M4gObrveCqJTGJq7
QLT4x+UTQLRB894ZINprs8IsEK3xy2oziM4427kTRMtERz0E0SeU0sE0xx3d
FyDaaIoJmN7xxNvmH5Be0h9iB6KTu1fcYS147Wj26et9EP2LPZWDDUhv26jB
BaIvObq99wHSzg2lYHrbB/7fvkB6hoTKHxDNHX/s2Mmi145uojLHQbSAaNu8
9XVAfxRfXwSi/y+ctRlE+/D83Q6iq+bcYtsApNtfu3CBaN8XrEogWvrZI1UQ
vUY22QFEHzDVdwTREum+biCa44aKN4junL45GETPWDAvDER3LVbKA9E2i68V
g2jzWaIzN4Hka1+Dab7NB6MuAmk1p3nRIHrlgdiVn4C0icB0MA0ACeHQpw==

  "]],

Cell["Parameters:", "Text",
 CellChangeTimes->{{3.6821624526654873`*^9, 3.682162453913859*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{"d", ",", 
     RowBox[{"md", "[", "0", "]"}], ",", 
     RowBox[{"mh", "[", "1", "]"}], ",", 
     RowBox[{"md", "[", "1", "]"}], ",", 
     RowBox[{"mh", "[", "2", "]"}], ",", "pdhinit", ",", "phhinit", ",", 
     "err"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"variables", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"params", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", "0", "]"}], ",", 
        RowBox[{"f", "[", "1", "]"}], ",", "pdh", ",", "phh", ",", "rhh", ",",
         "rhd", ",", "rdd", ",", 
        RowBox[{"vh", "[", "1", "]"}], ",", 
        RowBox[{"vh", "[", "2", "]"}], ",", 
        RowBox[{"vd", "[", "0", "]"}], ",", 
        RowBox[{"vd", "[", "1", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iter", "=", "1"}], ",", 
    RowBox[{"iter", "<=", 
     RowBox[{"Length", "[", "params", "]"}]}], ",", 
    RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
       RowBox[{"toC", "[", 
        RowBox[{"params", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", "\"\<;\\n\>\""}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<params.txt\>\""}], ",", "str"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iter", "=", "1"}], ",", 
    RowBox[{"iter", "<=", 
     RowBox[{"Length", "[", "variables", "]"}]}], ",", 
    RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
       RowBox[{"toC", "[", 
        RowBox[{"variables", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", "\"\<;\\n\>\""}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<variables.txt\>\""}], ",", "str"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.682328066784473*^9, 3.6823281140851583`*^9}, {
   3.682328224431203*^9, 3.682328322993704*^9}, {3.682328487512398*^9, 
   3.682328527081253*^9}, {3.682328814505022*^9, 3.6823288434444647`*^9}, 
   3.6823289446691017`*^9, 3.6823290482043056`*^9, {3.682335793054305*^9, 
   3.682335793435977*^9}, {3.682594969037878*^9, 3.682594980745699*^9}, {
   3.682613114300337*^9, 3.682613122530101*^9}, {3.682752486814995*^9, 
   3.682752494529079*^9}, 3.684042260607793*^9, {3.684042371194415*^9, 
   3.6840423773158703`*^9}, {3.684060741429792*^9, 3.6840607476403303`*^9}, {
   3.684060920419674*^9, 3.6840609425056543`*^9}, {3.690436067227174*^9, 
   3.69043606808987*^9}}],

Cell[CellGroupData[{

Cell[BoxData["c"], "Input",
 CellChangeTimes->{3.690436662746368*^9}],

Cell[BoxData["c"], "Output",
 CellChangeTimes->{3.6904366933415413`*^9, 3.690436766891073*^9, 
  3.6904368055080214`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1855, 1056},
WindowMargins->{{55, Automatic}, {Automatic, 14}},
PrivateNotebookOptions -> {
 "VersionedStylesheet" -> {"Default.nb"[8.] -> False}},
Magnification->1.5,
FrontEndVersion->"7.0 for Linux x86 (64-bit) (February 25, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 115, 1, 125, "Title"],
Cell[697, 25, 115, 1, 44, "Text"],
Cell[CellGroupData[{
Cell[837, 30, 109, 1, 107, "Section"],
Cell[949, 33, 139, 2, 100, "Input"],
Cell[CellGroupData[{
Cell[1113, 39, 134, 1, 145, "Subsection"],
Cell[1250, 42, 563, 9, 229, "Text"],
Cell[1816, 53, 2867, 86, 717, "Input"],
Cell[4686, 141, 3133, 88, 717, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[7868, 235, 99, 1, 60, "Section"],
Cell[7970, 238, 388, 13, 105, "Text"],
Cell[8361, 253, 1162, 36, 244, "Text"],
Cell[9526, 291, 2126, 59, 234, "Input"],
Cell[11655, 352, 121, 1, 100, "Text"],
Cell[11779, 355, 668, 17, 100, "Input"],
Cell[12450, 374, 118, 1, 100, "Text"],
Cell[12571, 377, 905, 26, 100, "Input"],
Cell[13479, 405, 123, 1, 100, "Text"],
Cell[13605, 408, 513, 15, 100, "Input"],
Cell[14121, 425, 303, 8, 100, "Input"],
Cell[14427, 435, 2244, 58, 298, "Input"],
Cell[16674, 495, 2344, 60, 298, "Input"],
Cell[19021, 557, 308, 7, 168, "Input"],
Cell[CellGroupData[{
Cell[19354, 568, 518, 13, 100, "Input"],
Cell[19875, 583, 1037, 19, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20949, 607, 744, 16, 100, "Input"],
Cell[21696, 625, 2943, 46, 105, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[24688, 677, 106, 1, 60, "Section"],
Cell[CellGroupData[{
Cell[24819, 682, 281, 8, 157, "Subsection"],
Cell[25103, 692, 281, 5, 1122, "Text"],
Cell[25387, 699, 702, 19, 2250, "Input"],
Cell[26092, 720, 139, 1, 1122, "Text"],
Cell[26234, 723, 503, 15, 2250, "Input"],
Cell[26740, 740, 310, 6, 1122, "Text"],
Cell[27053, 748, 666, 17, 2250, "Input"],
Cell[27722, 767, 308, 6, 1122, "Text"],
Cell[28033, 775, 619, 17, 2250, "Input"],
Cell[28655, 794, 266, 5, 1122, "Text"],
Cell[28924, 801, 1804, 48, 6088, "Input"],
Cell[30731, 851, 218, 4, 1122, "Text"],
Cell[30952, 857, 994, 27, 2250, "Input"],
Cell[31949, 886, 165, 3, 1122, "Text"],
Cell[32117, 891, 958, 28, 2250, "Input"],
Cell[33078, 921, 313, 7, 1642, "Input"],
Cell[CellGroupData[{
Cell[33416, 932, 1162, 31, 2458, "Input"],
Cell[34581, 965, 780, 15, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35398, 985, 153, 3, 1642, "Input"],
Cell[35554, 990, 4451, 134, 105, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[40054, 1130, 332, 9, 126, "Subsection"],
Cell[40389, 1141, 178, 4, 1122, "Text"],
Cell[40570, 1147, 525, 15, 2250, "Input"],
Cell[41098, 1164, 144, 1, 1122, "Text"],
Cell[41245, 1167, 455, 15, 2250, "Input"],
Cell[41703, 1184, 233, 5, 1122, "Text"],
Cell[41939, 1191, 466, 13, 2250, "Input"],
Cell[42408, 1206, 282, 6, 1122, "Text"],
Cell[42693, 1214, 600, 18, 2250, "Input"],
Cell[43296, 1234, 175, 4, 1122, "Text"],
Cell[43474, 1240, 1721, 50, 5427, "Input"],
Cell[45198, 1292, 165, 3, 1122, "Text"],
Cell[45366, 1297, 898, 26, 2250, "Input"],
Cell[46267, 1325, 164, 3, 1122, "Text"],
Cell[46434, 1330, 1005, 28, 2250, "Input"],
Cell[47442, 1360, 312, 7, 1642, "Input"],
Cell[CellGroupData[{
Cell[47779, 1371, 1212, 32, 2458, "Input"],
Cell[48994, 1405, 2020, 33, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51051, 1443, 152, 3, 1642, "Input"],
Cell[51206, 1448, 4513, 135, 105, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[55768, 1589, 289, 8, 126, "Subsection"],
Cell[56060, 1599, 178, 4, 1122, "Text"],
Cell[56241, 1605, 651, 17, 2250, "Input"],
Cell[56895, 1624, 187, 2, 1122, "Text"],
Cell[57085, 1628, 553, 16, 2250, "Input"],
Cell[57641, 1646, 179, 4, 1122, "Text"],
Cell[57823, 1652, 672, 17, 2250, "Input"],
Cell[58498, 1671, 233, 5, 1122, "Text"],
Cell[58734, 1678, 747, 19, 2250, "Input"],
Cell[59484, 1699, 162, 3, 1122, "Text"],
Cell[59649, 1704, 1523, 44, 4650, "Input"],
Cell[61175, 1750, 165, 3, 1122, "Text"],
Cell[61343, 1755, 947, 27, 2250, "Input"],
Cell[62293, 1784, 164, 3, 1122, "Text"],
Cell[62460, 1789, 1004, 28, 2250, "Input"],
Cell[63467, 1819, 314, 7, 1642, "Input"],
Cell[CellGroupData[{
Cell[63806, 1830, 1212, 32, 2458, "Input"],
Cell[65021, 1864, 1993, 33, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67051, 1902, 152, 3, 1642, "Input"],
Cell[67206, 1907, 4344, 132, 105, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[71599, 2045, 291, 8, 126, "Subsection"],
Cell[71893, 2055, 175, 4, 1122, "Text"],
Cell[72071, 2061, 703, 19, 2250, "Input"],
Cell[72777, 2082, 141, 1, 1122, "Text"],
Cell[72921, 2085, 529, 16, 2250, "Input"],
Cell[73453, 2103, 180, 4, 1122, "Text"],
Cell[73636, 2109, 442, 12, 2250, "Input"],
Cell[74081, 2123, 180, 4, 1122, "Text"],
Cell[74264, 2129, 623, 18, 2250, "Input"],
Cell[74890, 2149, 161, 3, 1122, "Text"],
Cell[75054, 2154, 1715, 50, 5427, "Input"],
Cell[76772, 2206, 165, 3, 1122, "Text"],
Cell[76940, 2211, 997, 27, 2250, "Input"],
Cell[77940, 2240, 164, 3, 1122, "Text"],
Cell[78107, 2245, 1055, 29, 2250, "Input"],
Cell[79165, 2276, 312, 7, 1642, "Input"],
Cell[CellGroupData[{
Cell[79502, 2287, 1212, 32, 2458, "Input"],
Cell[80717, 2321, 1972, 32, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82726, 2358, 152, 3, 1642, "Input"],
Cell[82881, 2363, 4473, 135, 105, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[87403, 2504, 107, 1, 114, "Subsection"],
Cell[87513, 2507, 2180, 64, 456, "Input"],
Cell[89696, 2573, 3147, 78, 364, "Input"],
Cell[92846, 2653, 3350, 81, 364, "Input"],
Cell[96199, 2736, 3031, 74, 429, "Input"],
Cell[CellGroupData[{
Cell[99255, 2814, 747, 16, 150, "Input"],
Cell[100005, 2832, 2180, 32, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102222, 2869, 1238, 23, 150, "Input"],
Cell[103463, 2894, 2712, 43, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106212, 2942, 1242, 23, 150, "Input"],
Cell[107457, 2967, 2668, 43, 105, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[110186, 3017, 109, 1, 60, "Section"],
Cell[CellGroupData[{
Cell[110320, 3022, 119, 1, 145, "Subsection"],
Cell[110442, 3025, 140, 1, 100, "Text"],
Cell[110585, 3028, 888, 24, 186, "Input"],
Cell[111476, 3054, 204, 4, 100, "Text"],
Cell[111683, 3060, 679, 21, 186, "Input"],
Cell[112365, 3083, 792, 20, 100, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113194, 3108, 120, 1, 145, "Subsection"],
Cell[113317, 3111, 134, 1, 100, "Text"],
Cell[113454, 3114, 727, 23, 186, "Input"],
Cell[114184, 3139, 144, 1, 100, "Text"],
Cell[114331, 3142, 808, 26, 186, "Input"],
Cell[115142, 3170, 142, 1, 100, "Text"],
Cell[115287, 3173, 680, 22, 186, "Input"],
Cell[115970, 3197, 280, 3, 100, "Text"],
Cell[116253, 3202, 739, 22, 186, "Input"],
Cell[116995, 3226, 1284, 34, 168, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118316, 3265, 116, 1, 145, "Subsection"],
Cell[118435, 3268, 134, 1, 100, "Text"],
Cell[118572, 3271, 678, 22, 186, "Input"],
Cell[119253, 3295, 205, 4, 100, "Text"],
Cell[119461, 3301, 854, 27, 186, "Input"],
Cell[120318, 3330, 854, 24, 100, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121209, 3359, 120, 1, 145, "Subsection"],
Cell[CellGroupData[{
Cell[121354, 3364, 159, 3, 100, "Input"],
Cell[121516, 3369, 1701, 29, 105, "Output"]
}, Open  ]],
Cell[123232, 3401, 214, 6, 100, "Input"],
Cell[123449, 3409, 155, 3, 100, "Text"],
Cell[123607, 3414, 130, 2, 100, "Text"],
Cell[123740, 3418, 2991, 71, 643, "Input"],
Cell[CellGroupData[{
Cell[126756, 3493, 192, 3, 150, "Input"],
Cell[126951, 3498, 629, 9, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127617, 3512, 196, 3, 150, "Input"],
Cell[127816, 3517, 582, 8, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128435, 3530, 580, 17, 150, "Input"],
Cell[129018, 3549, 264, 4, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129319, 3558, 384, 11, 150, "Input"],
Cell[129706, 3571, 529, 13, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130272, 3589, 1476, 30, 150, "Input"],
Cell[131751, 3621, 860, 15, 105, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[132672, 3643, 205, 3, 60, "Section"],
Cell[CellGroupData[{
Cell[132902, 3650, 536, 13, 56, "Subsection"],
Cell[133441, 3665, 281, 5, 44, "Text"],
Cell[133725, 3672, 1012, 25, 69, "Input"],
Cell[134740, 3699, 139, 1, 44, "Text"],
Cell[134882, 3702, 636, 17, 69, "Input"],
Cell[135521, 3721, 310, 6, 44, "Text"],
Cell[135834, 3729, 919, 22, 69, "Input"],
Cell[136756, 3753, 308, 6, 44, "Text"],
Cell[137067, 3761, 873, 23, 69, "Input"],
Cell[137943, 3786, 266, 5, 44, "Text"],
Cell[138212, 3793, 2149, 56, 69, "Input"],
Cell[140364, 3851, 218, 4, 44, "Text"],
Cell[140585, 3857, 1414, 37, 69, "Input"],
Cell[142002, 3896, 165, 3, 44, "Text"],
Cell[142170, 3901, 1376, 37, 69, "Input"],
Cell[143549, 3940, 539, 10, 46, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144125, 3955, 494, 13, 56, "Subsection"],
Cell[144622, 3970, 178, 4, 44, "Text"],
Cell[144803, 3976, 803, 21, 69, "Input"],
Cell[145609, 3999, 144, 1, 44, "Text"],
Cell[145756, 4002, 636, 17, 69, "Input"],
Cell[146395, 4021, 233, 5, 44, "Text"],
Cell[146631, 4028, 738, 19, 69, "Input"],
Cell[147372, 4049, 282, 6, 44, "Text"],
Cell[147657, 4057, 855, 24, 69, "Input"],
Cell[148515, 4083, 175, 4, 44, "Text"],
Cell[148693, 4089, 2129, 58, 102, "Input"],
Cell[150825, 4149, 165, 3, 44, "Text"],
Cell[150993, 4154, 1335, 36, 69, "Input"],
Cell[152331, 4192, 164, 3, 44, "Text"],
Cell[152498, 4197, 1448, 38, 69, "Input"],
Cell[153949, 4237, 534, 10, 46, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154520, 4252, 270, 9, 56, "Subsection"],
Cell[154793, 4263, 178, 4, 44, "Text"],
Cell[154974, 4269, 876, 22, 69, "Input"],
Cell[155853, 4293, 187, 2, 44, "Text"],
Cell[156043, 4297, 584, 16, 69, "Input"],
Cell[156630, 4315, 179, 4, 44, "Text"],
Cell[156812, 4321, 850, 21, 69, "Input"],
Cell[157665, 4344, 233, 5, 44, "Text"],
Cell[157901, 4351, 917, 23, 69, "Input"],
Cell[158821, 4376, 162, 3, 44, "Text"],
Cell[158986, 4381, 1771, 50, 69, "Input"],
Cell[160760, 4433, 165, 3, 44, "Text"],
Cell[160928, 4438, 1284, 35, 69, "Input"],
Cell[162215, 4475, 164, 3, 44, "Text"],
Cell[162382, 4480, 1346, 37, 69, "Input"],
Cell[163731, 4519, 484, 9, 46, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164252, 4533, 271, 9, 56, "Subsection"],
Cell[164526, 4544, 175, 4, 44, "Text"],
Cell[164704, 4550, 936, 24, 69, "Input"],
Cell[165643, 4576, 141, 1, 44, "Text"],
Cell[165787, 4579, 564, 16, 69, "Input"],
Cell[166354, 4597, 180, 4, 44, "Text"],
Cell[166537, 4603, 616, 17, 69, "Input"],
Cell[167156, 4622, 180, 4, 44, "Text"],
Cell[167339, 4628, 807, 23, 69, "Input"],
Cell[168149, 4653, 161, 3, 44, "Text"],
Cell[168313, 4658, 1973, 56, 102, "Input"],
Cell[170289, 4716, 165, 3, 44, "Text"],
Cell[170457, 4721, 1337, 36, 69, "Input"],
Cell[171797, 4759, 164, 3, 44, "Text"],
Cell[171964, 4764, 1397, 38, 69, "Input"],
Cell[173364, 4804, 438, 9, 46, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173839, 4818, 112, 1, 56, "Subsection"],
Cell[173954, 4821, 796, 23, 69, "Input"],
Cell[CellGroupData[{
Cell[174775, 4848, 422, 8, 46, "Input"],
Cell[175200, 4858, 2555, 78, 108, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[177816, 4943, 293, 3, 107, "Section"],
Cell[178112, 4948, 236, 6, 46, "Input"],
Cell[178351, 4956, 498, 10, 46, "Input"],
Cell[178852, 4968, 139, 2, 44, "Text"],
Cell[178994, 4972, 607, 13, 46, "Input"],
Cell[179604, 4987, 2033, 49, 557, "Input"],
Cell[181640, 5038, 102, 1, 44, "Text"],
Cell[181745, 5041, 3241, 76, 287, "Input"],
Cell[184989, 5119, 101, 1, 44, "Text"],
Cell[185093, 5122, 458, 16, 46, "Input"],
Cell[185554, 5140, 2705, 57, 917, "Input"],
Cell[188262, 5199, 103, 1, 44, "Text"],
Cell[188368, 5202, 1725, 38, 767, "Input"],
Cell[190096, 5242, 95, 1, 44, "Text"],
Cell[190194, 5245, 3175, 78, 437, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[193406, 5328, 300, 4, 107, "Section"],
Cell[193709, 5334, 236, 6, 46, "Input"],
Cell[193948, 5342, 521, 10, 46, "Input"],
Cell[194472, 5354, 139, 2, 44, "Text"],
Cell[194614, 5358, 991, 24, 46, "Input"],
Cell[195608, 5384, 2088, 50, 557, "Input"],
Cell[197699, 5436, 102, 1, 44, "Text"],
Cell[197804, 5439, 2209, 44, 107, "Input"],
Cell[200016, 5485, 101, 1, 44, "Text"],
Cell[200120, 5488, 458, 16, 46, "Input"],
Cell[200581, 5506, 2668, 56, 917, "Input"],
Cell[203252, 5564, 103, 1, 69, "Text"],
Cell[203358, 5567, 1751, 39, 1150, "Input"],
Cell[205112, 5608, 95, 1, 100, "Text"],
Cell[205210, 5611, 3036, 75, 951, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[208283, 5691, 354, 4, 267, "Section"],
Cell[208640, 5697, 236, 6, 100, "Input"],
Cell[208879, 5705, 573, 11, 100, "Input"],
Cell[209455, 5718, 139, 2, 100, "Text"],
Cell[209597, 5722, 1042, 24, 100, "Input"],
Cell[210642, 5748, 2127, 50, 1212, "Input"],
Cell[212772, 5800, 102, 1, 100, "Text"],
Cell[212877, 5803, 2745, 60, 364, "Input"],
Cell[215625, 5865, 101, 1, 100, "Text"],
Cell[215729, 5868, 458, 16, 100, "Input"],
Cell[216190, 5886, 2704, 57, 1995, "Input"],
Cell[218897, 5945, 103, 1, 100, "Text"],
Cell[219003, 5948, 1742, 39, 1669, "Input"],
Cell[220748, 5989, 95, 1, 100, "Text"],
Cell[220846, 5992, 3118, 76, 951, "Input"],
Cell[CellGroupData[{
Cell[223989, 6072, 69, 1, 100, "Input"],
Cell[224061, 6075, 121, 2, 150, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
