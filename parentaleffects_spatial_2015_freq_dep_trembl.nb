(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    236494,       6475]
NotebookOptionsPosition[    222620,       6079]
NotebookOutlinePosition[    223054,       6096]
CellTagsIndexPosition[    223011,       6093]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Parental effects when selection is frequency-dependent", "Title",
 CellChangeTimes->{3.6818996774622307`*^9}],

Cell["Bram Kuijper & Rufus A. Johnstone", "Text",
 CellChangeTimes->{{3.682098419373761*^9, 3.682098425405418*^9}}],

Cell[CellGroupData[{

Cell["Functions and parameters", "Section",
 CellChangeTimes->{{3.684050105851204*^9, 3.684050108010929*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.681924447829236*^9, 3.681924455422717*^9}}],

Cell[CellGroupData[{

Cell["Probability of producing a hawk type offspring", "Subsection",
 CellChangeTimes->{{3.684050269632327*^9, 3.684050286911909*^9}}],

Cell["\<\
With probability 1-\[Epsilon], an individual will have the proper information \
about its own state, so it uses the strategy corresponding to its state. \
However, with probability \[Epsilon], it makes an error in assessing its own \
state, so is equally likely to use one of the three strategies that do not \
correspond to its actual state. Such 'trembling hand' probabilities assure \
convergence to the proper equilibria\
\>", "Text",
 CellChangeTimes->{{3.684050149122243*^9, 3.684050215297123*^9}, {
  3.690104183285851*^9, 3.690104202781234*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ph", "[", 
   RowBox[{"statefocal_", ",", "stateother_"}], "]"}], ":=", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"statefocal", ",", "stateother"}], "}"}], ",", "h"}], "]"}], 
     "\[Equal]", "2"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "err"}], ")"}], 
      RowBox[{"phh", "[", "2", "]"}]}], "+", 
     RowBox[{
      FractionBox["err", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pdh", "[", "0", "]"}], "+", 
        RowBox[{"pdh", "[", "1", "]"}], "+", 
        RowBox[{"phh", "[", "1", "]"}], "+", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}]}]}], ",", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", "statefocal", "}"}], ",", "h"}], "]"}], "\[Equal]", "1"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "err"}], ")"}], 
      RowBox[{"phh", "[", "1", "]"}]}], "+", 
     RowBox[{
      FractionBox["err", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pdh", "[", "0", "]"}], "+", 
        RowBox[{"pdh", "[", "1", "]"}], "+", 
        RowBox[{"phh", "[", "1", "]"}], "+", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"statefocal", ",", "stateother"}], "}"}], ",", "d"}], "]"}], 
     "\[Equal]", "2"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "err"}], ")"}], 
      RowBox[{"pdh", "[", "0", "]"}]}], "+", 
     RowBox[{
      FractionBox["err", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pdh", "[", "0", "]"}], "+", 
        RowBox[{"pdh", "[", "1", "]"}], "+", 
        RowBox[{"phh", "[", "1", "]"}], "+", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", "statefocal", "}"}], ",", "d"}], "]"}], "\[Equal]", "1"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "err"}], ")"}], 
      RowBox[{"pdh", "[", "1", "]"}]}], "+", 
     RowBox[{
      FractionBox["err", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pdh", "[", "0", "]"}], "+", 
        RowBox[{"pdh", "[", "1", "]"}], "+", 
        RowBox[{"phh", "[", "1", "]"}], "+", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.68404956158158*^9, 3.684049616729436*^9}, {
   3.684049791430171*^9, 3.684049820598483*^9}, {3.684049851477421*^9, 
   3.6840499022472887`*^9}, {3.684049956478529*^9, 3.684050076115114*^9}, 
   3.684050279134152*^9, {3.684051210313464*^9, 3.684051210961623*^9}, {
   3.68405555384797*^9, 3.684055581568616*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dph", "[", 
   RowBox[{"statefocal_", ",", "stateother_"}], "]"}], ":=", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"statefocal", ",", "stateother"}], "}"}], ",", "h"}], "]"}], 
     "\[Equal]", "2"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "err"}], ")"}], 
      RowBox[{"\[Delta]phh", "[", "2", "]"}]}], "+", 
     RowBox[{
      FractionBox["err", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Delta]pdh", "[", "0", "]"}], "+", 
        RowBox[{"\[Delta]pdh", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]phh", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]phh", "[", "2", "]"}]}], ")"}]}]}], ",", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", "statefocal", "}"}], ",", "h"}], "]"}], "\[Equal]", "1"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "err"}], ")"}], 
      RowBox[{"\[Delta]phh", "[", "1", "]"}]}], "+", 
     RowBox[{
      FractionBox["err", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Delta]pdh", "[", "0", "]"}], "+", 
        RowBox[{"\[Delta]pdh", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]phh", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]phh", "[", "2", "]"}]}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"statefocal", ",", "stateother"}], "}"}], ",", "d"}], "]"}], 
     "\[Equal]", "2"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "err"}], ")"}], 
      RowBox[{"\[Delta]pdh", "[", "0", "]"}]}], "+", 
     RowBox[{
      FractionBox["err", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Delta]pdh", "[", "0", "]"}], "+", 
        RowBox[{"\[Delta]pdh", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]phh", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]phh", "[", "2", "]"}]}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", "statefocal", "}"}], ",", "d"}], "]"}], "\[Equal]", "1"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "err"}], ")"}], 
      RowBox[{"\[Delta]pdh", "[", "1", "]"}]}], "+", 
     RowBox[{
      FractionBox["err", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Delta]pdh", "[", "0", "]"}], "+", 
        RowBox[{"\[Delta]pdh", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]phh", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]phh", "[", "2", "]"}]}], ")"}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.68404956158158*^9, 3.684049616729436*^9}, {
   3.684049791430171*^9, 3.684049820598483*^9}, {3.684049851477421*^9, 
   3.6840499022472887`*^9}, {3.684049956478529*^9, 3.684050076115114*^9}, {
   3.684050226582571*^9, 3.684050232559411*^9}, 3.684050280773467*^9, {
   3.684050316060474*^9, 3.684050358172432*^9}, {3.6840512076581297`*^9, 
   3.684051208275051*^9}, {3.6840568114228773`*^9, 3.684056847877692*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Patch frequencies", "Section",
 CellChangeTimes->{{3.68189965661395*^9, 3.6818996615808*^9}}],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "i"], TraditionalForm]]],
 " is the frequency of patches with ",
 StyleBox["i",
  FontSlant->"Italic"],
 " \[Element] {0,1,2} hawks and hence 2-",
 StyleBox["i",
  FontSlant->"Italic"],
 " doves."
}], "Text",
 CellChangeTimes->{{3.6819018342879744`*^9, 3.681901910549037*^9}, {
  3.681904152530301*^9, 3.681904152644826*^9}}],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", 
    RowBox[{"h", ",", "i"}]], TraditionalForm]]],
 " is the probability that a juvenile hawk is winning the vacant breeding \
spot in a patch which originally consisted of ",
 StyleBox["i",
  FontSlant->"Italic"],
 " hawks and hence 2-",
 StyleBox["i",
  FontSlant->"Italic"],
 " doves before mortality of one of the breeders."
}], "Text",
 CellChangeTimes->{{3.6819039840971107`*^9, 3.681904066643919*^9}, {
  3.690115803825152*^9, 3.690115816846404*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bh", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"i", " ", 
          RowBox[{"ph", "[", 
           RowBox[{"h", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "\[Equal]", "1"}], ",", "d", ",", "h"}], "]"}]}], 
           "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "-", "i"}], ")"}], 
          RowBox[{"ph", "[", 
           RowBox[{"d", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "\[Equal]", "1"}], ",", "h", ",", "d"}], "]"}]}], 
           "]"}]}]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", 
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "==", "1"}], ",", "d", ",", "h"}], "]"}]}], 
              "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                "]"}]}], "]"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], "/", 
    "2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819039713714046`*^9, 3.681903978612687*^9}, {
  3.6819040771926947`*^9, 3.6819041023390837`*^9}, {3.681904163060503*^9, 
  3.681904270122064*^9}, {3.681904300185986*^9, 3.681904444729485*^9}, {
  3.6840508300520687`*^9, 3.68405086794526*^9}, {3.6840509309222307`*^9, 
  3.684050951728066*^9}, {3.684050983010207*^9, 3.6840510098942957`*^9}, {
  3.684051045216721*^9, 3.6840510468951178`*^9}}],

Cell["change in patches containing 0 hawks:", "Text",
 CellChangeTimes->{{3.681904530319077*^9, 3.6819045397030687`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"df0dt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"mh", "[", "1", "]"}], " ", 
     RowBox[{"f", "[", "1", "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"bh", "[", "1", "]"}]}], ")"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"md", "[", "0", "]"}], 
     RowBox[{"f", "[", "0", "]"}], 
     RowBox[{"bh", "[", "0", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681901913515662*^9, 3.681901919598167*^9}, {
  3.681902804112299*^9, 3.681902829255541*^9}, {3.681903958613819*^9, 
  3.681903963357703*^9}, {3.681904139317212*^9, 3.681904149933847*^9}, {
  3.6819044709174433`*^9, 3.6819045247990437`*^9}}],

Cell["change in patches containing 1 hawk:", "Text",
 CellChangeTimes->{{3.681904542038992*^9, 3.681904547814187*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"df1dt", "=", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"md", "[", "0", "]"}], 
     RowBox[{"f", "[", "0", "]"}], 
     RowBox[{"bh", "[", "0", "]"}]}], "+", 
    RowBox[{"2", 
     RowBox[{"mh", "[", "2", "]"}], 
     RowBox[{"f", "[", "2", "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"bh", "[", "2", "]"}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"mh", "[", "1", "]"}], 
     RowBox[{"f", "[", "1", "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"bh", "[", "1", "]"}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"md", "[", "1", "]"}], 
     RowBox[{"f", "[", "1", "]"}], 
     RowBox[{"bh", "[", "1", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819045488015738`*^9, 3.681904559170224*^9}, {
   3.681904591904851*^9, 3.681904600038515*^9}, {3.681905069986167*^9, 
   3.681905101778099*^9}, 3.681910678497465*^9}],

Cell["change in patches containing 2 hawks:", "Text",
 CellChangeTimes->{{3.6819075017920513`*^9, 3.6819075089205437`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"df2dt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"md", "[", "1", "]"}], 
     RowBox[{"f", "[", "1", "]"}], 
     RowBox[{"bh", "[", "1", "]"}]}], "-", 
    RowBox[{"2", 
     RowBox[{"mh", "[", "2", "]"}], 
     RowBox[{"f", "[", "2", "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"bh", "[", "2", "]"}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819075099561577`*^9, 3.6819075109303007`*^9}, {
  3.681910636246025*^9, 3.68191068067453*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfconstraint", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", "0", "]"}], "+", 
     RowBox[{"f", "[", "1", "]"}], "+", 
     RowBox[{"f", "[", "2", "]"}]}], "\[Equal]", "1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681923972397983*^9, 3.681923989853321*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans", "[", 
   RowBox[{
    RowBox[{"{", "ds_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"mh1_", ",", "mh2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"md0_", ",", "md1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"phhs_", ",", "pdhs_"}], "}"}], ",", 
    RowBox[{"{", "\[Epsilon]_", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dfconstraint", ",", 
       RowBox[{"df1dt", "\[Equal]", "0"}], ",", 
       RowBox[{"df2dt", "\[Equal]", "0"}]}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"d", "\[Rule]", "ds"}], ",", 
       RowBox[{
        RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "mh1"}], ",", 
       RowBox[{
        RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "mh2"}], ",", 
       RowBox[{
        RowBox[{"md", "[", "0", "]"}], "\[Rule]", "md0"}], ",", 
       RowBox[{
        RowBox[{"md", "[", "1", "]"}], "\[Rule]", "md1"}], ",", 
       RowBox[{
        RowBox[{"md", "[", "2", "]"}], "\[Rule]", "md2"}], ",", 
       RowBox[{
        RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "phhs"}], ",", 
       RowBox[{
        RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "phhs"}], ",", 
       RowBox[{
        RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "pdhs"}], ",", 
       RowBox[{
        RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "pdhs"}], ",", 
       RowBox[{"err", "\[Rule]", "\[Epsilon]"}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "[", "0", "]"}], ",", 
      RowBox[{"1", "/", "3"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "[", "1", "]"}], ",", 
      RowBox[{"1", "/", "3"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "[", "2", "]"}], ",", 
      RowBox[{"1", "/", "3"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.681924118975501*^9, 3.681924156790517*^9}, {
  3.6819243122794027`*^9, 3.6819244818605423`*^9}, {3.681924517699847*^9, 
  3.681924534250153*^9}, {3.6840510767059526`*^9, 3.684051102297209*^9}, {
  3.684051290573268*^9, 3.684051324237236*^9}, {3.684055418536881*^9, 
  3.6840554219436207`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansalt", "[", 
   RowBox[{
    RowBox[{"{", "ds_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"mh1_", ",", "mh2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"md0_", ",", "md1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"phhs_", ",", "pdhs_"}], "}"}], ",", 
    RowBox[{"{", "\[Epsilon]_", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"df0dt", "\[Equal]", "0"}], ",", 
       RowBox[{"df1dt", "\[Equal]", "0"}], ",", "dfconstraint"}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"d", "\[Rule]", "ds"}], ",", 
       RowBox[{
        RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "mh1"}], ",", 
       RowBox[{
        RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "mh2"}], ",", 
       RowBox[{
        RowBox[{"md", "[", "0", "]"}], "\[Rule]", "md0"}], ",", 
       RowBox[{
        RowBox[{"md", "[", "1", "]"}], "\[Rule]", "md1"}], ",", 
       RowBox[{
        RowBox[{"md", "[", "2", "]"}], "\[Rule]", "md2"}], ",", 
       RowBox[{
        RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "phhs"}], ",", 
       RowBox[{
        RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "phhs"}], ",", 
       RowBox[{
        RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "pdhs"}], ",", 
       RowBox[{
        RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "pdhs"}], ",", 
       RowBox[{"err", "\[Rule]", "\[Epsilon]"}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "[", "0", "]"}], ",", 
      RowBox[{"1", "/", "3"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "[", "1", "]"}], ",", 
      RowBox[{"1", "/", "3"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "[", "2", "]"}], ",", 
      RowBox[{"1", "/", "3"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.681924118975501*^9, 3.681924156790517*^9}, {
  3.6819243122794027`*^9, 3.6819244818605423`*^9}, {3.681924517699847*^9, 
  3.681924534250153*^9}, {3.681924565464492*^9, 3.681924593605667*^9}, {
  3.68200883114145*^9, 3.6820088312578363`*^9}, {3.684051086017952*^9, 
  3.684051110577001*^9}, {3.68405126927043*^9, 3.684051326339697*^9}, {
  3.6840554115931683`*^9, 3.684055415350945*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vx", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cx", "=", "0.0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.68236123575275*^9, 3.682361245898793*^9}, {
  3.682411311012822*^9, 3.6824113134751883`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans", "[", 
  RowBox[{
   RowBox[{"{", "1.0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.75", ",", "1.275"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.875", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", "0.05", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6840512384308643`*^9, 3.6840512612458057`*^9}, {
  3.684054147010518*^9, 3.6840541473277273`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "0", "]"}], "\[Rule]", "0.35707446661733694`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", "1", "]"}], "\[Rule]", "0.5170796272317532`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", "2", "]"}], "\[Rule]", "0.12584590615090988`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6840512394022827`*^9, 3.684051261777645*^9}, 
   3.6840513336780567`*^9, 3.684053128920824*^9, 3.684054022665802*^9, 
   3.684054147999116*^9, 3.68405467871943*^9, 3.6840548241754293`*^9, 
   3.684054905003276*^9, 3.6840550078010798`*^9, 3.684055120945958*^9, 
   3.68405519380398*^9, 3.684055262726862*^9, 3.6840553746861877`*^9, 
   3.6840554319160137`*^9, 3.6840555932331963`*^9, 3.684057225945133*^9, 
   3.684059043151601*^9, 3.684060966549691*^9, 3.684061743220078*^9, 
   3.690267380095055*^9, 3.6902777790359793`*^9, 3.690292662985847*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ansalt", "[", 
  RowBox[{
   RowBox[{"{", "1.0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.75", ",", "1.275"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.875", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", "0.05", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6819244867924747`*^9, 3.681924613239189*^9}, {
  3.6823384887850313`*^9, 3.682338488956525*^9}, {3.682338600628825*^9, 
  3.68233860443326*^9}, {3.682583980871499*^9, 3.682583982550872*^9}, {
  3.684051121226376*^9, 3.684051123025075*^9}, {3.6840512636793547`*^9, 
  3.684051264773897*^9}, {3.6840541502916813`*^9, 3.6840541508555326`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "0", "]"}], "\[Rule]", "0.35707446661733694`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", "1", "]"}], "\[Rule]", "0.5170796272317532`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", "2", "]"}], "\[Rule]", "0.12584590615090988`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6819245522259073`*^9, 3.681924615821735*^9}, 
   3.681926870831225*^9, {3.681928244463222*^9, 3.681928258248083*^9}, {
   3.682006505568344*^9, 3.68200653536981*^9}, 3.682006644064026*^9, {
   3.682006775439999*^9, 3.682006788362774*^9}, 3.682006826763332*^9, 
   3.6820069810580473`*^9, {3.682007119954248*^9, 3.6820071371740437`*^9}, {
   3.682007221068923*^9, 3.6820072418383083`*^9}, 3.6820073472384787`*^9, 
   3.6820074567725277`*^9, 3.682007544733746*^9, 3.682007646515525*^9, 
   3.682008293446879*^9, 3.68200883665275*^9, 3.682009896333275*^9, 
   3.6820099587828093`*^9, {3.6820154010983562`*^9, 3.6820154209843807`*^9}, 
   3.68209325692372*^9, 3.682094538599547*^9, 3.682094818166445*^9, 
   3.682094968278758*^9, 3.682097638630952*^9, 3.682147217990324*^9, 
   3.68214728893102*^9, 3.682147419568635*^9, 3.6821580452874537`*^9, 
   3.682158082363327*^9, 3.68215908409638*^9, 3.682159128818781*^9, 
   3.682159180091772*^9, 3.682159403664535*^9, 3.6821607726187677`*^9, {
   3.6821609091916437`*^9, 3.682160936826367*^9}, 3.682161203545829*^9, 
   3.682161516435955*^9, 3.682161568683557*^9, 3.68232751208876*^9, 
   3.682328817671764*^9, 3.6823384893732*^9, {3.682338601179194*^9, 
   3.682338604874834*^9}, 3.682360884714677*^9, 3.682362214049869*^9, 
   3.682399328955291*^9, 3.682402016398294*^9, 3.682411309257737*^9, 
   3.682411358355455*^9, 3.682583989573161*^9, 3.682593317443838*^9, 
   3.682610370154532*^9, 3.682610678940941*^9, 3.6826107094395943`*^9, 
   3.682680756137733*^9, 3.682685994128495*^9, 3.68275270248948*^9, 
   3.682756709097239*^9, 3.682756761360654*^9, 3.6827572406953506`*^9, 
   3.682760329591195*^9, 3.6829300883799543`*^9, 3.682945411827475*^9, 
   3.6829579517718887`*^9, 3.682958003681329*^9, 3.682959516786428*^9, 
   3.6829611565510817`*^9, 3.6830075540584183`*^9, 3.6830075867367268`*^9, 
   3.683007627661615*^9, 3.684042724683947*^9, 3.684051128561358*^9, 
   3.6840512305006447`*^9, 3.6840512651652107`*^9, 3.684051333722705*^9, 
   3.684053128962764*^9, 3.684054022721218*^9, 3.6840541513749857`*^9, 
   3.684054678753543*^9, 3.684054824233872*^9, 3.6840549050591593`*^9, 
   3.684055007863554*^9, 3.6840551210109367`*^9, 3.684055193862143*^9, 
   3.684055262770403*^9, 3.684055374736802*^9, 3.684055431953965*^9, 
   3.684055593277775*^9, 3.684057225986519*^9, 3.684059043184778*^9, 
   3.684060966680551*^9, 3.68406174324677*^9, 3.690267380141623*^9, 
   3.69027777908422*^9, 3.690292663029478*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reproductive values", "Section",
 CellChangeTimes->{{3.681924625327195*^9, 3.6819246284621964`*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Dynamics of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", 
    RowBox[{"h", ",", "1"}]], TraditionalForm]]],
 ", the reproductive value of a focal hawk in a patch with a dove"
}], "Subsection",
 CellChangeTimes->{{3.681925845874449*^9, 3.681925917621695*^9}}],

Cell["\<\
Mortality of focal hawk and replaced by focal\[CloseCurlyQuote]s offspring of \
type dove (producing a hawk would result in no change in RV)\
\>", "Text",
 CellChangeTimes->{{3.6819259258548727`*^9, 3.681925945317912*^9}, {
  3.681927660932111*^9, 3.681927698193883*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt1", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ph", "[", 
       RowBox[{"h", ",", "d"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], "-", 
      RowBox[{"vh", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68192594726071*^9, 3.681925971758462*^9}, {
   3.6819260190855913`*^9, 3.681926130947208*^9}, {3.681926435242239*^9, 
   3.681926436818954*^9}, 3.681926482730927*^9, 3.682009057140668*^9, {
   3.684051384509453*^9, 3.684051388779916*^9}}],

Cell["Mortality of focal hawk and replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.68192633677034*^9, 3.681926359617897*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt2", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}], "+", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"vh", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681926361613797*^9, 3.6819263784774847`*^9}, {
   3.681926413492546*^9, 3.681926481130086*^9}, 3.682009059069139*^9}],

Cell["\<\
Mortality of the nonfocal dove and replaced by focal\[CloseCurlyQuote]s \
offspring of type dove\
\>", "Text",
 CellChangeTimes->{{3.681926317859852*^9, 3.681926334348077*^9}, 
   3.681926544690075*^9, {3.681926579360045*^9, 3.681926583510888*^9}, {
   3.681926636969471*^9, 3.6819266700431433`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt3", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ph", "[", 
       RowBox[{"h", ",", "d"}], "]"}]}], ")"}], 
    RowBox[{"vd", "[", "1", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681926485767674*^9, 3.6819264890139637`*^9}, {
   3.68192652486548*^9, 3.68192659653953*^9}, {3.681926628842537*^9, 
   3.681926682312171*^9}, {3.681926718791271*^9, 3.681926718817273*^9}, 
   3.682009060228359*^9, {3.682097592047633*^9, 3.68209759532474*^9}, 
   3.6840513971330748`*^9}],

Cell["\<\
Mortality of the nonfocal dove and replaced by focal\[CloseCurlyQuote]s \
offspring of type hawk\
\>", "Text",
 CellChangeTimes->{{3.681926317859852*^9, 3.681926334348077*^9}, 
   3.681926544690075*^9, {3.681926579360045*^9, 3.681926583510888*^9}, {
   3.681926697907278*^9, 3.681926699041252*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt4", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"ph", "[", 
     RowBox[{"h", ",", "d"}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"vh", "[", "2", "]"}]}], "-", 
      RowBox[{"vh", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681926485767674*^9, 3.6819264890139637`*^9}, {
   3.68192652486548*^9, 3.68192659653953*^9}, {3.681926628842537*^9, 
   3.6819266565170918`*^9}, 3.6820090618934*^9, 3.684051414453136*^9}],

Cell["\<\
Mortality of the nonfocal dove and replaced by nonfocal offspring of type hawk\
\>", "Text",
 CellChangeTimes->{{3.681926606554904*^9, 3.681926619259595*^9}, {
  3.681926733120963*^9, 3.681926735911662*^9}, {3.681927427092368*^9, 
  3.681927430092204*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt5", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"ph", "[", 
        RowBox[{"d", ",", "h"}], "]"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], "d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", 
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "d", ",", "h"}], 
                "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                "]"}]}], "]"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], "-", 
      RowBox[{"vh", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681926485767674*^9, 3.6819264890139637`*^9}, {
   3.68192652486548*^9, 3.68192659653953*^9}, {3.681926628842537*^9, 
   3.6819266565170918`*^9}, {3.6819267201356573`*^9, 3.681926784796221*^9}, {
   3.68192683930256*^9, 3.6819268756409187`*^9}, {3.681927243839273*^9, 
   3.6819273106996517`*^9}, {3.68200774527532*^9, 3.682007748906412*^9}, 
   3.682009063583851*^9, {3.684051420303596*^9, 3.684051456742074*^9}}],

Cell["\<\
Mortality of a remote hawk, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.6820091009966784`*^9, 3.6820091353626547`*^9}, {
  3.6820094084444447`*^9, 3.68200940878259*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt6", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], "k", " ", 
      RowBox[{"mh", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"h", ",", "d"}], "]"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "-", "1", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "d"}], "]"}]}], ")"}], 
         RowBox[{"vd", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820091378039627`*^9, 3.682009165972104*^9}, {
  3.682009196189785*^9, 3.6820092024320917`*^9}, {3.682009253476973*^9, 
  3.6820094372537603`*^9}, {3.68405149686185*^9, 3.684051505754917*^9}}],

Cell["\<\
Mortality of a remote dove, replaced by focal\[CloseCurlyQuote]s offspring \
\>", "Text",
 CellChangeTimes->{{3.682009384878317*^9, 3.682009395964232*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt7", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{"2", "-", "k"}], ")"}], " ", 
      RowBox[{"md", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"h", ",", "d"}], "]"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "d"}], "]"}]}], ")"}], 
         RowBox[{"vd", "[", "k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820093785847588`*^9, 3.682009382762863*^9}, {
  3.682009453671788*^9, 3.682009482504977*^9}, {3.684051510323995*^9, 
  3.68405151433932*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt", "=", 
   RowBox[{
   "dvh1dt1", "+", "dvh1dt2", "+", "dvh1dt3", "+", "dvh1dt4", "+", "dvh1dt5", 
    "+", "dvh1dt6", "+", "dvh1dt7"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819273292045794`*^9, 3.68192735687001*^9}, {
  3.682009488406528*^9, 3.682009495179122*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"md", "[", "1", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"md", "[", "0", "]"}], "\[Rule]", "m"}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.682097350179871*^9, 3.6820974696683493`*^9}, {
   3.682097517004548*^9, 3.682097520418336*^9}, 3.682097569106885*^9}],

Cell[BoxData[
 RowBox[{"d", " ", "m", " ", "v", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"f", "[", "0", "]"}], "+", 
    RowBox[{"f", "[", "1", "]"}], "+", 
    RowBox[{"f", "[", "2", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.684054678827107*^9, 3.684054824329323*^9, 
  3.684054905161017*^9, 3.684055007964148*^9, 3.684055121140687*^9, 
  3.684055193953126*^9, 3.684055262850893*^9, 3.6840553748299913`*^9, 
  3.684055432037038*^9, 3.684055593363665*^9, 3.684057226053115*^9, 
  3.684059043333147*^9, 3.6840609667475357`*^9, 3.684061743299694*^9, 
  3.69026738023944*^9, 3.690277779224806*^9, 3.6902926631451263`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dvh1dt", "/.", 
  RowBox[{"err", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.6840544188602448`*^9, 3.68405442538225*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"phh", "[", "1", "]"}]}], ")"}], " ", 
   RowBox[{"vd", "[", "1", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"phh", "[", "1", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"vd", "[", "0", "]"}], "-", 
     RowBox[{"vh", "[", "1", "]"}]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "d"}], "2"], "+", "d"}], ")"}], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"vh", "[", "1", "]"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"f", "[", "0", "]"}], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], " ", 
      RowBox[{"vh", "[", "1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "d", " ", 
   RowBox[{"f", "[", "1", "]"}], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], " ", 
      RowBox[{"vh", "[", "1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], " ", 
      RowBox[{"pdh", "[", "1", "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "0", "]"}], " ", 
         RowBox[{"pdh", "[", "0", "]"}]}], "+", 
        RowBox[{
         RowBox[{"f", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pdh", "[", "1", "]"}], "+", 
           RowBox[{"phh", "[", "1", "]"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "2", "]"}], " ", 
         RowBox[{"phh", "[", "2", "]"}]}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"vh", "[", "1", "]"}]}], "+", 
     RowBox[{"vh", "[", "2", "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"phh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"vh", "[", "1", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "d", " ", 
   RowBox[{"f", "[", "1", "]"}], " ", 
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"f", "[", "2", "]"}], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.684054420986073*^9, 3.68405442577022*^9}, 
   3.684054678854322*^9, 3.68405482433598*^9, 3.684054905213125*^9, 
   3.684055008016711*^9, 3.684055121147274*^9, 3.684055193994128*^9, 
   3.684055262857312*^9, 3.684055374876996*^9, 3.684055432043661*^9, 
   3.6840555933702602`*^9, 3.684057226084339*^9, 3.684059043356599*^9, 
   3.684060966777378*^9, 3.6840617433203087`*^9, 3.6902673802728786`*^9, 
   3.690277779275333*^9, 3.6902926631821823`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Dynamics of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", 
    RowBox[{"d", ",", "1"}]], TraditionalForm]]],
 ", the reproductive value of a focal dove in a patch with a hawk"
}], "Subsection",
 CellChangeTimes->{{3.681925845874449*^9, 3.681925917621695*^9}, {
  3.6819276385562973`*^9, 3.681927643012681*^9}}],

Cell["\<\
Mortality of focal dove and replaced by focal\[CloseCurlyQuote]s offspring of \
type hawk\
\>", "Text",
 CellChangeTimes->{{3.681927646083029*^9, 3.68192766542691*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt1", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"ph", "[", 
     RowBox[{"d", ",", "h"}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], "-", 
      RowBox[{"vd", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819277026703978`*^9, 3.681927753911727*^9}, 
   3.68200906607246*^9, {3.684051580361616*^9, 3.684051587431323*^9}}],

Cell["Mortality of focal dove and replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.6819277589352093`*^9, 3.6819277678851347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt2", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}], "+", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"vd", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681927755599751*^9, 3.681927786037052*^9}, 
   3.682009067510016*^9}],

Cell["\<\
Mortality of nonfocal hawk and replaced by focal\[CloseCurlyQuote]s offspring \
of type hawk\
\>", "Text",
 CellChangeTimes->{{3.681927788198155*^9, 3.681927802268944*^9}, {
  3.6820047639760857`*^9, 3.682004764423377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt3", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"ph", "[", 
     RowBox[{"d", ",", "h"}], "]"}], 
    RowBox[{"vh", "[", "1", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819278039339848`*^9, 3.681927820192936*^9}, {
   3.681928010710494*^9, 3.681928022314131*^9}, 3.682009069053135*^9, 
   3.684051600343844*^9}],

Cell["\<\
Mortality of nonfocal hawk and replaced by focal\[CloseCurlyQuote]s offspring \
of type dove\
\>", "Text",
 CellChangeTimes->{{3.6819280252425003`*^9, 3.681928037744994*^9}, {
  3.681928107885906*^9, 3.68192810830996*^9}, {3.6820047654005413`*^9, 
  3.68200476557555*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt4", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ph", "[", 
       RowBox[{"d", ",", "h"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"vd", "[", "0", "]"}]}], "-", 
      RowBox[{"vd", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819280389798*^9, 3.681928097445298*^9}, 
   3.682009071318041*^9, {3.684052701313354*^9, 3.684052703662073*^9}}],

Cell["\<\
Mortality of the nonfocal hawk and replacement by nonfocal offspring of type \
dove\
\>", "Text",
 CellChangeTimes->{{3.6819281009568357`*^9, 3.681928127780846*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt5", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"ph", "[", 
          RowBox[{"h", ",", "d"}], "]"}]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ph", "[", 
                RowBox[{"h", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[Equal]", "1"}], ",", "d", ",", "h"}], 
                  "]"}]}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ph", "[", 
                RowBox[{"d", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                  "]"}]}], "]"}]}], ")"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], "-", 
      RowBox[{"vd", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681928129058757*^9, 3.681928229584217*^9}, {
  3.682009923518659*^9, 3.682009924206077*^9}, {3.684052713305813*^9, 
  3.684052739104916*^9}}],

Cell["\<\
Mortality of a remote hawk, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.6820096937515078`*^9, 3.68200970705304*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt6", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], "k", " ", 
      RowBox[{"mh", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"d", ",", "h"}], "]"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "-", "1", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ph", "[", 
            RowBox[{"d", ",", "h"}], "]"}]}], ")"}], 
         RowBox[{"vd", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682009716340624*^9, 3.682009741633101*^9}, {
  3.6840528841486473`*^9, 3.6840528873713093`*^9}}],

Cell["\<\
Mortality of a remote dove, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.682009751237131*^9, 3.682009760131051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt7", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{"2", "-", "k"}], ")"}], " ", 
      RowBox[{"md", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"d", ",", "h"}], "]"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ph", "[", 
            RowBox[{"d", ",", "h"}], "]"}]}], ")"}], 
         RowBox[{"vd", "[", "k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820093785847588`*^9, 3.682009382762863*^9}, {
  3.682009453671788*^9, 3.682009482504977*^9}, {3.682009770942122*^9, 
  3.682009781881384*^9}, {3.684052895604027*^9, 3.684052899291123*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt", "=", 
   RowBox[{
   "dvd1dt1", "+", "dvd1dt2", "+", "dvd1dt3", "+", "dvd1dt4", "+", "dvd1dt5", 
    "+", "dvd1dt6", "+", "dvd1dt7"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681928234441332*^9, 3.681928255802907*^9}, {
  3.682009785510764*^9, 3.682009790254716*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"md", "[", "1", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"md", "[", "0", "]"}], "\[Rule]", "m"}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.682097350179871*^9, 3.6820974696683493`*^9}, {
   3.682097517004548*^9, 3.682097520418336*^9}, 3.682097569106885*^9, {
   3.684053624419018*^9, 3.684053624604224*^9}}],

Cell[BoxData[
 RowBox[{"d", " ", "m", " ", "v", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"f", "[", "0", "]"}], "+", 
    RowBox[{"f", "[", "1", "]"}], "+", 
    RowBox[{"f", "[", "2", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.682097394191738*^9, {3.682097433845416*^9, 3.6820974700497913`*^9}, 
   3.682097521768173*^9, 3.682097569636636*^9, 3.682097601255558*^9, 
   3.6820976387372847`*^9, 3.682147218065579*^9, 3.682147288994258*^9, 
   3.682147419631425*^9, 3.682158045404702*^9, 3.68215808243069*^9, 
   3.682159084138859*^9, 3.682159128870865*^9, 3.682159180190117*^9, 
   3.682159403816338*^9, 3.6821607726694727`*^9, {3.6821609092370462`*^9, 
   3.68216093688869*^9}, 3.68216156874249*^9, 3.682327512165533*^9, 
   3.682328817726317*^9, 3.682362214177524*^9, 3.682399329072505*^9, 
   3.6824020165568*^9, 3.682411358533057*^9, 3.682584004969041*^9, 
   3.682593317519157*^9, 3.68261037022357*^9, 3.6826106790237007`*^9, 
   3.682610709661532*^9, 3.682680756290577*^9, 3.682685994244418*^9, 
   3.682752702572382*^9, 3.6827567092338047`*^9, 3.682756761428021*^9, 
   3.6827572408686647`*^9, 3.68276032969995*^9, 3.682930088482012*^9, 
   3.682945411884973*^9, 3.682957951861155*^9, 3.682958003862389*^9, 
   3.6829595169027777`*^9, 3.682961156630199*^9, 3.683007554178211*^9, 
   3.683007586843975*^9, 3.683007627769696*^9, 3.684042724756995*^9, 
   3.684051538214769*^9, 3.6840531290276623`*^9, 3.684053625139312*^9, 
   3.684054022891851*^9, 3.6840546789157667`*^9, 3.684054824421649*^9, 
   3.684054905305853*^9, 3.6840550081503773`*^9, 3.684055121314452*^9, 
   3.6840551940719233`*^9, 3.684055262934355*^9, 3.684055375050241*^9, 
   3.6840554321241198`*^9, 3.684055593454432*^9, 3.68405722613518*^9, 
   3.684059043413371*^9, 3.684060966826501*^9, 3.684061743361086*^9, 
   3.690267380338931*^9, 3.690277779337598*^9, 3.6902926632679453`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dvd1dt", "/.", 
  RowBox[{"err", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.684054661101465*^9, 3.684054673041004*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "1", "]"}]}], ")"}]}], "+", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "0", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"pdh", "[", "0", "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"f", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "-", 
           RowBox[{"pdh", "[", "1", "]"}], "-", 
           RowBox[{"phh", "[", "1", "]"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"phh", "[", "2", "]"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"vd", "[", "0", "]"}], "-", 
     RowBox[{"vd", "[", "1", "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"pdh", "[", "1", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "-", 
     RowBox[{"vd", "[", "1", "]"}]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "d"}], "2"], "+", "d"}], ")"}], " ", 
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"vd", "[", "1", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"pdh", "[", "1", "]"}], " ", 
   RowBox[{"vh", "[", "1", "]"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"f", "[", "0", "]"}], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"pdh", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], " ", 
      RowBox[{"vh", "[", "1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "d", " ", 
   RowBox[{"f", "[", "1", "]"}], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"pdh", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], " ", 
      RowBox[{"vh", "[", "1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"pdh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{"vh", "[", "2", "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "d", " ", 
   RowBox[{"f", "[", "1", "]"}], " ", 
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"pdh", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"f", "[", "2", "]"}], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"pdh", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.684054665899289*^9, 3.684054678920968*^9}, 
   3.6840548244281073`*^9, 3.684054905360785*^9, 3.684055008208132*^9, 
   3.6840551213545027`*^9, 3.684055194078199*^9, 3.6840552629405622`*^9, 
   3.684055375060198*^9, 3.6840554321303988`*^9, 3.684055593460711*^9, 
   3.684057226159148*^9, 3.684059043435792*^9, 3.6840609668509073`*^9, 
   3.6840617433787947`*^9, 3.690267380343773*^9, 3.690277779375139*^9, 
   3.690292663274581*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Dynamics of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", 
    RowBox[{"d", ",", "0"}]], TraditionalForm]]],
 ", the reproductive value of a focal dove in a patch with another dove"
}], "Subsection",
 CellChangeTimes->{{3.681928472202375*^9, 3.6819284868668833`*^9}}],

Cell["\<\
Mortality of focal dove, replaced by focal\[CloseCurlyQuote]s offspring of \
type hawk\
\>", "Text",
 CellChangeTimes->{{3.6819285036646957`*^9, 3.681928516554496*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt1", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"ph", "[", 
     RowBox[{"d", ",", "d"}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "-", 
      RowBox[{"vd", "[", "0", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681928488000746*^9, 3.681928535190276*^9}, {
  3.682008123544552*^9, 3.682008123743497*^9}, {3.6820099290143433`*^9, 
  3.682009929445161*^9}, {3.6820940048913813`*^9, 3.6820940051399307`*^9}, {
  3.684052921906323*^9, 3.684052923208544*^9}}],

Cell["Mortality of focal dove, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.681928537408855*^9, 3.68192854448831*^9}, {
  3.6819286771859627`*^9, 3.681928681520582*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt2", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}], "+", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"vd", "[", "0", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68192854640654*^9, 3.6819285603331327`*^9}, {
   3.68192866864113*^9, 3.6819286875374327`*^9}, 3.682006840764783*^9, {
   3.682009934024764*^9, 3.682009934468092*^9}}],

Cell["\<\
Mortality of nonfocal dove, replaced by focal\[CloseCurlyQuote]s offspring of \
type dove;\
\>", "Text",
 CellChangeTimes->{{3.68192869093843*^9, 3.681928711842268*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt3", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ph", "[", 
       RowBox[{"d", ",", "d"}], "]"}]}], ")"}], 
    RowBox[{"vd", "[", "0", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681928713865307*^9, 3.681928725483062*^9}, {
   3.6820047252771378`*^9, 3.682004746184661*^9}, 3.682005489217371*^9, {
   3.682008081799137*^9, 3.6820080916422997`*^9}, {3.6820081270402927`*^9, 
   3.682008127216434*^9}, {3.6820099356762047`*^9, 3.68200993705604*^9}, 
   3.684052928689547*^9}],

Cell["\<\
Mortality of nonfocal dove, replaced by focal\[CloseCurlyQuote]s offspring of \
type hawk;\
\>", "Text",
 CellChangeTimes->{{3.681928570567319*^9, 3.681928579606635*^9}, {
  3.6820047541665077`*^9, 3.6820047854705877`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt4", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"ph", "[", 
     RowBox[{"d", ",", "d"}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "+", 
      RowBox[{"vd", "[", "1", "]"}], "-", 
      RowBox[{"vd", "[", "0", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682004786630179*^9, 3.6820047933450336`*^9}, {
   3.68200487190224*^9, 3.68200488725364*^9}, 3.682005488213191*^9, {
   3.682008096919821*^9, 3.682008098044466*^9}, {3.6820081280839376`*^9, 
   3.682008128264373*^9}, {3.6820099390011463`*^9, 3.6820099394410963`*^9}, 
   3.6840529323860826`*^9}],

Cell["\<\
Mortality of nonfocal dove, replaced by nonfocal offspring of type hawk;\
\>", "Text",
 CellChangeTimes->{{3.682004953995056*^9, 3.682004965059964*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt5", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"ph", "[", 
        RowBox[{"d", ",", "d"}], "]"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", 
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "d", ",", "h"}], 
                "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                "]"}]}], "]"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], "-", 
      RowBox[{"vd", "[", "0", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68200496609521*^9, 3.682005090648181*^9}, 
   3.682005487388914*^9, {3.6820099436493692`*^9, 3.682009944105322*^9}, {
   3.684052935284096*^9, 3.684052964131206*^9}}],

Cell["\<\
Mortality of a remote hawk, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.6820096937515078`*^9, 3.68200970705304*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt6", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], "k", " ", 
      RowBox[{"mh", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"d", ",", "d"}], "]"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "-", "1", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ph", "[", 
            RowBox[{"d", ",", "d"}], "]"}]}], ")"}], 
         RowBox[{"vd", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682009716340624*^9, 3.682009741633101*^9}, {
  3.6820098070745173`*^9, 3.682009827951312*^9}, {3.684052972202599*^9, 
  3.6840529816896772`*^9}}],

Cell["\<\
Mortality of a remote dove, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.682009751237131*^9, 3.682009760131051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt7", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{"2", "-", "k"}], ")"}], " ", 
      RowBox[{"md", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"d", ",", "d"}], "]"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ph", "[", 
            RowBox[{"d", ",", "d"}], "]"}]}], ")"}], 
         RowBox[{"vd", "[", "k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820093785847588`*^9, 3.682009382762863*^9}, {
  3.682009453671788*^9, 3.682009482504977*^9}, {3.682009770942122*^9, 
  3.682009831013*^9}, {3.684052984834188*^9, 3.6840529880733147`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt", "=", 
   RowBox[{
   "dvd0dt1", "+", "dvd0dt2", "+", "dvd0dt3", "+", "dvd0dt4", "+", "dvd0dt5", 
    "+", "dvd0dt6", "+", "dvd0dt7"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820051000674963`*^9, 3.682005113434269*^9}, {
  3.682009833362094*^9, 3.682009839901073*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"md", "[", "1", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"md", "[", "0", "]"}], "\[Rule]", "m"}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.682097350179871*^9, 3.6820974696683493`*^9}, {
   3.682097517004548*^9, 3.682097520418336*^9}, 3.682097569106885*^9, {
   3.684053630628634*^9, 3.684053631379121*^9}}],

Cell[BoxData[
 RowBox[{"d", " ", "m", " ", "v", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"f", "[", "0", "]"}], "+", 
    RowBox[{"f", "[", "1", "]"}], "+", 
    RowBox[{"f", "[", "2", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.682097394191738*^9, {3.682097433845416*^9, 3.6820974700497913`*^9}, 
   3.682097521768173*^9, 3.682097569636636*^9, 3.682097601255558*^9, 
   3.6820976387372847`*^9, 3.682147218065579*^9, 3.682147288994258*^9, 
   3.682147419631425*^9, 3.682158045404702*^9, 3.68215808243069*^9, 
   3.682159084138859*^9, 3.682159128870865*^9, 3.682159180190117*^9, 
   3.682159403816338*^9, 3.6821607726694727`*^9, {3.6821609092370462`*^9, 
   3.68216093688869*^9}, 3.68216156874249*^9, 3.682327512165533*^9, 
   3.682328817726317*^9, 3.682362214177524*^9, 3.682399329072505*^9, 
   3.6824020165568*^9, 3.682411358533057*^9, 3.682584004969041*^9, 
   3.682593317519157*^9, 3.68261037022357*^9, 3.6826106790237007`*^9, 
   3.682610709661532*^9, 3.682680756290577*^9, 3.682685994244418*^9, 
   3.682752702572382*^9, 3.6827567092338047`*^9, 3.682756761428021*^9, 
   3.6827572408686647`*^9, 3.68276032969995*^9, 3.682930088482012*^9, 
   3.682945411884973*^9, 3.682957951861155*^9, 3.682958003862389*^9, 
   3.6829595169027777`*^9, 3.682961156630199*^9, 3.683007554178211*^9, 
   3.683007586843975*^9, 3.683007627769696*^9, 3.684042724756995*^9, 
   3.684051538214769*^9, 3.6840531290276623`*^9, 3.68405363183786*^9, 
   3.68405402297302*^9, 3.684054824537334*^9, 3.68405490546647*^9, 
   3.684055008403442*^9, 3.6840551214313593`*^9, 3.6840551941558657`*^9, 
   3.684055263013139*^9, 3.6840553751805677`*^9, 3.684055432213622*^9, 
   3.684055593542807*^9, 3.684057226208626*^9, 3.684059043486157*^9, 
   3.684060966901989*^9, 3.684061743416383*^9, 3.690267380408915*^9, 
   3.690277779436718*^9, 3.6902926633737183`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dvd0dt", "/.", 
  RowBox[{"err", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.684054808919869*^9, 3.684054813679307*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"1", "-", "d"}], "2"], "+", "d"}], ")"}]}], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"vd", "[", "0", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"pdh", "[", "0", "]"}]}], ")"}], " ", 
   RowBox[{"vd", "[", "0", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], " ", 
      RowBox[{"pdh", "[", "0", "]"}]}], "+", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "0", "]"}], " ", 
         RowBox[{"pdh", "[", "0", "]"}]}], "+", 
        RowBox[{
         RowBox[{"f", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pdh", "[", "1", "]"}], "+", 
           RowBox[{"phh", "[", "1", "]"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "2", "]"}], " ", 
         RowBox[{"phh", "[", "2", "]"}]}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{"vd", "[", "1", "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"pdh", "[", "0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{"vh", "[", "1", "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"pdh", "[", "0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{"vd", "[", "1", "]"}], "+", 
     RowBox[{"vh", "[", "1", "]"}]}], ")"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"f", "[", "0", "]"}], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"pdh", "[", "0", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], " ", 
      RowBox[{"vh", "[", "1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "d", " ", 
   RowBox[{"f", "[", "1", "]"}], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"pdh", "[", "0", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], " ", 
      RowBox[{"vh", "[", "1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "d", " ", 
   RowBox[{"f", "[", "1", "]"}], " ", 
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"pdh", "[", "0", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"f", "[", "2", "]"}], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"pdh", "[", "0", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.684054824544074*^9, 3.684054905472835*^9, 
  3.684055008409711*^9, 3.6840551214374733`*^9, 3.684055194196385*^9, 
  3.684055263049754*^9, 3.684055375187129*^9, 3.684055432219675*^9, 
  3.6840555935487747`*^9, 3.684057226236171*^9, 3.684059043490416*^9, 
  3.684060966905901*^9, 3.6840617434342213`*^9, 3.690267380445854*^9, 
  3.69027777944033*^9, 3.6902926634102163`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Dynamics of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", 
    RowBox[{"h", ",", "2"}]], TraditionalForm]]],
 ", the reproductive value of a focal hawk in a patch with another hawk"
}], "Subsection",
 CellChangeTimes->{{3.6820051204203377`*^9, 3.6820051414023237`*^9}}],

Cell["\<\
Mortality of focal hawk, replaced by focal\[CloseCurlyQuote]s offspring of \
type dove\
\>", "Text",
 CellChangeTimes->{{3.68200543372608*^9, 3.682005443846343*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt1", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ph", "[", 
       RowBox[{"h", ",", "h"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], "-", 
      RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68200544554594*^9, 3.68200548235351*^9}, {
  3.6820075364919767`*^9, 3.682007536707572*^9}, {3.682009947460268*^9, 
  3.6820099478831043`*^9}, {3.68209399338303*^9, 3.682093994300618*^9}, {
  3.684053005352357*^9, 3.6840530066790457`*^9}}],

Cell["Mortality of focal hawk, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.6820054917001877`*^9, 3.6820055010911818`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt2", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}], "+", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005511622324*^9, 3.682005520743215*^9}, {
  3.6820055709159184`*^9, 3.682005592142858*^9}, {3.682009949305634*^9, 
  3.682009950569125*^9}}],

Cell["\<\
Mortality of nonfocal hawk, replaced by focal\[CloseCurlyQuote]s offspring of \
type hawk;\
\>", "Text",
 CellChangeTimes->{{3.682005595151394*^9, 3.682005607998982*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt3", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"ph", "[", 
     RowBox[{"h", ",", "h"}], "]"}], 
    RowBox[{"vh", "[", "2", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005625606286*^9, 3.682005653450034*^9}, {
   3.682009951425269*^9, 3.6820099518704348`*^9}, 3.6840530115832233`*^9}],

Cell["\<\
Mortality of nonfocal hawk, replaced by focal\[CloseCurlyQuote]s offspring of \
type dove;\
\>", "Text",
 CellChangeTimes->{{3.682005655188333*^9, 3.682005667452868*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt4", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ph", "[", 
       RowBox[{"h", ",", "h"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "+", 
      RowBox[{"vd", "[", "1", "]"}], "-", 
      RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005673808475*^9, 3.68200571825278*^9}, {
   3.682009953470873*^9, 3.6820099539351482`*^9}, 3.684053014344287*^9}],

Cell["\<\
Mortality of nonfocal hawk, replaced by nonfocal offspring of type dove;\
\>", "Text",
 CellChangeTimes->{{3.68200572017826*^9, 3.682005731785377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt5", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"ph", "[", 
          RowBox[{"h", ",", "h"}], "]"}]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ph", "[", 
                RowBox[{"h", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[Equal]", "1"}], ",", "d", ",", "h"}], 
                  "]"}]}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ph", "[", 
                RowBox[{"d", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                  "]"}]}], "]"}]}], ")"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "-", 
      RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005733843959*^9, 3.682005795637632*^9}, {
  3.682009955258163*^9, 3.68200995571586*^9}, {3.684053017194581*^9, 
  3.684053047181785*^9}}],

Cell["\<\
Mortality of a remote hawk, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.6820096937515078`*^9, 3.68200970705304*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt6", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], "k", " ", 
      RowBox[{"mh", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"h", ",", "h"}], "]"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "-", "1", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "h"}], "]"}]}], ")"}], 
         RowBox[{"vd", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682009716340624*^9, 3.682009741633101*^9}, {
  3.6820098070745173`*^9, 3.682009827951312*^9}, {3.6820098626023417`*^9, 
  3.682009883796426*^9}, {3.6840530507287283`*^9, 3.6840530571515093`*^9}}],

Cell["\<\
Mortality of a remote dove, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.682009751237131*^9, 3.682009760131051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt7", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{"2", "-", "k"}], ")"}], " ", 
      RowBox[{"md", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"h", ",", "h"}], "]"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "h"}], "]"}]}], ")"}], 
         RowBox[{"vd", "[", "k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820093785847588`*^9, 3.682009382762863*^9}, {
  3.682009453671788*^9, 3.682009482504977*^9}, {3.682009770942122*^9, 
  3.682009831013*^9}, {3.6820098698972397`*^9, 3.682009885856658*^9}, {
  3.6840530614807253`*^9, 3.684053064679775*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt", "=", 
   RowBox[{
   "dvh2dt1", "+", "dvh2dt2", "+", "dvh2dt3", "+", "dvh2dt4", "+", "dvh2dt5", 
    "+", "dvh2dt6", "+", "dvh2dt7"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005798415985*^9, 3.682005812226226*^9}, {
  3.682009878826271*^9, 3.682009893253294*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"md", "[", "1", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "m"}], ",", 
     RowBox[{
      RowBox[{"md", "[", "0", "]"}], "\[Rule]", "m"}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.682097350179871*^9, 3.6820974696683493`*^9}, {
   3.682097517004548*^9, 3.682097520418336*^9}, 3.682097569106885*^9, {
   3.684053656387624*^9, 3.684053657314364*^9}}],

Cell[BoxData[
 RowBox[{"d", " ", "m", " ", "v", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"f", "[", "0", "]"}], "+", 
    RowBox[{"f", "[", "1", "]"}], "+", 
    RowBox[{"f", "[", "2", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.682097394191738*^9, {3.682097433845416*^9, 3.6820974700497913`*^9}, 
   3.682097521768173*^9, 3.682097569636636*^9, 3.682097601255558*^9, 
   3.6820976387372847`*^9, 3.682147218065579*^9, 3.682147288994258*^9, 
   3.682147419631425*^9, 3.682158045404702*^9, 3.68215808243069*^9, 
   3.682159084138859*^9, 3.682159128870865*^9, 3.682159180190117*^9, 
   3.682159403816338*^9, 3.6821607726694727`*^9, {3.6821609092370462`*^9, 
   3.68216093688869*^9}, 3.68216156874249*^9, 3.682327512165533*^9, 
   3.682328817726317*^9, 3.682362214177524*^9, 3.682399329072505*^9, 
   3.6824020165568*^9, 3.682411358533057*^9, 3.682584004969041*^9, 
   3.682593317519157*^9, 3.68261037022357*^9, 3.6826106790237007`*^9, 
   3.682610709661532*^9, 3.682680756290577*^9, 3.682685994244418*^9, 
   3.682752702572382*^9, 3.6827567092338047`*^9, 3.682756761428021*^9, 
   3.6827572408686647`*^9, 3.68276032969995*^9, 3.682930088482012*^9, 
   3.682945411884973*^9, 3.682957951861155*^9, 3.682958003862389*^9, 
   3.6829595169027777`*^9, 3.682961156630199*^9, 3.683007554178211*^9, 
   3.683007586843975*^9, 3.683007627769696*^9, 3.684042724756995*^9, 
   3.684051538214769*^9, 3.6840531290276623`*^9, 3.684053657912099*^9, 
   3.684054023053887*^9, 3.684054905565474*^9, 3.684055008774221*^9, 
   3.684055121511073*^9, 3.68405519427037*^9, 3.684055263127097*^9, 
   3.684055375266695*^9, 3.684055432300997*^9, 3.6840555936363773`*^9, 
   3.684057226287693*^9, 3.684059043547467*^9, 3.6840609669522877`*^9, 
   3.684061743569497*^9, 3.6902673805098658`*^9, 3.6902777795011168`*^9, 
   3.6902926634952602`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dvh2dt", "/.", 
  RowBox[{"err", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.684054887064372*^9, 3.684054893099985*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", " ", 
   RowBox[{"f", "[", "0", "]"}], " ", 
   RowBox[{"md", "[", "0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], " ", 
      RowBox[{"vh", "[", "1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "d", " ", 
   RowBox[{"f", "[", "1", "]"}], " ", 
   RowBox[{"mh", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], " ", 
      RowBox[{"vh", "[", "1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"phh", "[", "2", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"vd", "[", "1", "]"}], "-", 
     RowBox[{"vh", "[", "2", "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "0", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"pdh", "[", "0", "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"f", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "-", 
           RowBox[{"pdh", "[", "1", "]"}], "-", 
           RowBox[{"phh", "[", "1", "]"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"phh", "[", "2", "]"}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"vh", "[", "1", "]"}], "-", 
     RowBox[{"vh", "[", "2", "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"phh", "[", "2", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"vd", "[", "1", "]"}], "+", 
     RowBox[{"vh", "[", "1", "]"}], "-", 
     RowBox[{"vh", "[", "2", "]"}]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "d"}], "2"], "+", "d"}], ")"}], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"vh", "[", "2", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"phh", "[", "2", "]"}], " ", 
   RowBox[{"vh", "[", "2", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "d", " ", 
   RowBox[{"f", "[", "1", "]"}], " ", 
   RowBox[{"md", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"f", "[", "2", "]"}], " ", 
   RowBox[{"mh", "[", "2", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"phh", "[", "2", "]"}]}], ")"}], " ", 
      RowBox[{"vd", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], " ", 
      RowBox[{"vh", "[", "2", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.684054905570537*^9, 3.68405500887488*^9, 
  3.684055121548369*^9, 3.68405519427645*^9, 3.684055263132992*^9, 
  3.684055375272498*^9, 3.6840554323406878`*^9, 3.684055593642733*^9, 
  3.6840572263126173`*^9, 3.684059043569991*^9, 3.6840609669562483`*^9, 
  3.684061743575081*^9, 3.690267380514826*^9, 3.6902777795047007`*^9, 
  3.690292663501527*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Numerical solutions", "Subsection",
 CellChangeTimes->{{3.682005845371214*^9, 3.682005847763522*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sysRV", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dvh1dt", "\[Equal]", "0"}], ",", 
     RowBox[{"dvd1dt", "\[Equal]", "0"}], ",", 
     RowBox[{"dvd0dt", "\[Equal]", "0"}], ",", 
     RowBox[{"dvh2dt", "\[Equal]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rvconstraint", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"f", "[", "1", "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vh", "[", "1", "]"}], "+", 
        RowBox[{"vd", "[", "1", "]"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"f", "[", "0", "]"}], 
      RowBox[{"vd", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"f", "[", "2", "]"}], 
      RowBox[{"vh", "[", "2", "]"}]}]}], "\[Equal]", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sysRVc1", "=", 
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"sysRV", ",", 
      RowBox[{"1", "\[Rule]", "rvconstraint"}]}], "]"}], "//", "Simplify"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sysRVc2", "=", 
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"sysRV", ",", 
      RowBox[{"3", "\[Rule]", "rvconstraint"}]}], "]"}], "//", "Simplify"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rvstart", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vh", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vd", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vd", "[", "0", "]"}], ",", "1.0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vh", "[", "2", "]"}], ",", "1.0"}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682006006497418*^9, 3.682006028294641*^9}, {
  3.682006112204694*^9, 3.682006211136118*^9}, {3.682006456059708*^9, 
  3.682006483164312*^9}, {3.682006514855074*^9, 3.6820065328236427`*^9}, {
  3.682008574510376*^9, 3.682008578472673*^9}, {3.682008687537403*^9, 
  3.682008687786172*^9}, {3.682094942000249*^9, 3.682094959003921*^9}, {
  3.6820978062927094`*^9, 3.682097807568782*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansRV", "[", 
   RowBox[{
    RowBox[{"{", "ds_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"mh1_", ",", "mh2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"md0_", ",", "md1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"phhs_", ",", "pdhs_"}], "}"}], ",", 
    RowBox[{"{", "\[Epsilon]_", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "freqs", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"freqs", "=", 
      RowBox[{"ans", "[", 
       RowBox[{
        RowBox[{"{", "ds", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mh1", ",", "mh2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"md0", ",", "md1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phhs", ",", "pdhs"}], "}"}], ",", 
        RowBox[{"{", "\[Epsilon]", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"solrv1", "/.", "freqs"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d", "\[Rule]", "ds"}], ",", 
        RowBox[{
         RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "mh1"}], ",", 
        RowBox[{
         RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "mh2"}], ",", 
        RowBox[{
         RowBox[{"md", "[", "0", "]"}], "\[Rule]", "md0"}], ",", 
        RowBox[{
         RowBox[{"md", "[", "1", "]"}], "\[Rule]", "md1"}], ",", 
        RowBox[{
         RowBox[{"md", "[", "2", "]"}], "\[Rule]", "md2"}], ",", 
        RowBox[{
         RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "phhs"}], ",", 
        RowBox[{
         RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "phhs"}], ",", 
        RowBox[{
         RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "pdhs"}], ",", 
        RowBox[{
         RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "pdhs"}], ",", 
        RowBox[{"err", "\[Rule]", "\[Epsilon]"}]}], "}"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.682005993747673*^9, 3.682006002986651*^9}, {
   3.682006213367695*^9, 3.682006283888545*^9}, {3.682006350101067*^9, 
   3.682006350443767*^9}, {3.682006388565139*^9, 3.6820064172865562`*^9}, 
   3.6820066374754143`*^9, {3.6820068963546953`*^9, 3.682006897038889*^9}, {
   3.6820076384534807`*^9, 3.682007642204445*^9}, {3.684053241919829*^9, 
   3.684053268575892*^9}, {3.6840534075730658`*^9, 3.684053408051874*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansRValt", "[", 
   RowBox[{
    RowBox[{"{", "ds_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"mh1_", ",", "mh2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"md0_", ",", "md1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"phhs_", ",", "pdhs_"}], "}"}], ",", 
    RowBox[{"{", "\[Epsilon]_", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "freqs", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"freqs", "=", 
      RowBox[{"ans", "[", 
       RowBox[{
        RowBox[{"{", "ds", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mh1", ",", "mh2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"md0", ",", "md1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phhs", ",", "pdhs"}], "}"}], ",", 
        RowBox[{"{", "\[Epsilon]", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"solrv2", "/.", "freqs"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d", "\[Rule]", "ds"}], ",", 
        RowBox[{
         RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "mh1"}], ",", 
        RowBox[{
         RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "mh2"}], ",", 
        RowBox[{
         RowBox[{"md", "[", "0", "]"}], "\[Rule]", "md0"}], ",", 
        RowBox[{
         RowBox[{"md", "[", "1", "]"}], "\[Rule]", "md1"}], ",", 
        RowBox[{
         RowBox[{"md", "[", "2", "]"}], "\[Rule]", "md2"}], ",", 
        RowBox[{
         RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "phhs"}], ",", 
        RowBox[{
         RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "phhs"}], ",", 
        RowBox[{
         RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "pdhs"}], ",", 
        RowBox[{
         RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "pdhs"}], ",", 
        RowBox[{"err", "\[Rule]", "\[Epsilon]"}]}], "}"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.682005993747673*^9, 3.682006002986651*^9}, {
   3.682006213367695*^9, 3.682006283888545*^9}, {3.682006350101067*^9, 
   3.682006350443767*^9}, {3.682006388565139*^9, 3.6820064282719593`*^9}, 
   3.682006636641142*^9, {3.682006942350235*^9, 3.6820069443661222`*^9}, {
   3.682006976604924*^9, 3.682006978411319*^9}, {3.682007115285718*^9, 
   3.682007134347156*^9}, {3.6820071710511093`*^9, 3.682007239620407*^9}, {
   3.682007504810028*^9, 3.682007509808412*^9}, 3.682007643997302*^9, {
   3.684053273071854*^9, 3.684053280719903*^9}, {3.68405334311769*^9, 
   3.684053361764162*^9}, {3.6840534034930983`*^9, 3.6840534040357656`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansRVtest", "[", 
   RowBox[{
    RowBox[{"{", "ds_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"mh1_", ",", "mh2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"md0_", ",", "md1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"phhs_", ",", "pdhs_"}], "}"}], ",", 
    RowBox[{"{", "\[Epsilon]_", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "freqs", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"freqs", "=", 
      RowBox[{"ans", "[", 
       RowBox[{
        RowBox[{"{", "ds", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mh1", ",", "mh2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"md0", ",", "md1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phhs", ",", "pdhs"}], "}"}], ",", 
        RowBox[{"{", "\[Epsilon]", "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sysRVc1", "/.", "freqs"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"d", "\[Rule]", "ds"}], ",", 
          RowBox[{
           RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "mh1"}], ",", 
          RowBox[{
           RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "mh2"}], ",", 
          RowBox[{
           RowBox[{"md", "[", "0", "]"}], "\[Rule]", "md0"}], ",", 
          RowBox[{
           RowBox[{"md", "[", "1", "]"}], "\[Rule]", "md1"}], ",", 
          RowBox[{
           RowBox[{"md", "[", "2", "]"}], "\[Rule]", "md2"}], ",", 
          RowBox[{
           RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "phhs"}], ",", 
          RowBox[{
           RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "phhs"}], ",", 
          RowBox[{
           RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "pdhs"}], ",", 
          RowBox[{
           RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "pdhs"}], ",", 
          RowBox[{"err", "\[Rule]", "\[Epsilon]"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"vh", "[", "1", "]"}], "\[Rule]", "1.0"}], ",", 
         RowBox[{
          RowBox[{"vd", "[", "1", "]"}], "\[Rule]", "1.0"}], ",", 
         RowBox[{
          RowBox[{"vd", "[", "0", "]"}], "\[Rule]", "1.0"}], ",", 
         RowBox[{
          RowBox[{"vh", "[", "2", "]"}], "\[Rule]", "1.0"}]}], "}"}]}], "]"}],
      ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.682005993747673*^9, 3.682006002986651*^9}, {
   3.682006213367695*^9, 3.682006283888545*^9}, {3.682006350101067*^9, 
   3.682006350443767*^9}, {3.682006388565139*^9, 3.6820064172865562`*^9}, {
   3.682006562310053*^9, 3.682006628311502*^9}, {3.6820066841848097`*^9, 
   3.682006685014596*^9}, {3.682007078337799*^9, 3.68200707944947*^9}, 
   3.682007110202232*^9, {3.684053334424116*^9, 3.6840533388565073`*^9}, {
   3.684053369063999*^9, 3.684053398868802*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ansRVtest", "[", 
  RowBox[{
   RowBox[{"{", "0.1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0", ",", "3.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.0", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", "0.0", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6819244867924747`*^9, 3.6819245518322287`*^9}, {
   3.681924603462893*^9, 3.681924608373921*^9}, {3.6820064993026323`*^9, 
   3.682006501182838*^9}, {3.682006601836994*^9, 3.6820066022622347`*^9}, {
   3.682006641596554*^9, 3.6820066610865498`*^9}, {3.684053382454425*^9, 
   3.68405338539715*^9}, 3.684053436117866*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "False", ",", "False", ",", "False"}], "}"}]], "Output",\

 CellChangeTimes->{{3.682006629715184*^9, 3.682006686256686*^9}, 
   3.682006788580572*^9, 3.682006912610461*^9, 3.6820069812759857`*^9, 
   3.682007081142764*^9, {3.682007120155374*^9, 3.682007137381365*^9}, {
   3.6820072213263407`*^9, 3.682007242052065*^9}, 3.68200734765228*^9, 
   3.682007462127399*^9, 3.682007549551097*^9, 3.682007654292025*^9, 
   3.682008663125298*^9, 3.682008703323143*^9, 3.6820101593099737`*^9, 
   3.682015469297134*^9, 3.682094753946865*^9, 3.682094921024509*^9, 
   3.6820950618890057`*^9, 3.682097779954672*^9, 3.682097864783193*^9, 
   3.6821472193890963`*^9, 3.682147290126*^9, 3.682147420820318*^9, 
   3.682158046548373*^9, 3.682158083625486*^9, 3.682159085210239*^9, 
   3.682159129984549*^9, 3.6821591813591633`*^9, 3.6821594049125633`*^9, 
   3.6821607738567123`*^9, {3.6821609103212223`*^9, 3.682160938127224*^9}, 
   3.6821615703454514`*^9, 3.682327513561829*^9, 3.682328818812336*^9, 
   3.6823622666763573`*^9, 3.682399386118856*^9, 3.682402066903783*^9, 
   3.6824113599402027`*^9, 3.682584006312084*^9, 3.682593369048612*^9, 
   3.682610421689636*^9, 3.682610757091447*^9, 3.6826807575491123`*^9, 
   3.682685995390851*^9, 3.682752703927721*^9, 3.682756710385521*^9, 
   3.6827567626567583`*^9, 3.6827572420103693`*^9, 3.682760330956875*^9, 
   3.68293008983488*^9, 3.682945412986216*^9, 3.6829580564181843`*^9, 
   3.682959576637784*^9, 3.682961209401308*^9, 3.683007555581382*^9, 
   3.683007588282722*^9, 3.6830076290058823`*^9, 3.6840427261174383`*^9, {
   3.6840533775918083`*^9, 3.684053436787055*^9}, 3.684054025678679*^9, 
   3.68405506622408*^9, 3.684055124114149*^9, 3.6840551968476477`*^9, 
   3.684055265714631*^9, 3.684055378094589*^9, 3.684055434925769*^9, 
   3.6840555972086143`*^9, 3.68405566645572*^9, 3.68405722906215*^9, 
   3.684059046433106*^9, 3.684060969708486*^9, 3.684061746350895*^9, 
   3.690267384233502*^9, 3.690277782130014*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"ansRValt", "[", 
   RowBox[{
    RowBox[{"{", "1.0", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1.0", ",", "2.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2.0", ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.2", ",", "0.5"}], "}"}], ",", 
    RowBox[{"{", "0.1", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6819244867924747`*^9, 3.681924613239189*^9}, {
   3.682006502965962*^9, 3.682006503184844*^9}, {3.682007339842572*^9, 
   3.682007341538625*^9}, {3.682010212600904*^9, 3.6820102126547737`*^9}, {
   3.682095545604151*^9, 3.682095559850863*^9}, {3.6820961257511883`*^9, 
   3.682096128024069*^9}, 3.682097785179929*^9, {3.6820978739439573`*^9, 
   3.682097874152995*^9}, {3.682147243644649*^9, 3.68214724483466*^9}, {
   3.682584011849226*^9, 3.682584012630147*^9}, {3.684053416925481*^9, 
   3.684053438358245*^9}, 3.684053688656171*^9, {3.684053803679262*^9, 
   3.684053831509054*^9}, {3.684054034772662*^9, 3.684054035835428*^9}, {
   3.6840553595195312`*^9, 3.6840553625651407`*^9}, {3.684055444541293*^9, 
   3.684055471153578*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"vh", "[", "1", "]"}], "\[Rule]", "1.1407315775977398`"}], ",", 
   RowBox[{
    RowBox[{"vd", "[", "1", "]"}], "\[Rule]", "1.1005102513652358`"}], ",", 
   RowBox[{
    RowBox[{"vd", "[", "0", "]"}], "\[Rule]", "0.7742692013187309`"}], ",", 
   RowBox[{
    RowBox[{"vh", "[", "2", "]"}], "\[Rule]", "0.8261941613278354`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.682007221364996*^9, 3.682007242088386*^9}, 
   3.682007347719256*^9, 3.682007462169137*^9, 3.68200751447617*^9, 
   3.682007549602613*^9, 3.682007654333085*^9, 3.6820086642450666`*^9, 
   3.682008704595725*^9, 3.682010159990218*^9, 3.682010220474802*^9, 
   3.68201546934896*^9, 3.6820947540168743`*^9, 3.6820949210821123`*^9, 
   3.682095061942852*^9, {3.682095547410922*^9, 3.6820955601861753`*^9}, 
   3.682096133055738*^9, {3.682097780770935*^9, 3.682097785715047*^9}, {
   3.682097864868885*^9, 3.6820978745729933`*^9}, {3.6821472194323072`*^9, 
   3.68214724614016*^9}, 3.682147290162792*^9, 3.682147420876945*^9, 
   3.6821580465885878`*^9, 3.682158083669642*^9, 3.6821590852494717`*^9, 
   3.68215913003168*^9, 3.6821591814039497`*^9, 3.68215940494991*^9, 
   3.6821607738949537`*^9, {3.682160910358983*^9, 3.682160938182597*^9}, 
   3.682161570401362*^9, 3.6823275135966063`*^9, 3.682328818842012*^9, 
   3.682362266710607*^9, 3.682399386169623*^9, 3.6824020669502983`*^9, 
   3.682411360001964*^9, {3.682584006456417*^9, 3.682584012943288*^9}, 
   3.68259336908654*^9, 3.68261042172297*^9, 3.682610757156258*^9, 
   3.682680757605901*^9, 3.682685995435246*^9, 3.682752703975341*^9, 
   3.682756710437125*^9, 3.682756762758123*^9, 3.682757242067258*^9, 
   3.682760331014629*^9, 3.6829300898649282`*^9, 3.6829454130170794`*^9, 
   3.682958056460651*^9, 3.682959576692205*^9, 3.682961209439979*^9, 
   3.683007555619376*^9, 3.683007588353498*^9, 3.6830076290661*^9, 
   3.684042726166909*^9, 3.6840533775977583`*^9, {3.684053413792161*^9, 
   3.684053438815708*^9}, 3.684053689215856*^9, {3.684053823988698*^9, 
   3.684053832914747*^9}, {3.684054025733224*^9, 3.684054036577394*^9}, 
   3.6840550662856216`*^9, 3.684055124192114*^9, 3.684055196882992*^9, 
   3.684055265757432*^9, {3.68405536404053*^9, 3.68405537814047*^9}, {
   3.6840554349832077`*^9, 3.684055471679751*^9}, 3.684055597266782*^9, 
   3.684055666548593*^9, 3.6840572291345787`*^9, 3.6840590465028543`*^9, 
   3.684060969760747*^9, 3.684061746403102*^9, 3.6902673842839537`*^9, 
   3.690277782182482*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"ansRV", "[", 
   RowBox[{
    RowBox[{"{", "1.0", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1.0", ",", "2.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2.0", ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.2", ",", "0.5"}], "}"}], ",", 
    RowBox[{"{", "0.1", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6819244867924747`*^9, 3.681924613239189*^9}, {
   3.682006502965962*^9, 3.682006503184844*^9}, {3.682007339842572*^9, 
   3.682007341538625*^9}, {3.682007662410421*^9, 3.6820076626999607`*^9}, {
   3.6820102165856123`*^9, 3.682010217700611*^9}, {3.682095549699923*^9, 
   3.6820955565215893`*^9}, {3.682096129366428*^9, 3.682096130480509*^9}, 
   3.682097787995255*^9, {3.682097872591572*^9, 3.682097872815242*^9}, {
   3.682147248453183*^9, 3.6821472486830673`*^9}, {3.682584008608981*^9, 
   3.6825840093506317`*^9}, {3.6840534206777573`*^9, 3.6840534412619953`*^9}, 
   3.68405369097586*^9, {3.684053804765416*^9, 3.684053830548877*^9}, 
   3.684054032221051*^9, 3.6840553817586803`*^9, {3.684055440620582*^9, 
   3.684055473409932*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"vh", "[", "1", "]"}], "\[Rule]", "1.1407315775977394`"}], ",", 
   RowBox[{
    RowBox[{"vd", "[", "1", "]"}], "\[Rule]", "1.100510251365236`"}], ",", 
   RowBox[{
    RowBox[{"vd", "[", "0", "]"}], "\[Rule]", "0.7742692013187313`"}], ",", 
   RowBox[{
    RowBox[{"vh", "[", "2", "]"}], "\[Rule]", "0.8261941613278353`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.682007221364996*^9, 3.682007242088386*^9}, 
   3.682007347719256*^9, 3.682007462169137*^9, 3.68200751447617*^9, 
   3.682007549602613*^9, {3.682007654333085*^9, 3.682007663251109*^9}, 
   3.682008666037369*^9, 3.682008705738957*^9, 3.68201016150253*^9, 
   3.682010218258814*^9, 3.682015469392117*^9, 3.68209475407593*^9, 
   3.682094921138577*^9, 3.682095062000119*^9, {3.6820955503781013`*^9, 
   3.6820955569779043`*^9}, 3.682096130919537*^9, 3.68209778872359*^9, {
   3.682097864933618*^9, 3.6820978768701963`*^9}, {3.682147219472802*^9, 
   3.682147249099347*^9}, 3.682147290194667*^9, 3.682147420926458*^9, 
   3.682158046624893*^9, 3.682158083709901*^9, 3.682159085285591*^9, 
   3.682159130075419*^9, 3.6821591814466887`*^9, 3.68215940498383*^9, 
   3.6821607739306*^9, {3.682160910396274*^9, 3.682160938216776*^9}, 
   3.6821615704396544`*^9, 3.682327513638838*^9, 3.682328818881503*^9, 
   3.6823622667436533`*^9, 3.68239938622464*^9, 3.682402066996818*^9, 
   3.682411360029169*^9, {3.68258400659305*^9, 3.6825840096979017`*^9}, 
   3.682593369123049*^9, 3.682610421755641*^9, 3.682610757219206*^9, 
   3.682680757678116*^9, 3.682685995476046*^9, 3.682752704018092*^9, 
   3.682756710487393*^9, 3.682756762813251*^9, 3.682757242121088*^9, 
   3.682760331069257*^9, 3.682930089909143*^9, 3.682945413063436*^9, 
   3.682958056503264*^9, 3.6829595767492733`*^9, 3.682961209478853*^9, 
   3.683007555678288*^9, 3.683007588422323*^9, 3.683007629108288*^9, 
   3.684042726213551*^9, 3.684053377869603*^9, {3.684053422347171*^9, 
   3.6840534416074266`*^9}, 3.684053691457821*^9, {3.6840538256685953`*^9, 
   3.684053834247693*^9}, {3.684054025818329*^9, 3.684054037993121*^9}, 
   3.684055066342107*^9, 3.6840551242891283`*^9, 3.684055196918578*^9, 
   3.684055265797901*^9, 3.6840553828833847`*^9, {3.684055435020185*^9, 
   3.684055474200086*^9}, 3.684055597304861*^9, 3.6840556666281347`*^9, 
   3.684057229185067*^9, 3.684059046573504*^9, 3.684060969811079*^9, 
   3.684061746453833*^9, 3.690267384358655*^9, 3.690277782232836*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relatedness coefficients", "Section",
 CellChangeTimes->{{3.682098378907537*^9, 3.682098383041769*^9}}],

Cell[CellGroupData[{

Cell["Relatedness between two hawks", "Subsection",
 CellChangeTimes->{{3.6821006797907877`*^9, 3.682100685580933*^9}}],

Cell["Hawk dies on a site with two hawks, replaced by a new hawk", "Text",
 CellChangeTimes->{{3.682100716875992*^9, 3.682100768505619*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drhhdt1", "=", 
   RowBox[{"2", 
    RowBox[{"mh", "[", "2", "]"}], 
    RowBox[{"f", "[", "2", "]"}], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"ph", "[", 
       RowBox[{"h", ",", "h"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "2"], "+", 
        RowBox[{
         FractionBox["1", "2"], "rhh"}]}], ")"}]}], ")"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6821007405129757`*^9, 3.68210076008748*^9}, {
   3.682101608030251*^9, 3.682101644192315*^9}, 3.6821360594660063`*^9, {
   3.682141187951529*^9, 3.6821412205583982`*^9}, {3.682141333123571*^9, 
   3.682141333553995*^9}, {3.6821414171216307`*^9, 3.68214141936082*^9}, {
   3.682141456727585*^9, 3.682141513756228*^9}, {3.684055834432432*^9, 
   3.684055848068902*^9}}],

Cell["\<\
Dove dies on a site with one hawk, one dove, replaced by hawk\
\>", "Text",
 CellChangeTimes->{{3.682141517854609*^9, 3.6821415358148403`*^9}, {
  3.6821416320519533`*^9, 3.682141647443302*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drhhdt2", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    RowBox[{"f", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"ph", "[", 
        RowBox[{"d", ",", "h"}], "]"}], "rhd"}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"ph", "[", 
        RowBox[{"h", ",", "d"}], "]"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682141648378459*^9, 3.682141712724134*^9}, {
  3.6840558383753357`*^9, 3.684055850084552*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drhhdt", "=", 
   RowBox[{"rhh", "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"drhhdt1", "+", "drhhdt2"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"mh", "[", "2", "]"}], " ", 
        RowBox[{"f", "[", "2", "]"}], 
        RowBox[{"bh", "[", "2", "]"}]}], "+", 
       RowBox[{
        RowBox[{"md", "[", "1", "]"}], 
        RowBox[{"f", "[", "1", "]"}], 
        RowBox[{"bh", "[", "1", "]"}]}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6821417331900177`*^9, 3.682141747884907*^9}, {
  3.6901135741663923`*^9, 3.6901135885190897`*^9}, {3.690113670061862*^9, 
  3.690113671108466*^9}, {3.690115932802968*^9, 3.690115953266563*^9}, {
  3.690116071209846*^9, 3.690116086216729*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relatedness between hawk and dove", "Subsection",
 CellChangeTimes->{{3.682141756601061*^9, 3.68214176251266*^9}}],

Cell["Hawk dies on a site with two hawks, replaced by dove", "Text",
 CellChangeTimes->{{3.682141845414377*^9, 3.682141856414472*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drhddt1", "=", 
   RowBox[{"2", 
    RowBox[{"mh", "[", "2", "]"}], 
    RowBox[{"f", "[", "2", "]"}], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"ph", "[", 
         RowBox[{"h", ",", "h"}], "]"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "2"], "+", 
        RowBox[{
         FractionBox["1", "2"], "rhh"}]}], ")"}]}], ")"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6821417637067013`*^9, 3.682141767650845*^9}, {
  3.6821418652733927`*^9, 3.682141885185811*^9}, {3.6840558880713243`*^9, 
  3.684055889211667*^9}}],

Cell["Dove dies on a site with a hawk and dove, replaced by dove", "Text",
 CellChangeTimes->{{3.6821418893497257`*^9, 3.6821418990135317`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drhddt2", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    RowBox[{"f", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"ph", "[", 
          RowBox[{"d", ",", "h"}], "]"}]}], ")"}], "rhd"}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"ph", "[", 
          RowBox[{"h", ",", "d"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6821418999046926`*^9, 3.6821419675189133`*^9}, {
  3.6840558928876667`*^9, 3.684055909411965*^9}}],

Cell["Hawk dies on a site with a hawk and dove, replaced by hawk", "Text",
 CellChangeTimes->{{3.6821419699798107`*^9, 3.682141987483364*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drhddt3", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    RowBox[{"f", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"ph", "[", 
        RowBox[{"d", ",", "h"}], "]"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"ph", "[", 
        RowBox[{"h", ",", "d"}], "]"}], "rhd"}]}], ")"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6821425645549917`*^9, 3.68214261382229*^9}, {
  3.684055912374627*^9, 3.684055916692327*^9}}],

Cell["Dove dies on a site with two doves, replaced by hawk", "Text",
 CellChangeTimes->{{3.682142617572853*^9, 3.682142617980744*^9}, {
  3.682144509138755*^9, 3.68214451605048*^9}, {3.6821465067974854`*^9, 
  3.6821465161819973`*^9}, {3.68214655234869*^9, 3.682146560459737*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drhddt4", "=", 
   RowBox[{"2", 
    RowBox[{"md", "[", "0", "]"}], 
    RowBox[{"f", "[", "0", "]"}], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"ph", "[", 
       RowBox[{"d", ",", "d"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "2"], "+", 
        RowBox[{
         FractionBox["1", "2"], "rdd"}]}], ")"}]}], ")"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.682146518017878*^9, 3.6821465268665857`*^9}, {
   3.682146567368115*^9, 3.682146579169458*^9}, {3.682146769582816*^9, 
   3.68214679272392*^9}, 3.6821468351442633`*^9, {3.684055921493247*^9, 
   3.684055924875222*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drhddt", "=", 
   RowBox[{"rhd", "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"drhddt1", "+", "drhddt2", "+", "drhddt3", "+", "drhddt4"}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"mh", "[", "2", "]"}], 
        RowBox[{"f", "[", "2", "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"bh", "[", "2", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"md", "[", "1", "]"}], 
        RowBox[{"f", "[", "1", "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"bh", "[", "1", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"mh", "[", "1", "]"}], 
        RowBox[{"f", "[", "1", "]"}], 
        RowBox[{"bh", "[", "1", "]"}]}], "+", 
       RowBox[{"2", 
        RowBox[{"md", "[", "0", "]"}], 
        RowBox[{"f", "[", "0", "]"}], 
        RowBox[{"bh", "[", "0", "]"}]}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682147175494446*^9, 3.6821471906979847`*^9}, {
  3.682147275682651*^9, 3.682147281304256*^9}, {3.6902669820917263`*^9, 
  3.690266984786256*^9}, {3.690267087800963*^9, 3.690267090417594*^9}, {
  3.690267123392787*^9, 3.690267133292448*^9}, {3.690267222019134*^9, 
  3.690267252771645*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relatedness between two doves", "Subsection",
 CellChangeTimes->{{3.682146801022192*^9, 3.68214680408639*^9}}],

Cell["Dove dies on a site with two doves, replaced by dove", "Text",
 CellChangeTimes->{{3.682146846189437*^9, 3.682146857101396*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drdddt1", "=", 
   RowBox[{"2", " ", 
    RowBox[{"md", "[", "0", "]"}], 
    RowBox[{"f", "[", "0", "]"}], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"ph", "[", 
         RowBox[{"d", ",", "d"}], "]"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "2"], "+", 
        RowBox[{
         FractionBox["1", "2"], "rdd"}]}], ")"}]}], ")"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.682146806183455*^9, 3.6821468712957067`*^9}, {
  3.684056565783762*^9, 3.68405656739631*^9}}],

Cell["\<\
Hawk dies on a site with a hawk and a dove, replaced by a dove\
\>", "Text",
 CellChangeTimes->{{3.682147056353011*^9, 3.6821470646085033`*^9}, {
  3.683009009922729*^9, 3.6830090129059362`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drdddt2", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    RowBox[{"f", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"ph", "[", 
          RowBox[{"h", ",", "d"}], "]"}]}], ")"}], "rhd"}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"ph", "[", 
          RowBox[{"d", ",", "h"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6821470668189507`*^9, 3.682147069651259*^9}, {
  3.682147135098391*^9, 3.6821471682563887`*^9}, {3.68405657134317*^9, 
  3.684056579099928*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drdddt", "=", 
   RowBox[{"rdd", "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"drdddt1", "+", "drdddt2"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"md", "[", "0", "]"}], 
        RowBox[{"f", "[", "0", "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"bh", "[", "0", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"mh", "[", "1", "]"}], 
        RowBox[{"f", "[", "1", "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"bh", "[", "1", "]"}]}], ")"}]}]}], ")"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6821471957690287`*^9, 3.682147215232978*^9}, {
  3.682147285209251*^9, 3.6821472859992523`*^9}, {3.69026726493967*^9, 
  3.690267269451809*^9}, {3.69026735166504*^9, 3.690267392262415*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving the relatedness equations", "Subsection",
 CellChangeTimes->{{3.682147299698036*^9, 3.68214730516171*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"drdddt1", "+", "drdddt2"}], "//", "Variables"}]], "Input",
 CellChangeTimes->{{3.682147340476369*^9, 3.682147350715621*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"d", ",", "rdd", ",", 
   RowBox[{"f", "[", "0", "]"}], ",", 
   RowBox[{"md", "[", "0", "]"}], ",", "err", ",", 
   RowBox[{"pdh", "[", "0", "]"}], ",", 
   RowBox[{"pdh", "[", "1", "]"}], ",", 
   RowBox[{"phh", "[", "1", "]"}], ",", 
   RowBox[{"phh", "[", "2", "]"}], ",", 
   RowBox[{"f", "[", "1", "]"}], ",", 
   RowBox[{"mh", "[", "1", "]"}], ",", "rhd"}], "}"}]], "Output",
 CellChangeTimes->{
  3.682147351217752*^9, 3.682147421004189*^9, 3.6821580467774267`*^9, 
   3.682158083784499*^9, 3.682159085353016*^9, 3.68215913015455*^9, 
   3.682159181522254*^9, 3.682159405031416*^9, 3.6821607739781637`*^9, {
   3.682160910445315*^9, 3.682160938437458*^9}, 3.682161570678198*^9, 
   3.6823275136944113`*^9, 3.682328818938621*^9, 3.682362266813208*^9, 
   3.682399386321525*^9, 3.682402067125486*^9, 3.682411360284794*^9, 
   3.6825840206219263`*^9, 3.682584093128592*^9, 3.682593369192642*^9, 
   3.682610421822907*^9, 3.682610757323366*^9, 3.6826807577834806`*^9, 
   3.682685995539568*^9, 3.682752704080024*^9, 3.682756710549314*^9, 
   3.682756762888173*^9, 3.682757242186266*^9, 3.682760331137525*^9, 
   3.682930089974743*^9, 3.682945413274658*^9, 3.6829580566055593`*^9, 
   3.682959576881282*^9, 3.682961209563833*^9, 3.683007555757666*^9, 
   3.6830075885993757`*^9, 3.683007629202836*^9, 3.6840427262794657`*^9, 
   3.684056617357226*^9, 3.684057229251049*^9, 3.684059046630975*^9, 
   3.684060969867423*^9, 3.684061746503068*^9, {3.690267384537334*^9, 
   3.690267395299157*^9}, 3.690277782320251*^9, 3.690293603095882*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rsys", "=", 
   RowBox[{"{", 
    RowBox[{"drdddt", ",", "drhddt", ",", "drhhdt"}], "}"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.690293687374529*^9, 3.6902937003487663`*^9}}],

Cell["\<\
To prevent indeterminate expressions when d->1.0, simply the things\
\>", "Text",
 CellChangeTimes->{{3.6826111286934*^9, 3.682611147532548*^9}}],

Cell["Some numerical exmples", "Text",
 CellChangeTimes->{{3.682362121072191*^9, 3.682362131223483*^9}, 
   3.690267594189509*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ansRel", "[", 
    RowBox[{
     RowBox[{"{", "ds_", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"mh1_", ",", "mh2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"md0_", ",", "md1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"phhs_", ",", "pdhs_"}], "}"}], ",", 
     RowBox[{"{", "\[Epsilon]_", "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "freqs", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"freqs", "=", 
       RowBox[{"ans", "[", 
        RowBox[{
         RowBox[{"{", "ds", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mh1", ",", "mh2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"md0", ",", "md1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"phhs", ",", "pdhs"}], "}"}], ",", 
         RowBox[{"{", "\[Epsilon]", "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"rsys", "/.", "freqs"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"d", "\[Rule]", "ds"}], ",", 
            RowBox[{
             RowBox[{"mh", "[", "1", "]"}], "\[Rule]", "mh1"}], ",", 
            RowBox[{
             RowBox[{"mh", "[", "2", "]"}], "\[Rule]", "mh2"}], ",", 
            RowBox[{
             RowBox[{"md", "[", "0", "]"}], "\[Rule]", "md0"}], ",", 
            RowBox[{
             RowBox[{"md", "[", "1", "]"}], "\[Rule]", "md1"}], ",", 
            RowBox[{
             RowBox[{"md", "[", "2", "]"}], "\[Rule]", "md2"}], ",", 
            RowBox[{
             RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "phhs"}], ",", 
            RowBox[{
             RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "phhs"}], ",", 
            RowBox[{
             RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "pdhs"}], ",", 
            RowBox[{
             RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "pdhs"}], ",", 
            RowBox[{"err", "\[Rule]", "\[Epsilon]"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rdd", ",", "0.1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"rhh", ",", "0.1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"rhd", ",", "0.1"}], "}"}]}], "}"}]}], "]"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682362154307127*^9, 3.68236219633923*^9}, {
  3.6823622611929893`*^9, 3.6823622755329533`*^9}, {3.68405658761171*^9, 
  3.684056606130188*^9}, {3.6902936711475887`*^9, 3.690293740432849*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vx", "=", "0.25"}]], "Input",
 CellChangeTimes->{{3.682945983408217*^9, 3.682945991492906*^9}}],

Cell[BoxData["0.25`"], "Output",
 CellChangeTimes->{{3.68294598465029*^9, 3.682945992513949*^9}, 
   3.6829580579849253`*^9, 3.682959578407529*^9, 3.6829612106851177`*^9, 
   3.683007557361162*^9, 3.683007589660178*^9, 3.683007630321295*^9, 
   3.684042727852531*^9, 3.68405662885247*^9, 3.684057237716599*^9, 
   3.6840590556382236`*^9, 3.6840609786391497`*^9, 3.684061755316242*^9, 
   3.6902673901888037`*^9, 3.690267600276897*^9, 3.6902777825357513`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cx", "=", "0.8"}]], "Input",
 CellChangeTimes->{{3.6829459937708473`*^9, 3.6829459955242987`*^9}}],

Cell[BoxData["0.8`"], "Output",
 CellChangeTimes->{3.682945996426029*^9, 3.682958058030014*^9, 
  3.682959578455127*^9, 3.682961210717236*^9, 3.683007557401263*^9, 
  3.683007589666937*^9, 3.683007630370891*^9, 3.684042727858489*^9, 
  3.684056628890251*^9, 3.684057237747374*^9, 3.684059055658136*^9, 
  3.684060978664926*^9, 3.684061755336371*^9, 3.69026739019313*^9, 
  3.690267601400638*^9, 3.690277782541218*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ansRel", "[", 
  RowBox[{
   RowBox[{"{", ".99", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1.0", "-", "vx"}], ",", 
     RowBox[{"1.0", "-", 
      RowBox[{".5", "*", 
       RowBox[{"(", 
        RowBox[{"vx", "-", "cx"}], ")"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1.0", "-", 
      RowBox[{".5", "*", "cx"}]}], ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.35", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", "0.05", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.682362277214612*^9, 3.682362374222139*^9}, {
  3.682584023186549*^9, 3.682584024584736*^9}, {3.682945971089429*^9, 
  3.682945971143819*^9}, {3.68294986488445*^9, 3.682949865190816*^9}, {
  3.683008843432417*^9, 3.683008844678714*^9}, {3.684056612499538*^9, 
  3.6840566139938393`*^9}, {3.690292652417376*^9, 3.690292652840889*^9}, {
  3.690293764158939*^9, 3.690293768477059*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"rdd", "\[Rule]", "0.00019780205084282687`"}], ",", 
   RowBox[{"rhh", "\[Rule]", "0.002122581667577103`"}], ",", 
   RowBox[{"rhd", "\[Rule]", "0.006061765519635345`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.690293744235985*^9, 3.690293769162442*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Selection gradient", "Section",
 CellChangeTimes->{{3.6826870995883617`*^9, 3.682687107204843*^9}, {
  3.6827040779053926`*^9, 3.682704079385676*^9}, {3.684057597740849*^9, 
  3.684057598227005*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "D",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SubscriptBox["v", 
     RowBox[{"h", ",", "1"}]]}], TraditionalForm]]],
 ",\[Delta]p], effect of mutant hawk on its reproductive value when in patch \
with a dove"
}], "Subsection",
 CellChangeTimes->{{3.681925845874449*^9, 3.681925917621695*^9}, {
   3.682148625830776*^9, 3.68214864606923*^9}, {3.6821489079950533`*^9, 
   3.682148939575816*^9}, {3.68215840601661*^9, 3.682158407037374*^9}, 
   3.6827045414829397`*^9, {3.684057900678673*^9, 3.684057903349881*^9}}],

Cell["\<\
Mortality of focal hawk and replaced by focal\[CloseCurlyQuote]s offspring of \
type dove (producing a hawk would result in no change in RV)\
\>", "Text",
 CellChangeTimes->{{3.6819259258548727`*^9, 3.681925945317912*^9}, {
  3.681927660932111*^9, 3.681927698193883*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt1\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ph", "[", 
         RowBox[{"h", ",", "d"}], "]"}], "+", 
        RowBox[{"dph", "[", 
         RowBox[{"h", ",", "d"}], "]"}]}], ")"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], "-", 
      RowBox[{"vh", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68192594726071*^9, 3.681925971758462*^9}, {
   3.6819260190855913`*^9, 3.681926130947208*^9}, {3.681926435242239*^9, 
   3.681926436818954*^9}, 3.681926482730927*^9, 3.682009057140668*^9, {
   3.6821486572470617`*^9, 3.6821486643165693`*^9}, {3.6821487087565107`*^9, 
   3.682148710002554*^9}, {3.682704091033469*^9, 3.682704091486333*^9}, {
   3.684057118350216*^9, 3.684057125358927*^9}, 3.6840579076345663`*^9}],

Cell["Mortality of focal hawk and replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.68192633677034*^9, 3.681926359617897*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt2\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}], "+", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"vh", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681926361613797*^9, 3.6819263784774847`*^9}, {
   3.681926413492546*^9, 3.681926481130086*^9}, 3.682009059069139*^9, {
   3.682148714117815*^9, 3.682148714571002*^9}, 3.682704095171871*^9, {
   3.684057909302668*^9, 3.6840579104212837`*^9}}],

Cell["\<\
Mortality of the nonfocal dove and replaced by focal\[CloseCurlyQuote]s \
offspring of type dove\
\>", "Text",
 CellChangeTimes->{{3.681926317859852*^9, 3.681926334348077*^9}, 
   3.681926544690075*^9, {3.681926579360045*^9, 3.681926583510888*^9}, {
   3.681926636969471*^9, 3.6819266700431433`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt3\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ph", "[", 
         RowBox[{"h", ",", "d"}], "]"}], "+", 
        RowBox[{"dph", "[", 
         RowBox[{"h", ",", "d"}], "]"}]}], ")"}]}], ")"}], 
    RowBox[{"vd", "[", "1", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681926485767674*^9, 3.6819264890139637`*^9}, {
   3.68192652486548*^9, 3.68192659653953*^9}, {3.681926628842537*^9, 
   3.681926682312171*^9}, {3.681926718791271*^9, 3.681926718817273*^9}, 
   3.682009060228359*^9, {3.682097592047633*^9, 3.68209759532474*^9}, {
   3.6821487171734858`*^9, 3.68214872548204*^9}, 3.6827040983451023`*^9, 
   3.684057134552238*^9, {3.684057911440186*^9, 3.684057911999263*^9}}],

Cell["\<\
Mortality of the nonfocal dove and replaced by focal\[CloseCurlyQuote]s \
offspring of type hawk\
\>", "Text",
 CellChangeTimes->{{3.681926317859852*^9, 3.681926334348077*^9}, 
   3.681926544690075*^9, {3.681926579360045*^9, 3.681926583510888*^9}, {
   3.681926697907278*^9, 3.681926699041252*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt4\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ph", "[", 
       RowBox[{"h", ",", "d"}], "]"}], "+", 
      RowBox[{"dph", "[", 
       RowBox[{"h", ",", "d"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"vh", "[", "2", "]"}]}], "-", 
      RowBox[{"vh", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681926485767674*^9, 3.6819264890139637`*^9}, {
   3.68192652486548*^9, 3.68192659653953*^9}, {3.681926628842537*^9, 
   3.6819266565170918`*^9}, 3.6820090618934*^9, {3.682148727877877*^9, 
   3.682148736116351*^9}, 3.682704101151885*^9, 3.6840571372398033`*^9, {
   3.6840579129598494`*^9, 3.6840579132468576`*^9}}],

Cell["\<\
Mortality of the nonfocal dove and replaced by nonfocal offspring of type hawk\
\>", "Text",
 CellChangeTimes->{{3.681926606554904*^9, 3.681926619259595*^9}, {
  3.681926733120963*^9, 3.681926735911662*^9}, {3.681927427092368*^9, 
  3.681927430092204*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt5\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"d", ",", "h"}], "]"}], "+", 
         RowBox[{"rhd", " ", 
          RowBox[{"dph", "[", 
           RowBox[{"d", ",", "h"}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], "d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", 
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "d", ",", "h"}], 
                "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                "]"}]}], "]"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], "-", 
      RowBox[{"vh", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681926485767674*^9, 3.6819264890139637`*^9}, {
   3.68192652486548*^9, 3.68192659653953*^9}, {3.681926628842537*^9, 
   3.6819266565170918`*^9}, {3.6819267201356573`*^9, 3.681926784796221*^9}, {
   3.68192683930256*^9, 3.6819268756409187`*^9}, {3.681927243839273*^9, 
   3.6819273106996517`*^9}, {3.68200774527532*^9, 3.682007748906412*^9}, 
   3.682009063583851*^9, {3.682148740738834*^9, 3.682148741375119*^9}, 
   3.68270410325672*^9, {3.684057146892337*^9, 3.6840571899850817`*^9}, {
   3.684057790543395*^9, 3.684057812205989*^9}, {3.684057914309525*^9, 
   3.684057914601864*^9}}],

Cell["\<\
Mortality of a remote hawk, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.6820091009966784`*^9, 3.6820091353626547`*^9}, {
  3.6820094084444447`*^9, 3.68200940878259*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt6\[Delta]p", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], "k", " ", 
      RowBox[{"mh", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "d"}], "]"}], "+", 
           RowBox[{"dph", "[", 
            RowBox[{"h", ",", "d"}], "]"}]}], ")"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "-", "1", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", "d"}], "]"}], "+", 
             RowBox[{"dph", "[", 
              RowBox[{"h", ",", "d"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"vd", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820091378039627`*^9, 3.682009165972104*^9}, {
   3.682009196189785*^9, 3.6820092024320917`*^9}, {3.682009253476973*^9, 
   3.6820094372537603`*^9}, {3.682148767622493*^9, 3.682148804946928*^9}, 
   3.682704105806418*^9, {3.6840572044811974`*^9, 3.6840572112870703`*^9}, {
   3.684057917209785*^9, 3.684057917522463*^9}}],

Cell["\<\
Mortality of a remote dove, replaced by focal\[CloseCurlyQuote]s offspring \
\>", "Text",
 CellChangeTimes->{{3.682009384878317*^9, 3.682009395964232*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt7\[Delta]p", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{"2", "-", "k"}], ")"}], " ", 
      RowBox[{"md", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "d"}], "]"}], "+", 
           RowBox[{"dph", "[", 
            RowBox[{"h", ",", "d"}], "]"}]}], ")"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", "d"}], "]"}], "+", 
             RowBox[{"dph", "[", 
              RowBox[{"h", ",", "d"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"vd", "[", "k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820093785847588`*^9, 3.682009382762863*^9}, {
   3.682009453671788*^9, 3.682009482504977*^9}, {3.682148808823868*^9, 
   3.682148831019637*^9}, 3.682704108681299*^9, {3.6840572145380983`*^9, 
   3.6840572174382877`*^9}, {3.684057920050753*^9, 3.6840579203590593`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh1dt\[Delta]p", "=", 
   RowBox[{
   "dvh1dt1\[Delta]p", "+", "dvh1dt2\[Delta]p", "+", "dvh1dt3\[Delta]p", "+", 
    "dvh1dt4\[Delta]p", "+", "dvh1dt5\[Delta]p", "+", "dvh1dt6\[Delta]p", "+",
     "dvh1dt7\[Delta]p"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819273292045794`*^9, 3.68192735687001*^9}, {
  3.682009488406528*^9, 3.682009495179122*^9}, {3.682148837062303*^9, 
  3.6821488500140753`*^9}, {3.6827041110376787`*^9, 3.6827041237452803`*^9}, {
  3.684057921917987*^9, 3.68405794581289*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "D",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SubscriptBox["v", 
     RowBox[{"d", ",", "1"}]]}], TraditionalForm]]],
 ",\[Delta]p], effect of mutant dove on its reproductive value when in patch \
with a hawk"
}], "Subsection",
 CellChangeTimes->{{3.681925845874449*^9, 3.681925917621695*^9}, {
   3.6819276385562973`*^9, 3.681927643012681*^9}, {3.6821489492086563`*^9, 
   3.682148962709304*^9}, 3.6827045443476753`*^9, {3.684058127648767*^9, 
   3.684058130464773*^9}}],

Cell["\<\
Mortality of focal dove and replaced by focal\[CloseCurlyQuote]s offspring of \
type hawk\
\>", "Text",
 CellChangeTimes->{{3.681927646083029*^9, 3.68192766542691*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt1\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ph", "[", 
       RowBox[{"d", ",", "h"}], "]"}], "+", 
      RowBox[{"dph", "[", 
       RowBox[{"d", ",", "h"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], "-", 
      RowBox[{"vd", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819277026703978`*^9, 3.681927753911727*^9}, 
   3.68200906607246*^9, {3.6821490399016943`*^9, 3.6821490404193993`*^9}, {
   3.682704537230804*^9, 3.682704538312809*^9}, {3.684057630653081*^9, 
   3.684057649443519*^9}, {3.684057953520206*^9, 3.6840579538050127`*^9}}],

Cell["Mortality of focal dove and replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.6819277589352093`*^9, 3.6819277678851347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt2\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "1", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}], "+", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"vd", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681927755599751*^9, 3.681927786037052*^9}, 
   3.682009067510016*^9, 3.682149043590345*^9, {3.682704558373361*^9, 
   3.6827045606927767`*^9}, {3.682756678236326*^9, 3.6827566832790737`*^9}, {
   3.684057955020836*^9, 3.684057955316642*^9}}],

Cell["\<\
Mortality of nonfocal hawk and replaced by focal\[CloseCurlyQuote]s offspring \
of type hawk\
\>", "Text",
 CellChangeTimes->{{3.681927788198155*^9, 3.681927802268944*^9}, {
  3.6820047639760857`*^9, 3.682004764423377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt3\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ph", "[", 
       RowBox[{"d", ",", "h"}], "]"}], "+", 
      RowBox[{"dph", "[", 
       RowBox[{"d", ",", "h"}], "]"}]}], ")"}], 
    RowBox[{"vh", "[", "1", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819278039339848`*^9, 3.681927820192936*^9}, {
   3.681928010710494*^9, 3.681928022314131*^9}, 3.682009069053135*^9, 
   3.682149046100585*^9, {3.682704563013505*^9, 3.682704563717565*^9}, 
   3.682756684086083*^9, 3.684057667012927*^9, {3.6840579635260487`*^9, 
   3.684057963819777*^9}}],

Cell["\<\
Mortality of nonfocal hawk and replaced by focal\[CloseCurlyQuote]s offspring \
of type dove\
\>", "Text",
 CellChangeTimes->{{3.6819280252425003`*^9, 3.681928037744994*^9}, {
  3.681928107885906*^9, 3.68192810830996*^9}, {3.6820047654005413`*^9, 
  3.68200476557555*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt4\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ph", "[", 
         RowBox[{"d", ",", "h"}], "]"}], "+", 
        RowBox[{"dph", "[", 
         RowBox[{"d", ",", "h"}], "]"}]}], ")"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"vd", "[", "0", "]"}]}], "-", 
      RowBox[{"vd", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6819280389798*^9, 3.681928097445298*^9}, 
   3.682009071318041*^9, 3.6821490481735897`*^9, {3.682704565767733*^9, 
   3.68270456653341*^9}, 3.682756685022587*^9, 3.684057709293703*^9, {
   3.684057965054367*^9, 3.684057965358054*^9}}],

Cell["\<\
Mortality of the nonfocal hawk and replacement by nonfocal offspring of type \
dove\
\>", "Text",
 CellChangeTimes->{{3.6819281009568357`*^9, 3.681928127780846*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt5\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "1", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "d"}], "]"}], "+", 
           RowBox[{"rhd", " ", 
            RowBox[{"dph", "[", 
             RowBox[{"h", ",", "d"}], "]"}]}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ph", "[", 
                RowBox[{"h", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[Equal]", "1"}], ",", "d", ",", "h"}], 
                  "]"}]}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ph", "[", 
                RowBox[{"d", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                  "]"}]}], "]"}]}], ")"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], "-", 
      RowBox[{"vd", "[", "1", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681928129058757*^9, 3.681928229584217*^9}, {
   3.682009923518659*^9, 3.682009924206077*^9}, {3.682148974050123*^9, 
   3.6821489874304943`*^9}, 3.682149050456653*^9, {3.682704577373246*^9, 
   3.682704578697135*^9}, {3.684057739863696*^9, 3.684057752173274*^9}, {
   3.6840578283640127`*^9, 3.684057871324401*^9}, {3.684057966537676*^9, 
   3.6840579668428373`*^9}}],

Cell["\<\
Mortality of a remote hawk, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.6820096937515078`*^9, 3.68200970705304*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt6\[Delta]p", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], "k", " ", 
      RowBox[{"mh", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"d", ",", "h"}], "]"}], "+", 
           RowBox[{"dph", "[", 
            RowBox[{"d", ",", "h"}], "]"}]}], ")"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "-", "1", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", "h"}], "]"}], "+", 
             RowBox[{"dph", "[", 
              RowBox[{"d", ",", "h"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"vd", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682009716340624*^9, 3.682009741633101*^9}, 
   3.6821490525599318`*^9, {3.682704595726223*^9, 3.68270459678769*^9}, 
   3.6827566877124863`*^9, {3.684057881971327*^9, 3.684057886113173*^9}, {
   3.684057969216827*^9, 3.6840579703364773`*^9}}],

Cell["\<\
Mortality of a remote dove, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.682009751237131*^9, 3.682009760131051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt7\[Delta]p", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{"2", "-", "k"}], ")"}], " ", 
      RowBox[{"md", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"d", ",", "h"}], "]"}], "+", 
           RowBox[{"dph", "[", 
            RowBox[{"d", ",", "h"}], "]"}]}], ")"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", "h"}], "]"}], "+", 
             RowBox[{"dph", "[", 
              RowBox[{"d", ",", "h"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"vd", "[", "k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820093785847588`*^9, 3.682009382762863*^9}, {
   3.682009453671788*^9, 3.682009482504977*^9}, {3.682009770942122*^9, 
   3.682009781881384*^9}, 3.682149054682516*^9, {3.6827045992456703`*^9, 
   3.682704599907331*^9}, 3.6827566884804296`*^9, {3.6840578898938513`*^9, 
   3.684057893098241*^9}, {3.684058107101688*^9, 3.684058107452001*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd1dt\[Delta]p", "=", 
   RowBox[{
   "dvd1dt1\[Delta]p", "+", "dvd1dt2\[Delta]p", "+", "dvd1dt3\[Delta]p", "+", 
    "dvd1dt4\[Delta]p", "+", "dvd1dt5\[Delta]p", "+", "dvd1dt6\[Delta]p", "+",
     "dvd1dt7\[Delta]p"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681928234441332*^9, 3.681928255802907*^9}, {
  3.682009785510764*^9, 3.682009790254716*^9}, {3.682149056610606*^9, 
  3.682149066561804*^9}, {3.682704601956284*^9, 3.682704617248904*^9}, {
  3.6840581086914043`*^9, 3.68405811944986*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "D[",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", 
    RowBox[{"d", ",", "0"}]], TraditionalForm]]],
 ",\[Delta]p]"
}], "Subsection",
 CellChangeTimes->{{3.681928472202375*^9, 3.6819284868668833`*^9}, {
  3.684058160354732*^9, 3.684058167583535*^9}}],

Cell["\<\
Mortality of focal dove, replaced by focal\[CloseCurlyQuote]s offspring of \
type hawk\
\>", "Text",
 CellChangeTimes->{{3.6819285036646957`*^9, 3.681928516554496*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt1\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ph", "[", 
       RowBox[{"d", ",", "d"}], "]"}], "+", 
      RowBox[{"dph", "[", 
       RowBox[{"d", ",", "d"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "-", 
      RowBox[{"vd", "[", "0", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681928488000746*^9, 3.681928535190276*^9}, {
  3.682008123544552*^9, 3.682008123743497*^9}, {3.6820099290143433`*^9, 
  3.682009929445161*^9}, {3.6820940048913813`*^9, 3.6820940051399307`*^9}, {
  3.684052921906323*^9, 3.684052923208544*^9}, {3.6840581911848288`*^9, 
  3.684058197208365*^9}, {3.684058255327778*^9, 3.6840582564701643`*^9}}],

Cell["Mortality of focal dove, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.681928537408855*^9, 3.68192854448831*^9}, {
  3.6819286771859627`*^9, 3.681928681520582*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt2\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}], "+", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"vd", "[", "0", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68192854640654*^9, 3.6819285603331327`*^9}, {
   3.68192866864113*^9, 3.6819286875374327`*^9}, 3.682006840764783*^9, {
   3.682009934024764*^9, 3.682009934468092*^9}, 3.684058259615391*^9}],

Cell["\<\
Mortality of nonfocal dove, replaced by focal\[CloseCurlyQuote]s offspring of \
type dove;\
\>", "Text",
 CellChangeTimes->{{3.68192869093843*^9, 3.681928711842268*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt3\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ph", "[", 
         RowBox[{"d", ",", "d"}], "]"}], "+", 
        RowBox[{"dph", "[", 
         RowBox[{"d", ",", "d"}], "]"}]}], ")"}]}], ")"}], 
    RowBox[{"vd", "[", "0", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681928713865307*^9, 3.681928725483062*^9}, {
   3.6820047252771378`*^9, 3.682004746184661*^9}, 3.682005489217371*^9, {
   3.682008081799137*^9, 3.6820080916422997`*^9}, {3.6820081270402927`*^9, 
   3.682008127216434*^9}, {3.6820099356762047`*^9, 3.68200993705604*^9}, 
   3.684052928689547*^9, 3.684058213481688*^9, 3.684058261902732*^9}],

Cell["\<\
Mortality of nonfocal dove, replaced by focal\[CloseCurlyQuote]s offspring of \
type hawk;\
\>", "Text",
 CellChangeTimes->{{3.681928570567319*^9, 3.681928579606635*^9}, {
  3.6820047541665077`*^9, 3.6820047854705877`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt4\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ph", "[", 
       RowBox[{"d", ",", "d"}], "]"}], "+", 
      RowBox[{"dph", "[", 
       RowBox[{"d", ",", "d"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "+", 
      RowBox[{"vd", "[", "1", "]"}], "-", 
      RowBox[{"vd", "[", "0", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682004786630179*^9, 3.6820047933450336`*^9}, {
   3.68200487190224*^9, 3.68200488725364*^9}, 3.682005488213191*^9, {
   3.682008096919821*^9, 3.682008098044466*^9}, {3.6820081280839376`*^9, 
   3.682008128264373*^9}, {3.6820099390011463`*^9, 3.6820099394410963`*^9}, 
   3.6840529323860826`*^9, 3.684058219065732*^9, 3.684058264016094*^9}],

Cell["\<\
Mortality of nonfocal dove, replaced by nonfocal offspring of type hawk;\
\>", "Text",
 CellChangeTimes->{{3.682004953995056*^9, 3.682004965059964*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt5\[Delta]p", "=", 
   RowBox[{
    RowBox[{"md", "[", "0", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ph", "[", 
          RowBox[{"d", ",", "d"}], "]"}], "+", 
         RowBox[{"rdd", " ", 
          RowBox[{"dph", "[", 
           RowBox[{"d", ",", "d"}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", 
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "d", ",", "h"}], 
                "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                "]"}]}], "]"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], "-", 
      RowBox[{"vd", "[", "0", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68200496609521*^9, 3.682005090648181*^9}, 
   3.682005487388914*^9, {3.6820099436493692`*^9, 3.682009944105322*^9}, {
   3.684052935284096*^9, 3.684052964131206*^9}, {3.6840582242539587`*^9, 
   3.6840582274833937`*^9}, 3.684058266275481*^9}],

Cell["\<\
Mortality of a remote hawk, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.6820096937515078`*^9, 3.68200970705304*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt6\[Delta]p", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], "k", " ", 
      RowBox[{"mh", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"d", ",", "d"}], "]"}], "+", 
           RowBox[{"dph", "[", 
            RowBox[{"d", ",", "d"}], "]"}]}], ")"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "-", "1", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", "d"}], "]"}], "+", 
             RowBox[{"dph", "[", 
              RowBox[{"d", ",", "d"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"vd", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682009716340624*^9, 3.682009741633101*^9}, {
  3.6820098070745173`*^9, 3.682009827951312*^9}, {3.684052972202599*^9, 
  3.6840529816896772`*^9}, {3.684058238251268*^9, 3.684058269009716*^9}}],

Cell["\<\
Mortality of a remote dove, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.682009751237131*^9, 3.682009760131051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt7\[Delta]p", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{"2", "-", "k"}], ")"}], " ", 
      RowBox[{"md", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"d", ",", "d"}], "]"}], "+", 
           RowBox[{"dph", "[", 
            RowBox[{"d", ",", "d"}], "]"}]}], ")"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ph", "[", 
              RowBox[{"d", ",", "d"}], "]"}], "+", 
             RowBox[{"dph", "[", 
              RowBox[{"d", ",", "d"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"vd", "[", "k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820093785847588`*^9, 3.682009382762863*^9}, {
  3.682009453671788*^9, 3.682009482504977*^9}, {3.682009770942122*^9, 
  3.682009831013*^9}, {3.684052984834188*^9, 3.6840529880733147`*^9}, {
  3.684058245307209*^9, 3.6840582733942947`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvd0dt\[Delta]p", "=", 
   RowBox[{
   "dvd0dt1\[Delta]p", "+", "dvd0dt2\[Delta]p", "+", "dvd0dt3\[Delta]p", "+", 
    "dvd0dt4\[Delta]p", "+", "dvd0dt5\[Delta]p", "+", "dvd0dt6\[Delta]p", "+",
     "dvd0dt7\[Delta]p"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820051000674963`*^9, 3.682005113434269*^9}, {
  3.682009833362094*^9, 3.682009839901073*^9}, {3.6840582807635*^9, 
  3.684058289886343*^9}, {3.684058378241352*^9, 3.684058378935938*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "D[",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", 
    RowBox[{"h", ",", "2"}]], TraditionalForm]]],
 ",\[Delta]p]"
}], "Subsection",
 CellChangeTimes->{{3.6820051204203377`*^9, 3.6820051414023237`*^9}, {
  3.68405817222786*^9, 3.684058176431323*^9}}],

Cell["\<\
Mortality of focal hawk, replaced by focal\[CloseCurlyQuote]s offspring of \
type dove\
\>", "Text",
 CellChangeTimes->{{3.68200543372608*^9, 3.682005443846343*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt1\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ph", "[", 
         RowBox[{"h", ",", "h"}], "]"}], "+", 
        RowBox[{"dph", "[", 
         RowBox[{"h", ",", "h"}], "]"}]}], ")"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], "-", 
      RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68200544554594*^9, 3.68200548235351*^9}, {
  3.6820075364919767`*^9, 3.682007536707572*^9}, {3.682009947460268*^9, 
  3.6820099478831043`*^9}, {3.68209399338303*^9, 3.682093994300618*^9}, {
  3.684053005352357*^9, 3.6840530066790457`*^9}, {3.6840584529222527`*^9, 
  3.684058459817465*^9}, {3.684058520208346*^9, 3.6840585211199713`*^9}}],

Cell["Mortality of focal hawk, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.6820054917001877`*^9, 3.6820055010911818`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt2\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}], "+", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005511622324*^9, 3.682005520743215*^9}, {
   3.6820055709159184`*^9, 3.682005592142858*^9}, {3.682009949305634*^9, 
   3.682009950569125*^9}, 3.6840585250253773`*^9}],

Cell["\<\
Mortality of nonfocal hawk, replaced by focal\[CloseCurlyQuote]s offspring of \
type hawk;\
\>", "Text",
 CellChangeTimes->{{3.682005595151394*^9, 3.682005607998982*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt3\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ph", "[", 
       RowBox[{"h", ",", "h"}], "]"}], "+", 
      RowBox[{"dph", "[", 
       RowBox[{"h", ",", "h"}], "]"}]}], ")"}], 
    RowBox[{"vh", "[", "2", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005625606286*^9, 3.682005653450034*^9}, {
   3.682009951425269*^9, 3.6820099518704348`*^9}, 3.6840530115832233`*^9, 
   3.684058465618194*^9, 3.684058527095973*^9}],

Cell["\<\
Mortality of nonfocal hawk, replaced by focal\[CloseCurlyQuote]s offspring of \
type dove;\
\>", "Text",
 CellChangeTimes->{{3.682005655188333*^9, 3.682005667452868*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt4\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ph", "[", 
         RowBox[{"h", ",", "h"}], "]"}], "+", 
        RowBox[{"dph", "[", 
         RowBox[{"h", ",", "h"}], "]"}]}], ")"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "+", 
      RowBox[{"vd", "[", "1", "]"}], "-", 
      RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005673808475*^9, 3.68200571825278*^9}, {
   3.682009953470873*^9, 3.6820099539351482`*^9}, 3.684053014344287*^9, 
   3.684058468995248*^9, 3.6840585286015263`*^9}],

Cell["\<\
Mortality of nonfocal hawk, replaced by nonfocal offspring of type dove;\
\>", "Text",
 CellChangeTimes->{{3.68200572017826*^9, 3.682005731785377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt5\[Delta]p", "=", 
   RowBox[{
    RowBox[{"mh", "[", "2", "]"}], 
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "h"}], "]"}], "+", 
           RowBox[{"rhh", " ", 
            RowBox[{"dph", "[", 
             RowBox[{"h", ",", "h"}], "]"}]}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "k", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ph", "[", 
                RowBox[{"h", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[Equal]", "1"}], ",", "d", ",", "h"}], 
                  "]"}]}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", "k"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ph", "[", 
                RowBox[{"d", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "\[Equal]", "1"}], ",", "h", ",", "d"}], 
                  "]"}]}], "]"}]}], ")"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], "-", 
      RowBox[{"vh", "[", "2", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005733843959*^9, 3.682005795637632*^9}, {
   3.682009955258163*^9, 3.68200995571586*^9}, {3.684053017194581*^9, 
   3.684053047181785*^9}, {3.6840584733770523`*^9, 3.684058475654405*^9}, 
   3.684058530478479*^9}],

Cell["\<\
Mortality of a remote hawk, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.6820096937515078`*^9, 3.68200970705304*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt6\[Delta]p", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], "k", " ", 
      RowBox[{"mh", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "h"}], "]"}], "+", 
           RowBox[{"dph", "[", 
            RowBox[{"h", ",", "h"}], "]"}]}], ")"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "-", "1", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", "h"}], "]"}], "+", 
             RowBox[{"dph", "[", 
              RowBox[{"h", ",", "h"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"vd", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682009716340624*^9, 3.682009741633101*^9}, {
  3.6820098070745173`*^9, 3.682009827951312*^9}, {3.6820098626023417`*^9, 
  3.682009883796426*^9}, {3.6840530507287283`*^9, 3.6840530571515093`*^9}, {
  3.684058502027246*^9, 3.684058537634962*^9}}],

Cell["\<\
Mortality of a remote dove, replaced by focal\[CloseCurlyQuote]s offspring\
\>", "Text",
 CellChangeTimes->{{3.682009751237131*^9, 3.682009760131051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt7\[Delta]p", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{"2", "-", "k"}], ")"}], " ", 
      RowBox[{"md", "[", "k", "]"}], 
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ph", "[", 
            RowBox[{"h", ",", "h"}], "]"}], "+", 
           RowBox[{"dph", "[", 
            RowBox[{"h", ",", "h"}], "]"}]}], ")"}], 
         RowBox[{"vh", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ph", "[", 
              RowBox[{"h", ",", "h"}], "]"}], "+", 
             RowBox[{"dph", "[", 
              RowBox[{"h", ",", "h"}], "]"}]}], ")"}]}], ")"}], 
         RowBox[{"vd", "[", "k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820093785847588`*^9, 3.682009382762863*^9}, {
  3.682009453671788*^9, 3.682009482504977*^9}, {3.682009770942122*^9, 
  3.682009831013*^9}, {3.6820098698972397`*^9, 3.682009885856658*^9}, {
  3.6840530614807253`*^9, 3.684053064679775*^9}, {3.684058511755145*^9, 
  3.6840585403308573`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvh2dt\[Delta]p", "=", 
   RowBox[{
   "dvh2dt1\[Delta]p", "+", "dvh2dt2\[Delta]p", "+", "dvh2dt3\[Delta]p", "+", 
    "dvh2dt4\[Delta]p", "+", "dvh2dt5\[Delta]p", "+", "dvh2dt6\[Delta]p", "+",
     "dvh2dt7\[Delta]p"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682005798415985*^9, 3.682005812226226*^9}, {
  3.682009878826271*^9, 3.682009893253294*^9}, {3.684058542606262*^9, 
  3.684058551816244*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final selection gradient", "Subsection",
 CellChangeTimes->{{3.684058592998148*^9, 3.684058595278048*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dv\[Delta]p", "[", "var_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", "0", "]"}], 
     RowBox[{"D", "[", 
      RowBox[{"dvd0dt\[Delta]p", ",", "var"}], "]"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"f", "[", "1", "]"}], "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"dvd1dt\[Delta]p", ",", "var"}], "]"}], "+", 
       RowBox[{"D", "[", 
        RowBox[{"dvh1dt\[Delta]p", ",", "var"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"f", "[", "2", "]"}], 
     RowBox[{"D", "[", 
      RowBox[{"dvh2dt\[Delta]p", ",", "var"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.684058596285364*^9, 3.684058712092133*^9}, {
  3.6840587489261103`*^9, 3.684058749318337*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Export pdh1, pdh0, phh2, phh1 to C for numerical iterations", "Section",
 CellChangeTimes->{{3.682160783295267*^9, 3.682160788447118*^9}, {
  3.6826813294969597`*^9, 3.6826813320013933`*^9}, {3.682685866808383*^9, 
  3.68268586743937*^9}, {3.6827523487657824`*^9, 3.682752354629344*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toC", "[", "x_", "]"}], ":=", 
   RowBox[{"ToString", "[", 
    RowBox[{"CForm", "[", "x", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682161456693557*^9, 3.682161470196316*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"destdir", "=", 
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/parental_effects_freq_dep/src/numerical/all_p/\>\""}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.682161717565921*^9, 3.6821617711984797`*^9}, {
   3.6825933994944*^9, 3.682593404584663*^9}, {3.682679951619446*^9, 
   3.6826799539863863`*^9}, 3.682686016773263*^9, {3.682752360836028*^9, 
   3.68275236201057*^9}, 3.68295961553316*^9, 3.683007623426265*^9}],

Cell["Recursions patch frequencies:", "Text",
 CellChangeTimes->{{3.682161882166662*^9, 3.682161885670203*^9}, 
   3.6821624505393877`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subslistpi", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", "2", "]"}], "\[Rule]", 
     RowBox[{"1", "-", 
      RowBox[{"f", "[", "0", "]"}], "-", 
      RowBox[{"f", "[", "1", "]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682327597044585*^9, 3.6823276298697863`*^9}, {
   3.6823290359971857`*^9, 3.6823290417312613`*^9}, {3.6823357302793207`*^9, 
   3.68233578154373*^9}, {3.682335821498516*^9, 3.682335823800241*^9}, 
   3.6827523658025503`*^9, {3.6827564582527313`*^9, 3.682756459747501*^9}, {
   3.684042122362256*^9, 3.684042122696566*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "\"\<\ndouble df0dt = 0;\\n\ndouble df1dt = 0;\\n\nfor (int \
rtime=0;rtime<1e7;++rtime)\n{\\n\n df0dt=\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "0", "]"}], "+", 
       RowBox[{"0.01", "*", "df0dt"}]}], "/.", "subslistpi"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<df1dt=\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "1", "]"}], "+", 
       RowBox[{"0.01", "*", "df1dt"}]}], "/.", "subslistpi"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<if (fabs(df0dt-f(0))<1e-7 && fabs(df1dt-f(1))<1e-7)\n{\\n\n\
f(0)=bound(df0dt);\\n\nf(1)=bound(df1dt);\\n\nbreak;\n}\n\
f(0)=bound(df0dt);\\n\nf(1)=bound(df1dt);\\n\n}\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<gsl_vector_set(f,0,df0dt);\\ngsl_vector_set(f,1,df1dt);\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<patchrecurs.txt\>\""}], ",", "str"}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.682161887133985*^9, 3.682161949262312*^9}, {
  3.682162010303856*^9, 3.682162042156077*^9}, {3.682162104640438*^9, 
  3.682162123237709*^9}, {3.6821623891143293`*^9, 3.6821623939367723`*^9}, {
  3.682327392744194*^9, 3.682327394573818*^9}, {3.682327621755862*^9, 
  3.682327634169639*^9}, {3.68232903178618*^9, 3.682329034215569*^9}, {
  3.682332675735446*^9, 3.682332726798011*^9}, {3.682336840329123*^9, 
  3.682336959051839*^9}, {3.682337019281827*^9, 3.682337159552997*^9}, {
  3.6823374847557*^9, 3.682337501625996*^9}, {3.682338636259857*^9, 
  3.68233863667269*^9}, {3.6827564631202908`*^9, 3.682756464077887*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Export", "::", "nodir"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Directory \
\[NoBreak]\\!\\(\\\"/home/bram/Projects/parental_effects_freq_dep/src/\
numerical/all_p/\\\"\\)\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/Export\\\", ButtonNote -> \
\\\"Export::nodir\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.690294525179346*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"OpenWrite", "::", "noopen"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Cannot open \
\[NoBreak]\\!\\(\\\"/home/bram/Projects/parental_effects_freq_dep/src/\
numerical/all_p/patchrecurs.txt\\\"\\)\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/noopen\\\", ButtonNote -> \
\\\"OpenWrite::noopen\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6902945252123127`*^9}]
}, Open  ]],

Cell["Selection gradients:", "Text",
 CellChangeTimes->{{3.682162445075205*^9, 3.682162448753883*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"\"\<double phh1tplus1=bound(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"phh", "[", "1", "]"}], "+", 
       RowBox[{"0.01", "*", 
        RowBox[{"dv\[Delta]p", "[", 
         RowBox[{"\[Delta]phh", "[", "1", "]"}], "]"}]}]}], "/.", 
      "subslistpi"}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double phh2tplus1=bound(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"phh", "[", "2", "]"}], "+", 
       RowBox[{"0.01", "*", 
        RowBox[{"dv\[Delta]p", "[", 
         RowBox[{"\[Delta]phh", "[", "2", "]"}], "]"}]}]}], "/.", 
      "subslistpi"}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double pdh1tplus1=bound(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pdh", "[", "1", "]"}], "+", 
       RowBox[{"0.01", "*", 
        RowBox[{"dv\[Delta]p", "[", 
         RowBox[{"\[Delta]pdh", "[", "1", "]"}], "]"}]}]}], "/.", 
      "subslistpi"}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double pdh0tplus1=bound(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pdh", "[", "0", "]"}], "+", 
       RowBox[{"0.01", "*", 
        RowBox[{"dv\[Delta]p", "[", 
         RowBox[{"\[Delta]pdh", "[", "0", "]"}], "]"}]}]}], "/.", 
      "subslistpi"}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<gsl_vector_set(f,0, phh1tplus1);\n\\ngsl_vector_set(f,1, \
phh2tplus1);\n\\ngsl_vector_set(f,2, pdh1tplus1);\n\\ngsl_vector_set(f,3, \
pdh0tplus1);\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<selgrad.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682160858838086*^9, 3.682160917127363*^9}, {
   3.68216096750389*^9, 3.682160979262237*^9}, {3.68216147288342*^9, 
   3.682161509821845*^9}, {3.682161587471574*^9, 3.6821615946291447`*^9}, {
   3.682161690631402*^9, 3.682161714530292*^9}, {3.682161774243383*^9, 
   3.682161790857154*^9}, {3.682161877146689*^9, 3.682161878065649*^9}, {
   3.682162324817855*^9, 3.682162351559415*^9}, 3.68232740484098*^9, {
   3.6823278149584618`*^9, 3.682327820410331*^9}, {3.682330388675725*^9, 
   3.6823303901044064`*^9}, {3.682330509454705*^9, 3.682330519485196*^9}, {
   3.6823305878318453`*^9, 3.682330603857889*^9}, {3.682332631808494*^9, 
   3.682332664849325*^9}, 3.682332701627718*^9, {3.682336292270938*^9, 
   3.682336334159027*^9}, {3.682337473173208*^9, 3.6823374733079033`*^9}, {
   3.6825931524741697`*^9, 3.682593158474628*^9}, {3.6827523758443413`*^9, 
   3.682752471623835*^9}, 3.6827527870913343`*^9, {3.682755722838686*^9, 
   3.6827557242862*^9}, {3.6827564661991787`*^9, 3.6827564688454523`*^9}, {
   3.684058922741806*^9, 3.6840589589719887`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Export", "::", "nodir"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Directory \
\[NoBreak]\\!\\(\\\"/home/bram/Projects/parental_effects_freq_dep/src/\
numerical/all_p/\\\"\\)\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/Export\\\", ButtonNote -> \
\\\"Export::nodir\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.690294525291934*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"OpenWrite", "::", "noopen"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Cannot open \
\[NoBreak]\\!\\(\\\"/home/bram/Projects/parental_effects_freq_dep/src/\
numerical/all_p/selgrad.txt\\\"\\)\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/noopen\\\", ButtonNote -> \
\\\"OpenWrite::noopen\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.69029452529288*^9}]
}, Open  ]],

Cell["Reproductive values", "Text",
 CellChangeTimes->{{3.682593141350663*^9, 3.682593144663989*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], ",", "1.0"}], "}"}]}], "}"}], 
  ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double vh_1_tplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vh", "[", "1", "]"}], "/.", "solrv1"}], "/.", "subslistpi"}], 
     "]"}], "<>", "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double vh_2_tplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vh", "[", "2", "]"}], "/.", "solrv1"}], "/.", "subslistpi"}], 
     "]"}], "<>", "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double vd_0_tplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vd", "[", "0", "]"}], "/.", "solrv1"}], "/.", "subslistpi"}], 
     "]"}], "<>", "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double vd_1_tplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vd", "[", "1", "]"}], "/.", "solrv1"}], "/.", "subslistpi"}], 
     "]"}], "<>", "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<gsl_vector_set(f, 0, vh_1_tplus1);\\ngsl_vector_set(f, 1, \
vh_2_tplus1);\\ngsl_vector_set(f, 2, vd_0_tplus1);\\ngsl_vector_set(f, 3, \
vd_1_tplus1);\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<repvals.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682593250402199*^9, 3.682593294323497*^9}, {
  3.6825934273266077`*^9, 3.682593500088787*^9}, {3.682593596267352*^9, 
  3.682593626105576*^9}, {3.68259371776462*^9, 3.682593719783543*^9}, {
  3.6825939700484*^9, 3.682593984356481*^9}, {3.6825942579923477`*^9, 
  3.682594281286126*^9}, {3.68259457678067*^9, 3.682594579536339*^9}, {
  3.682610346972528*^9, 3.682610366288414*^9}, {3.682756471064345*^9, 
  3.6827564728786907`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceAll", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({solrv1}\\)\[NoBreak] is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/ReplaceAll/reps\\\
\", ButtonNote -> \\\"ReplaceAll::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.690294525340925*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceAll", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({solrv1}\\)\[NoBreak] is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/ReplaceAll/reps\\\
\", ButtonNote -> \\\"ReplaceAll::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6902945253573837`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceAll", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({solrv1}\\)\[NoBreak] is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/ReplaceAll/reps\\\
\", ButtonNote -> \\\"ReplaceAll::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.690294525373782*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceAll", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({solrv1}\\)\[NoBreak] is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/ReplaceAll/reps\\\
\", ButtonNote -> \\\"ReplaceAll::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.690294525390205*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Export", "::", "nodir"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Directory \
\[NoBreak]\\!\\(\\\"/home/bram/Projects/parental_effects_freq_dep/src/\
numerical/all_p/\\\"\\)\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/Export\\\", ButtonNote -> \
\\\"Export::nodir\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6902945254291162`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"OpenWrite", "::", "noopen"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Cannot open \
\[NoBreak]\\!\\(\\\"/home/bram/Projects/parental_effects_freq_dep/src/\
numerical/all_p/repvals.txt\\\"\\)\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/noopen\\\", ButtonNote -> \
\\\"OpenWrite::noopen\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.690294525456614*^9}]
}, Open  ]],

Cell["Relatedness coefficients", "Text",
 CellChangeTimes->{{3.68259363336897*^9, 3.6825936366162*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double rhhtplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"rhh", "/.", "rsols"}], "/.", "subslistpi"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double rhdtplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"rhd", "/.", "rsols"}], "/.", "subslistpi"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double rddtplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"rdd", "/.", "rsols"}], "/.", "subslistpi"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<gsl_vector_set(f, 0, rhhtplus1);\\ngsl_vector_set(f, 1, \
rhdtplus1);\\ngsl_vector_set(f, 2, rddtplus1);\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<relvals.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.68259371371527*^9, 3.682593772392009*^9}, {
  3.682593816998168*^9, 3.682593838735147*^9}, {3.6825938760937977`*^9, 
  3.68259392524818*^9}, {3.682593989922264*^9, 3.682594001021886*^9}, {
  3.6825942018430367`*^9, 3.682594252306324*^9}, {3.6825945708236217`*^9, 
  3.6825945712229958`*^9}, {3.6825946254331093`*^9, 3.6825946256430902`*^9}, {
  3.68259529837167*^9, 3.6825953146425343`*^9}, {3.682610917267015*^9, 
  3.682610943685817*^9}, {3.6826112671572237`*^9, 3.682611281271693*^9}, {
  3.6827564741955347`*^9, 3.682756475671907*^9}, {3.6827586164981337`*^9, 
  3.682758625128002*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceAll", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({rsols}\\)\[NoBreak] is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/ReplaceAll/reps\\\
\", ButtonNote -> \\\"ReplaceAll::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.690294525485054*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceAll", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({rsols}\\)\[NoBreak] is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/ReplaceAll/reps\\\
\", ButtonNote -> \\\"ReplaceAll::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6902945255021877`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceAll", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({rsols}\\)\[NoBreak] is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/ReplaceAll/reps\\\
\", ButtonNote -> \\\"ReplaceAll::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.690294525518673*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Export", "::", "nodir"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Directory \
\[NoBreak]\\!\\(\\\"/home/bram/Projects/parental_effects_freq_dep/src/\
numerical/all_p/\\\"\\)\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/Export\\\", ButtonNote -> \
\\\"Export::nodir\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6902945255604877`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"OpenWrite", "::", "noopen"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Cannot open \
\[NoBreak]\\!\\(\\\"/home/bram/Projects/parental_effects_freq_dep/src/\
numerical/all_p/relvals.txt\\\"\\)\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/noopen\\\", ButtonNote -> \
\\\"OpenWrite::noopen\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6902945255893784`*^9}]
}, Open  ]],

Cell["Parameters:", "Text",
 CellChangeTimes->{{3.6821624526654873`*^9, 3.682162453913859*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{"d", ",", 
     RowBox[{"md", "[", "0", "]"}], ",", 
     RowBox[{"mh", "[", "1", "]"}], ",", 
     RowBox[{"md", "[", "1", "]"}], ",", 
     RowBox[{"mh", "[", "2", "]"}], ",", "pdhinit", ",", "phhinit"}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"variables", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"params", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", "0", "]"}], ",", 
        RowBox[{"f", "[", "1", "]"}], ",", 
        RowBox[{"pdh", "[", "1", "]"}], ",", 
        RowBox[{"pdh", "[", "0", "]"}], ",", 
        RowBox[{"phh", "[", "1", "]"}], ",", 
        RowBox[{"phh", "[", "2", "]"}], ",", "rhh", ",", "rhd", ",", "rdd", 
        ",", 
        RowBox[{"vh", "[", "1", "]"}], ",", 
        RowBox[{"vh", "[", "2", "]"}], ",", 
        RowBox[{"vd", "[", "0", "]"}], ",", 
        RowBox[{"vd", "[", "1", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iter", "=", "1"}], ",", 
    RowBox[{"iter", "<=", 
     RowBox[{"Length", "[", "params", "]"}]}], ",", 
    RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
       RowBox[{"toC", "[", 
        RowBox[{"params", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", "\"\<;\\n\>\""}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<params.txt\>\""}], ",", "str"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iter", "=", "1"}], ",", 
    RowBox[{"iter", "<=", 
     RowBox[{"Length", "[", "variables", "]"}]}], ",", 
    RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
       RowBox[{"toC", "[", 
        RowBox[{"variables", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", "\"\<;\\n\>\""}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<variables.txt\>\""}], ",", "str"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.682328066784473*^9, 3.6823281140851583`*^9}, {
   3.682328224431203*^9, 3.682328322993704*^9}, {3.682328487512398*^9, 
   3.682328527081253*^9}, {3.682328814505022*^9, 3.6823288434444647`*^9}, 
   3.6823289446691017`*^9, 3.6823290482043056`*^9, {3.682335793054305*^9, 
   3.682335793435977*^9}, {3.682594969037878*^9, 3.682594980745699*^9}, {
   3.682613114300337*^9, 3.682613122530101*^9}, {3.682752486814995*^9, 
   3.682752494529079*^9}, 3.684042260607793*^9, {3.684042371194415*^9, 
   3.6840423773158703`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Export", "::", "nodir"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Directory \
\[NoBreak]\\!\\(\\\"/home/bram/Projects/parental_effects_freq_dep/src/\
numerical/all_p/\\\"\\)\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/Export\\\", ButtonNote -> \
\\\"Export::nodir\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.690294525643097*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"OpenWrite", "::", "noopen"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Cannot open \
\[NoBreak]\\!\\(\\\"/home/bram/Projects/parental_effects_freq_dep/src/\
numerical/all_p/params.txt\\\"\\)\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/noopen\\\", ButtonNote -> \
\\\"OpenWrite::noopen\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.690294525673238*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Export", "::", "nodir"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Directory \
\[NoBreak]\\!\\(\\\"/home/bram/Projects/parental_effects_freq_dep/src/\
numerical/all_p/\\\"\\)\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/Export\\\", ButtonNote -> \
\\\"Export::nodir\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6902945257187347`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"OpenWrite", "::", "noopen"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Cannot open \
\[NoBreak]\\!\\(\\\"/home/bram/Projects/parental_effects_freq_dep/src/\
numerical/all_p/variables.txt\\\"\\)\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/noopen\\\", ButtonNote -> \
\\\"OpenWrite::noopen\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.690294525749186*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Export p to C for numerical iterations", "Section",
 CellChangeTimes->{{3.682160783295267*^9, 3.682160788447118*^9}, {
   3.6826813294969597`*^9, 3.6826813320013933`*^9}, {3.682685866808383*^9, 
   3.68268586743937*^9}, {3.6827523487657824`*^9, 3.682752354629344*^9}, 
   3.684060565499308*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toC", "[", "x_", "]"}], ":=", 
   RowBox[{"ToString", "[", 
    RowBox[{"CForm", "[", "x", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682161456693557*^9, 3.682161470196316*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"destdir", "=", 
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/freq_dep/src/numerical/p_only/\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682161717565921*^9, 3.6821617711984797`*^9}, {
   3.6825933994944*^9, 3.682593404584663*^9}, {3.682679951619446*^9, 
   3.6826799539863863`*^9}, 3.682686016773263*^9, {3.682752360836028*^9, 
   3.68275236201057*^9}, 3.68295961553316*^9, 3.683007623426265*^9, {
   3.684060579440638*^9, 3.684060580326228*^9}, 3.690294538886232*^9}],

Cell["Recursions patch frequencies:", "Text",
 CellChangeTimes->{{3.682161882166662*^9, 3.682161885670203*^9}, 
   3.6821624505393877`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subslistponly", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "2", "]"}], "\[Rule]", 
      RowBox[{"1", "-", 
       RowBox[{"f", "[", "0", "]"}], "-", 
       RowBox[{"f", "[", "1", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "p"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "p"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.682327597044585*^9, 3.6823276298697863`*^9}, {
   3.6823290359971857`*^9, 3.6823290417312613`*^9}, {3.6823357302793207`*^9, 
   3.68233578154373*^9}, {3.682335821498516*^9, 3.682335823800241*^9}, 
   3.6827523658025503`*^9, {3.6827564582527313`*^9, 3.682756459747501*^9}, {
   3.684042122362256*^9, 3.684042122696566*^9}, {3.6840605034147863`*^9, 
   3.6840605188031683`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "\"\<\ndouble df0dt = 0;\\n\ndouble df1dt = 0;\\n\nfor (int \
rtime=0;rtime<1e7;++rtime)\n{\\n\n df0dt=\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "0", "]"}], "+", 
       RowBox[{"0.01", "*", "df0dt"}]}], "/.", "subslistponly"}], "]"}], 
    "<>", "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<df1dt=\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "1", "]"}], "+", 
       RowBox[{"0.01", "*", "df1dt"}]}], "/.", "subslistponly"}], "]"}], 
    "<>", "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<if (fabs(df0dt-f(0))<1e-7 && fabs(df1dt-f(1))<1e-7)\n{\\n\n\
f(0)=bound01(df0dt);\\n\nf(1)=bound01(df1dt);\\n\nbreak;\n}\n\
f(0)=bound01(df0dt);\\n\nf(1)=bound01(df1dt);\\n\n}\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<gsl_vector_set(f,0,df0dt);\\ngsl_vector_set(f,1,df1dt);\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<patchrecurs.txt\>\""}], ",", "str"}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.682161887133985*^9, 3.682161949262312*^9}, {
  3.682162010303856*^9, 3.682162042156077*^9}, {3.682162104640438*^9, 
  3.682162123237709*^9}, {3.6821623891143293`*^9, 3.6821623939367723`*^9}, {
  3.682327392744194*^9, 3.682327394573818*^9}, {3.682327621755862*^9, 
  3.682327634169639*^9}, {3.68232903178618*^9, 3.682329034215569*^9}, {
  3.682332675735446*^9, 3.682332726798011*^9}, {3.682336840329123*^9, 
  3.682336959051839*^9}, {3.682337019281827*^9, 3.682337159552997*^9}, {
  3.6823374847557*^9, 3.682337501625996*^9}, {3.682338636259857*^9, 
  3.68233863667269*^9}, {3.6827564631202908`*^9, 3.682756464077887*^9}, {
  3.684060654639913*^9, 3.6840606568830214`*^9}, {3.690294352420126*^9, 
  3.690294359768035*^9}}],

Cell["Selection gradients:", "Text",
 CellChangeTimes->{{3.682162445075205*^9, 3.682162448753883*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"\"\<double ptplus1=bound01(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"p", "+", 
       RowBox[{"0.01", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dv\[Delta]p", "[", 
           RowBox[{"\[Delta]phh", "[", "1", "]"}], "]"}], "+", 
          RowBox[{"dv\[Delta]p", "[", 
           RowBox[{"\[Delta]phh", "[", "2", "]"}], "]"}], "+", 
          RowBox[{"dv\[Delta]p", "[", 
           RowBox[{"\[Delta]pdh", "[", "0", "]"}], "]"}], "+", 
          RowBox[{"dv\[Delta]p", "[", 
           RowBox[{"\[Delta]pdh", "[", "1", "]"}], "]"}]}], ")"}]}]}], "/.", 
      "subslistponly"}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<gsl_vector_set(f,0, ptplus1);\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<selgrad.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682160858838086*^9, 3.682160917127363*^9}, {
   3.68216096750389*^9, 3.682160979262237*^9}, {3.68216147288342*^9, 
   3.682161509821845*^9}, {3.682161587471574*^9, 3.6821615946291447`*^9}, {
   3.682161690631402*^9, 3.682161714530292*^9}, {3.682161774243383*^9, 
   3.682161790857154*^9}, {3.682161877146689*^9, 3.682161878065649*^9}, {
   3.682162324817855*^9, 3.682162351559415*^9}, 3.68232740484098*^9, {
   3.6823278149584618`*^9, 3.682327820410331*^9}, {3.682330388675725*^9, 
   3.6823303901044064`*^9}, {3.682330509454705*^9, 3.682330519485196*^9}, {
   3.6823305878318453`*^9, 3.682330603857889*^9}, {3.682332631808494*^9, 
   3.682332664849325*^9}, 3.682332701627718*^9, {3.682336292270938*^9, 
   3.682336334159027*^9}, {3.682337473173208*^9, 3.6823374733079033`*^9}, {
   3.6825931524741697`*^9, 3.682593158474628*^9}, {3.6827523758443413`*^9, 
   3.682752471623835*^9}, 3.6827527870913343`*^9, {3.682755722838686*^9, 
   3.6827557242862*^9}, {3.6827564661991787`*^9, 3.6827564688454523`*^9}, {
   3.684058922741806*^9, 3.6840589589719887`*^9}, {3.684060588091708*^9, 
   3.684060692588243*^9}, {3.69029821848623*^9, 3.690298218835876*^9}}],

Cell["Reproductive values", "Text",
 CellChangeTimes->{{3.682593141350663*^9, 3.682593144663989*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], ",", "1.0"}], "}"}]}], "}"}], 
  ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "\"\<\n\tdouble vh_1_tplus1;\n\tdouble vh_2_tplus1;\n\tdouble vd_0_tplus1;\
\n\tdouble vd_1_tplus1;\n\tfor (int rtime=0;rtime<1e07;++rtime) {\n\t\t\
vh_1_tplus1 = bound0(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vh", "[", "1", "]"}], "+", 
       RowBox[{"eul", 
        RowBox[{"(", "dvh1dt", ")"}]}]}], "/.", "subslistponly"}], "]"}], 
    "<>", "\"\<);\n\t\tvh_2_tplus1 = bound0(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vh", "[", "2", "]"}], "+", 
       RowBox[{"eul", 
        RowBox[{"(", "dvh2dt", ")"}]}]}], "/.", "subslistponly"}], "]"}], 
    "<>", "\"\<);\n\t\tvd_0_tplus1 = bound0(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vd", "[", "0", "]"}], "+", 
       RowBox[{"eul", 
        RowBox[{"(", "dvd0dt", ")"}]}]}], "/.", "subslistponly"}], "]"}], 
    "<>", "\"\<);\n\t\tvd_1_tplus1 = bound0(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vd", "[", "1", "]"}], "+", 
       RowBox[{"eul", 
        RowBox[{"(", "dvd1dt", ")"}]}]}], "/.", "subslistponly"}], "]"}], 
    "<>", "\"\<);\n\n\t\tif (fabs(vh_1_tplus1 - vh(1)) < 1e-7 &&\n\t\t\t\t\
fabs(vh_2_tplus1 - vh(2)) < 1e-7 &&\n\t\t\t\tfabs(vd_0_tplus1 - vd(0)) < 1e-7 \
&&\n\t\t\t\tfabs(vd_1_tplus1 - vd(1)) < 1e-7)\n\t\t{\n\t\t\tbreak;\n\t\t}\n\n\
\t\tvh(1) = vh_1_tplus1;\n\t\tvh(2) = vh_2_tplus1;\n\t\tvd(0) = vd_0_tplus1;\n\
\t\tvd(1) = vd_1_tplus1;\n\t}\n\tgsl_vector_set(f, 0, vh(1));\n\t\
gsl_vector_set(f, 1, vh(2));\n\tgsl_vector_set(f, 2, vd(0));\n\t\
gsl_vector_set(f, 3, vd(1));\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<repvals.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682593250402199*^9, 3.682593294323497*^9}, {
  3.6825934273266077`*^9, 3.682593500088787*^9}, {3.682593596267352*^9, 
  3.682593626105576*^9}, {3.68259371776462*^9, 3.682593719783543*^9}, {
  3.6825939700484*^9, 3.682593984356481*^9}, {3.6825942579923477`*^9, 
  3.682594281286126*^9}, {3.68259457678067*^9, 3.682594579536339*^9}, {
  3.682610346972528*^9, 3.682610366288414*^9}, {3.682756471064345*^9, 
  3.6827564728786907`*^9}, {3.684060719316674*^9, 3.6840607240580273`*^9}, {
  3.690293937603519*^9, 3.690294042466384*^9}, {3.690294210847473*^9, 
  3.6902945034401503`*^9}, {3.690298607256329*^9, 3.690298607789392*^9}, {
  3.6903000954813232`*^9, 3.690300124369986*^9}, {3.6903001765543747`*^9, 
  3.690300190948062*^9}}],

Cell["Relatedness coefficients", "Text",
 CellChangeTimes->{{3.68259363336897*^9, 3.6825936366162*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"str", "=", 
  RowBox[{
  "\"\<\n\tdouble rhhtplus1;\n\tdouble rhdtplus1;\n\tdouble rddtplus1;\n\tfor \
(int rtime=0; rtime<1e07; ++rtime) {\n\t\trhhtplus1 = bound01(\>\"", "<>", 
   RowBox[{"toC", "[", "drhhdt", "]"}], "<>", 
   "\"\<);\n\t\trhdtplus1 = bound01(\>\"", "<>", 
   RowBox[{"toC", "[", "drhddt", "]"}], "<>", 
   "\"\<);\n\t\trddtplus1 = bound01(\>\"", "<>", 
   RowBox[{"toC", "[", "drdddt", "]"}], "<>", 
   "\"\<);\n\n\t\tif (\n\t\t\t\tfabs(rhhtplus1 - rhh) < 1e-07 &&\n\t\t\t\t\
fabs(rhdtplus1 - rhd) < 1e-07 &&\n\t\t\t\tfabs(rddtplus1 - rdd) < 1e-07\n\t\t\
\t)\n\t\t{\n\t\t\tbreak;\n\t\t}\n\t\trhh = rhhtplus1;\n\t\trhd = rhdtplus1;\n\
\t\trdd = rddtplus1;\n\t}\n\tgsl_vector_set(f, 0, rhh);\n\tgsl_vector_set(f, \
1, rhd);\n\tgsl_vector_set(f, 2, rdd);\n\>\""}]}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<relvals.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQXffYrOxv/mvHsO6eWhD974N8M4gObrveCqJTGJq7
QLT4x+UTQLRB894ZINprs8IsEK3xy2oziM4427kTRMtERz0E0SeU0sE0xx3d
FyDaaIoJmN7xxNvmH5Be0h9iB6KTu1fcYS147Wj26et9EP2LPZWDDUhv26jB
BaIvObq99wHSzg2lYHrbB/7fvkB6hoTKHxDNHX/s2Mmi145uojLHQbSAaNu8
9XVAfxRfXwSi/y+ctRlE+/D83Q6iq+bcYtsApNtfu3CBaN8XrEogWvrZI1UQ
vUY22QFEHzDVdwTREum+biCa44aKN4junL45GETPWDAvDER3LVbKA9Gz0h8U
gWgAV0i2oQ==
  "]],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceAll", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({rsols}\\)\[NoBreak] is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/ReplaceAll/reps\\\
\", ButtonNote -> \\\"ReplaceAll::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.690294542608066*^9, 3.690298224245348*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceAll", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({rsols}\\)\[NoBreak] is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/ReplaceAll/reps\\\
\", ButtonNote -> \\\"ReplaceAll::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.690294542608066*^9, 3.690298224262882*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceAll", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({rsols}\\)\[NoBreak] is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/ReplaceAll/reps\\\
\", ButtonNote -> \\\"ReplaceAll::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.690294542608066*^9, 3.69029822428479*^9}]
}, Open  ]],

Cell["Parameters:", "Text",
 CellChangeTimes->{{3.6821624526654873`*^9, 3.682162453913859*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{"d", ",", 
     RowBox[{"md", "[", "0", "]"}], ",", 
     RowBox[{"mh", "[", "1", "]"}], ",", 
     RowBox[{"md", "[", "1", "]"}], ",", 
     RowBox[{"mh", "[", "2", "]"}], ",", "pinit", ",", "err"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"variables", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"params", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", "0", "]"}], ",", 
        RowBox[{"f", "[", "1", "]"}], ",", "p", ",", "rhh", ",", "rhd", ",", 
        "rdd", ",", 
        RowBox[{"vh", "[", "1", "]"}], ",", 
        RowBox[{"vh", "[", "2", "]"}], ",", 
        RowBox[{"vd", "[", "0", "]"}], ",", 
        RowBox[{"vd", "[", "1", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iter", "=", "1"}], ",", 
    RowBox[{"iter", "<=", 
     RowBox[{"Length", "[", "params", "]"}]}], ",", 
    RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
       RowBox[{"toC", "[", 
        RowBox[{"params", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", "\"\<;\\n\>\""}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<params.txt\>\""}], ",", "str"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iter", "=", "1"}], ",", 
    RowBox[{"iter", "<=", 
     RowBox[{"Length", "[", "variables", "]"}]}], ",", 
    RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
       RowBox[{"toC", "[", 
        RowBox[{"variables", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", "\"\<;\\n\>\""}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<variables.txt\>\""}], ",", "str"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.682328066784473*^9, 3.6823281140851583`*^9}, {
   3.682328224431203*^9, 3.682328322993704*^9}, {3.682328487512398*^9, 
   3.682328527081253*^9}, {3.682328814505022*^9, 3.6823288434444647`*^9}, 
   3.6823289446691017`*^9, 3.6823290482043056`*^9, {3.682335793054305*^9, 
   3.682335793435977*^9}, {3.682594969037878*^9, 3.682594980745699*^9}, {
   3.682613114300337*^9, 3.682613122530101*^9}, {3.682752486814995*^9, 
   3.682752494529079*^9}, 3.684042260607793*^9, {3.684042371194415*^9, 
   3.6840423773158703`*^9}, {3.684060741429792*^9, 3.6840607476403303`*^9}, {
   3.6902796413810577`*^9, 3.6902796421848583`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export phh,pdh to C for numerical iterations", "Section",
 CellChangeTimes->{{3.682160783295267*^9, 3.682160788447118*^9}, {
   3.6826813294969597`*^9, 3.6826813320013933`*^9}, {3.682685866808383*^9, 
   3.68268586743937*^9}, {3.6827523487657824`*^9, 3.682752354629344*^9}, 
   3.684060565499308*^9, {3.684060769661354*^9, 3.6840607706527443`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toC", "[", "x_", "]"}], ":=", 
   RowBox[{"ToString", "[", 
    RowBox[{"CForm", "[", "x", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682161456693557*^9, 3.682161470196316*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"destdir", "=", 
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/parental_effects_freq_dep/src/numerical/simple/\>\""}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.682161717565921*^9, 3.6821617711984797`*^9}, {
   3.6825933994944*^9, 3.682593404584663*^9}, {3.682679951619446*^9, 
   3.6826799539863863`*^9}, 3.682686016773263*^9, {3.682752360836028*^9, 
   3.68275236201057*^9}, 3.68295961553316*^9, 3.683007623426265*^9, {
   3.684060579440638*^9, 3.684060580326228*^9}, {3.684060776394454*^9, 
   3.6840607795534782`*^9}}],

Cell["Recursions patch frequencies:", "Text",
 CellChangeTimes->{{3.682161882166662*^9, 3.682161885670203*^9}, 
   3.6821624505393877`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subslistpx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "2", "]"}], "\[Rule]", 
      RowBox[{"1", "-", 
       RowBox[{"f", "[", "0", "]"}], "-", 
       RowBox[{"f", "[", "1", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"phh", "[", "1", "]"}], "\[Rule]", "phh"}], ",", 
     RowBox[{
      RowBox[{"phh", "[", "2", "]"}], "\[Rule]", "phh"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "0", "]"}], "\[Rule]", "pdh"}], ",", 
     RowBox[{
      RowBox[{"pdh", "[", "1", "]"}], "\[Rule]", "pdh"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.682327597044585*^9, 3.6823276298697863`*^9}, {
   3.6823290359971857`*^9, 3.6823290417312613`*^9}, {3.6823357302793207`*^9, 
   3.68233578154373*^9}, {3.682335821498516*^9, 3.682335823800241*^9}, 
   3.6827523658025503`*^9, {3.6827564582527313`*^9, 3.682756459747501*^9}, {
   3.684042122362256*^9, 3.684042122696566*^9}, {3.6840605034147863`*^9, 
   3.6840605188031683`*^9}, {3.684060798725954*^9, 3.684060807893133*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "\"\<\ndouble df0dt = 0;\\n\ndouble df1dt = 0;\\n\nfor (int \
rtime=0;rtime<1e7;++rtime)\n{\\n\n df0dt=\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "0", "]"}], "+", 
       RowBox[{"0.01", "*", "df0dt"}]}], "/.", "subslistpx"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<df1dt=\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "1", "]"}], "+", 
       RowBox[{"0.01", "*", "df1dt"}]}], "/.", "subslistpx"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<if (fabs(df0dt-f(0))<1e-7 && fabs(df1dt-f(1))<1e-7)\n{\\n\n\
f(0)=bound(df0dt);\\n\nf(1)=bound(df1dt);\\n\nbreak;\n}\n\
f(0)=bound(df0dt);\\n\nf(1)=bound(df1dt);\\n\n}\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<gsl_vector_set(f,0,df0dt);\\ngsl_vector_set(f,1,df1dt);\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<patchrecurs.txt\>\""}], ",", "str"}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.682161887133985*^9, 3.682161949262312*^9}, {
  3.682162010303856*^9, 3.682162042156077*^9}, {3.682162104640438*^9, 
  3.682162123237709*^9}, {3.6821623891143293`*^9, 3.6821623939367723`*^9}, {
  3.682327392744194*^9, 3.682327394573818*^9}, {3.682327621755862*^9, 
  3.682327634169639*^9}, {3.68232903178618*^9, 3.682329034215569*^9}, {
  3.682332675735446*^9, 3.682332726798011*^9}, {3.682336840329123*^9, 
  3.682336959051839*^9}, {3.682337019281827*^9, 3.682337159552997*^9}, {
  3.6823374847557*^9, 3.682337501625996*^9}, {3.682338636259857*^9, 
  3.68233863667269*^9}, {3.6827564631202908`*^9, 3.682756464077887*^9}, {
  3.684060654639913*^9, 3.6840606568830214`*^9}, {3.68406081087127*^9, 
  3.684060813064576*^9}}],

Cell["Selection gradients:", "Text",
 CellChangeTimes->{{3.682162445075205*^9, 3.682162448753883*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"\"\<double phhtplus1=bound(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"phh", "+", 
       RowBox[{"0.01", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dv\[Delta]p", "[", 
           RowBox[{"\[Delta]phh", "[", "1", "]"}], "]"}], "+", 
          RowBox[{"dv\[Delta]p", "[", 
           RowBox[{"\[Delta]phh", "[", "2", "]"}], "]"}]}], ")"}]}]}], "/.", 
      "subslistpx"}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double pdhtplus1=bound(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"pdh", "+", 
       RowBox[{"0.01", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dv\[Delta]p", "[", 
           RowBox[{"\[Delta]pdh", "[", "1", "]"}], "]"}], "+", 
          RowBox[{"dv\[Delta]p", "[", 
           RowBox[{"\[Delta]pdh", "[", "0", "]"}], "]"}]}], ")"}]}]}], "/.", 
      "subslistpx"}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<gsl_vector_set(f,0, phhtplus1);\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<gsl_vector_set(f,1, pdhtplus1);\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<selgrad.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682160858838086*^9, 3.682160917127363*^9}, {
   3.68216096750389*^9, 3.682160979262237*^9}, {3.68216147288342*^9, 
   3.682161509821845*^9}, {3.682161587471574*^9, 3.6821615946291447`*^9}, {
   3.682161690631402*^9, 3.682161714530292*^9}, {3.682161774243383*^9, 
   3.682161790857154*^9}, {3.682161877146689*^9, 3.682161878065649*^9}, {
   3.682162324817855*^9, 3.682162351559415*^9}, 3.68232740484098*^9, {
   3.6823278149584618`*^9, 3.682327820410331*^9}, {3.682330388675725*^9, 
   3.6823303901044064`*^9}, {3.682330509454705*^9, 3.682330519485196*^9}, {
   3.6823305878318453`*^9, 3.682330603857889*^9}, {3.682332631808494*^9, 
   3.682332664849325*^9}, 3.682332701627718*^9, {3.682336292270938*^9, 
   3.682336334159027*^9}, {3.682337473173208*^9, 3.6823374733079033`*^9}, {
   3.6825931524741697`*^9, 3.682593158474628*^9}, {3.6827523758443413`*^9, 
   3.682752471623835*^9}, 3.6827527870913343`*^9, {3.682755722838686*^9, 
   3.6827557242862*^9}, {3.6827564661991787`*^9, 3.6827564688454523`*^9}, {
   3.684058922741806*^9, 3.6840589589719887`*^9}, {3.684060588091708*^9, 
   3.684060692588243*^9}, {3.68406081736339*^9, 3.684060896162661*^9}}],

Cell["Reproductive values", "Text",
 CellChangeTimes->{{3.682593141350663*^9, 3.682593144663989*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vh", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vd", "[", "1", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vd", "[", "0", "]"}], ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vh", "[", "2", "]"}], ",", "1.0"}], "}"}]}], "}"}], 
  ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double vh_1_tplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vh", "[", "1", "]"}], "/.", "solrv1"}], "/.", "subslistpx"}], 
     "]"}], "<>", "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double vh_2_tplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vh", "[", "2", "]"}], "/.", "solrv1"}], "/.", "subslistpx"}], 
     "]"}], "<>", "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double vd_0_tplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vd", "[", "0", "]"}], "/.", "solrv1"}], "/.", "subslistpx"}], 
     "]"}], "<>", "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double vd_1_tplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"vd", "[", "1", "]"}], "/.", "solrv1"}], "/.", "subslistpx"}], 
     "]"}], "<>", "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<gsl_vector_set(f, 0, vh_1_tplus1);\\ngsl_vector_set(f, 1, \
vh_2_tplus1);\\ngsl_vector_set(f, 2, vd_0_tplus1);\\ngsl_vector_set(f, 3, \
vd_1_tplus1);\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<repvals.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682593250402199*^9, 3.682593294323497*^9}, {
  3.6825934273266077`*^9, 3.682593500088787*^9}, {3.682593596267352*^9, 
  3.682593626105576*^9}, {3.68259371776462*^9, 3.682593719783543*^9}, {
  3.6825939700484*^9, 3.682593984356481*^9}, {3.6825942579923477`*^9, 
  3.682594281286126*^9}, {3.68259457678067*^9, 3.682594579536339*^9}, {
  3.682610346972528*^9, 3.682610366288414*^9}, {3.682756471064345*^9, 
  3.6827564728786907`*^9}, {3.684060719316674*^9, 3.6840607240580273`*^9}, {
  3.684060902510347*^9, 3.684060909248065*^9}}],

Cell["Relatedness coefficients", "Text",
 CellChangeTimes->{{3.68259363336897*^9, 3.6825936366162*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double rhhtplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"rhh", "/.", "rsols"}], "/.", "subslistpx"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double rhdtplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"rhd", "/.", "rsols"}], "/.", "subslistpx"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double rddtplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"rdd", "/.", "rsols"}], "/.", "subslistpx"}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<gsl_vector_set(f, 0, rhhtplus1);\\ngsl_vector_set(f, 1, \
rhdtplus1);\\ngsl_vector_set(f, 2, rddtplus1);\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<relvals.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.68259371371527*^9, 3.682593772392009*^9}, {
  3.682593816998168*^9, 3.682593838735147*^9}, {3.6825938760937977`*^9, 
  3.68259392524818*^9}, {3.682593989922264*^9, 3.682594001021886*^9}, {
  3.6825942018430367`*^9, 3.682594252306324*^9}, {3.6825945708236217`*^9, 
  3.6825945712229958`*^9}, {3.6825946254331093`*^9, 3.6825946256430902`*^9}, {
  3.68259529837167*^9, 3.6825953146425343`*^9}, {3.682610917267015*^9, 
  3.682610943685817*^9}, {3.6826112671572237`*^9, 3.682611281271693*^9}, {
  3.6827564741955347`*^9, 3.682756475671907*^9}, {3.6827586164981337`*^9, 
  3.682758625128002*^9}, {3.684060726199102*^9, 3.684060728877597*^9}, {
  3.6840609127929707`*^9, 3.684060915529316*^9}}],

Cell["Parameters:", "Text",
 CellChangeTimes->{{3.6821624526654873`*^9, 3.682162453913859*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{"d", ",", 
     RowBox[{"md", "[", "0", "]"}], ",", 
     RowBox[{"mh", "[", "1", "]"}], ",", 
     RowBox[{"md", "[", "1", "]"}], ",", 
     RowBox[{"mh", "[", "2", "]"}], ",", "pdhinit", ",", "phhinit"}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"variables", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"params", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", "0", "]"}], ",", 
        RowBox[{"f", "[", "1", "]"}], ",", "pdh", ",", "phh", ",", "rhh", ",",
         "rhd", ",", "rdd", ",", 
        RowBox[{"vh", "[", "1", "]"}], ",", 
        RowBox[{"vh", "[", "2", "]"}], ",", 
        RowBox[{"vd", "[", "0", "]"}], ",", 
        RowBox[{"vd", "[", "1", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iter", "=", "1"}], ",", 
    RowBox[{"iter", "<=", 
     RowBox[{"Length", "[", "params", "]"}]}], ",", 
    RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
       RowBox[{"toC", "[", 
        RowBox[{"params", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", "\"\<;\\n\>\""}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<params.txt\>\""}], ",", "str"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iter", "=", "1"}], ",", 
    RowBox[{"iter", "<=", 
     RowBox[{"Length", "[", "variables", "]"}]}], ",", 
    RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
       RowBox[{"toC", "[", 
        RowBox[{"variables", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", "\"\<;\\n\>\""}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"destdir", "<>", "\"\<variables.txt\>\""}], ",", "str"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.682328066784473*^9, 3.6823281140851583`*^9}, {
   3.682328224431203*^9, 3.682328322993704*^9}, {3.682328487512398*^9, 
   3.682328527081253*^9}, {3.682328814505022*^9, 3.6823288434444647`*^9}, 
   3.6823289446691017`*^9, 3.6823290482043056`*^9, {3.682335793054305*^9, 
   3.682335793435977*^9}, {3.682594969037878*^9, 3.682594980745699*^9}, {
   3.682613114300337*^9, 3.682613122530101*^9}, {3.682752486814995*^9, 
   3.682752494529079*^9}, 3.684042260607793*^9, {3.684042371194415*^9, 
   3.6840423773158703`*^9}, {3.684060741429792*^9, 3.6840607476403303`*^9}, {
   3.684060920419674*^9, 3.6840609425056543`*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1855, 1056},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification->1.5,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 115, 1, 220, "Title"],
Cell[697, 25, 115, 1, 45, "Text"],
Cell[CellGroupData[{
Cell[837, 30, 109, 1, 119, "Section"],
Cell[949, 33, 139, 2, 45, "Input"],
Cell[CellGroupData[{
Cell[1113, 39, 134, 1, 65, "Subsection"],
Cell[1250, 42, 563, 9, 102, "Text"],
Cell[1816, 53, 2867, 86, 319, "Input"],
Cell[4686, 141, 3133, 88, 319, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7868, 235, 99, 1, 119, "Section"],
Cell[7970, 238, 388, 13, 47, "Text"],
Cell[8361, 253, 520, 15, 79, "Text"],
Cell[8884, 270, 2126, 59, 104, "Input"],
Cell[11013, 331, 121, 1, 45, "Text"],
Cell[11137, 334, 668, 17, 45, "Input"],
Cell[11808, 353, 118, 1, 45, "Text"],
Cell[11929, 356, 905, 26, 45, "Input"],
Cell[12837, 384, 123, 1, 45, "Text"],
Cell[12963, 387, 513, 15, 45, "Input"],
Cell[13479, 404, 303, 8, 45, "Input"],
Cell[13785, 414, 2165, 57, 133, "Input"],
Cell[15953, 473, 2261, 58, 133, "Input"],
Cell[18217, 533, 259, 6, 75, "Input"],
Cell[CellGroupData[{
Cell[18501, 543, 445, 12, 45, "Input"],
Cell[18949, 557, 892, 17, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19878, 579, 690, 15, 45, "Input"],
Cell[20571, 596, 2799, 44, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23419, 646, 106, 1, 119, "Section"],
Cell[CellGroupData[{
Cell[23550, 651, 281, 8, 70, "Subsection"],
Cell[23834, 661, 281, 5, 222, "Text"],
Cell[24118, 668, 702, 19, 445, "Input"],
Cell[24823, 689, 139, 1, 222, "Text"],
Cell[24965, 692, 503, 15, 445, "Input"],
Cell[25471, 709, 310, 6, 222, "Text"],
Cell[25784, 717, 666, 17, 445, "Input"],
Cell[26453, 736, 308, 6, 222, "Text"],
Cell[26764, 744, 619, 17, 445, "Input"],
Cell[27386, 763, 266, 5, 222, "Text"],
Cell[27655, 770, 1804, 48, 1203, "Input"],
Cell[29462, 820, 218, 4, 222, "Text"],
Cell[29683, 826, 994, 27, 445, "Input"],
Cell[30680, 855, 165, 3, 222, "Text"],
Cell[30848, 860, 958, 28, 445, "Input"],
Cell[31809, 890, 313, 7, 325, "Input"],
Cell[CellGroupData[{
Cell[32147, 901, 1162, 31, 486, "Input"],
Cell[33312, 934, 661, 13, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34010, 952, 153, 3, 325, "Input"],
Cell[34166, 957, 4333, 132, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[38548, 1095, 332, 9, 56, "Subsection"],
Cell[38883, 1106, 178, 4, 222, "Text"],
Cell[39064, 1112, 525, 15, 445, "Input"],
Cell[39592, 1129, 144, 1, 222, "Text"],
Cell[39739, 1132, 455, 15, 445, "Input"],
Cell[40197, 1149, 233, 5, 222, "Text"],
Cell[40433, 1156, 466, 13, 445, "Input"],
Cell[40902, 1171, 282, 6, 222, "Text"],
Cell[41187, 1179, 600, 18, 445, "Input"],
Cell[41790, 1199, 175, 4, 222, "Text"],
Cell[41968, 1205, 1721, 50, 1072, "Input"],
Cell[43692, 1257, 165, 3, 222, "Text"],
Cell[43860, 1262, 898, 26, 445, "Input"],
Cell[44761, 1290, 164, 3, 222, "Text"],
Cell[44928, 1295, 1005, 28, 445, "Input"],
Cell[45936, 1325, 312, 7, 325, "Input"],
Cell[CellGroupData[{
Cell[46273, 1336, 1212, 32, 486, "Input"],
Cell[47488, 1370, 1900, 31, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49425, 1406, 152, 3, 325, "Input"],
Cell[49580, 1411, 4399, 134, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[54028, 1551, 289, 8, 56, "Subsection"],
Cell[54320, 1561, 178, 4, 222, "Text"],
Cell[54501, 1567, 651, 17, 445, "Input"],
Cell[55155, 1586, 187, 2, 222, "Text"],
Cell[55345, 1590, 553, 16, 445, "Input"],
Cell[55901, 1608, 179, 4, 222, "Text"],
Cell[56083, 1614, 672, 17, 445, "Input"],
Cell[56758, 1633, 233, 5, 222, "Text"],
Cell[56994, 1640, 747, 19, 445, "Input"],
Cell[57744, 1661, 162, 3, 222, "Text"],
Cell[57909, 1666, 1523, 44, 919, "Input"],
Cell[59435, 1712, 165, 3, 222, "Text"],
Cell[59603, 1717, 947, 27, 445, "Input"],
Cell[60553, 1746, 164, 3, 222, "Text"],
Cell[60720, 1751, 1004, 28, 445, "Input"],
Cell[61727, 1781, 314, 7, 325, "Input"],
Cell[CellGroupData[{
Cell[62066, 1792, 1212, 32, 486, "Input"],
Cell[63281, 1826, 1874, 31, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65192, 1862, 152, 3, 325, "Input"],
Cell[65347, 1867, 4228, 130, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[69624, 2003, 291, 8, 56, "Subsection"],
Cell[69918, 2013, 175, 4, 222, "Text"],
Cell[70096, 2019, 703, 19, 445, "Input"],
Cell[70802, 2040, 141, 1, 222, "Text"],
Cell[70946, 2043, 529, 16, 445, "Input"],
Cell[71478, 2061, 180, 4, 222, "Text"],
Cell[71661, 2067, 442, 12, 445, "Input"],
Cell[72106, 2081, 180, 4, 222, "Text"],
Cell[72289, 2087, 623, 18, 445, "Input"],
Cell[72915, 2107, 161, 3, 222, "Text"],
Cell[73079, 2112, 1715, 50, 1072, "Input"],
Cell[74797, 2164, 165, 3, 222, "Text"],
Cell[74965, 2169, 997, 27, 445, "Input"],
Cell[75965, 2198, 164, 3, 222, "Text"],
Cell[76132, 2203, 1055, 29, 445, "Input"],
Cell[77190, 2234, 312, 7, 325, "Input"],
Cell[CellGroupData[{
Cell[77527, 2245, 1212, 32, 486, "Input"],
Cell[78742, 2279, 1856, 31, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80635, 2315, 152, 3, 325, "Input"],
Cell[80790, 2320, 4360, 134, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[85199, 2460, 107, 1, 51, "Subsection"],
Cell[85309, 2463, 2180, 64, 203, "Input"],
Cell[87492, 2529, 2338, 58, 162, "Input"],
Cell[89833, 2589, 2558, 61, 162, "Input"],
Cell[92394, 2652, 2889, 71, 191, "Input"],
Cell[CellGroupData[{
Cell[95308, 2727, 669, 15, 45, "Input"],
Cell[95980, 2744, 2016, 30, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98033, 2779, 1118, 22, 45, "Input"],
Cell[99154, 2803, 2515, 41, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101706, 2849, 1119, 22, 45, "Input"],
Cell[102828, 2873, 2474, 40, 45, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[105363, 2920, 109, 1, 119, "Section"],
Cell[CellGroupData[{
Cell[105497, 2925, 119, 1, 65, "Subsection"],
Cell[105619, 2928, 140, 1, 45, "Text"],
Cell[105762, 2931, 888, 24, 83, "Input"],
Cell[106653, 2957, 204, 4, 45, "Text"],
Cell[106860, 2963, 679, 21, 83, "Input"],
Cell[107542, 2986, 792, 20, 45, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108371, 3011, 120, 1, 65, "Subsection"],
Cell[108494, 3014, 134, 1, 45, "Text"],
Cell[108631, 3017, 727, 23, 83, "Input"],
Cell[109361, 3042, 144, 1, 45, "Text"],
Cell[109508, 3045, 808, 26, 83, "Input"],
Cell[110319, 3073, 142, 1, 45, "Text"],
Cell[110464, 3076, 680, 22, 83, "Input"],
Cell[111147, 3100, 280, 3, 45, "Text"],
Cell[111430, 3105, 739, 22, 83, "Input"],
Cell[112172, 3129, 1284, 34, 75, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113493, 3168, 116, 1, 65, "Subsection"],
Cell[113612, 3171, 134, 1, 45, "Text"],
Cell[113749, 3174, 678, 22, 83, "Input"],
Cell[114430, 3198, 205, 4, 45, "Text"],
Cell[114638, 3204, 854, 27, 83, "Input"],
Cell[115495, 3233, 854, 24, 45, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116386, 3262, 120, 1, 65, "Subsection"],
Cell[CellGroupData[{
Cell[116531, 3267, 159, 3, 45, "Input"],
Cell[116693, 3272, 1579, 27, 45, "Output"]
}, Open  ]],
Cell[118287, 3302, 214, 6, 45, "Input"],
Cell[118504, 3310, 155, 3, 45, "Text"],
Cell[118662, 3315, 130, 2, 45, "Text"],
Cell[118795, 3319, 2648, 67, 191, "Input"],
Cell[CellGroupData[{
Cell[121468, 3390, 119, 2, 45, "Input"],
Cell[121590, 3394, 458, 6, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122085, 3405, 122, 2, 45, "Input"],
Cell[122210, 3409, 417, 6, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122664, 3420, 924, 23, 45, "Input"],
Cell[123591, 3445, 307, 6, 45, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[123959, 3458, 205, 3, 119, "Section"],
Cell[CellGroupData[{
Cell[124189, 3465, 536, 13, 70, "Subsection"],
Cell[124728, 3480, 281, 5, 45, "Text"],
Cell[125012, 3487, 1012, 25, 81, "Input"],
Cell[126027, 3514, 139, 1, 45, "Text"],
Cell[126169, 3517, 636, 17, 83, "Input"],
Cell[126808, 3536, 310, 6, 45, "Text"],
Cell[127121, 3544, 919, 22, 81, "Input"],
Cell[128043, 3568, 308, 6, 45, "Text"],
Cell[128354, 3576, 873, 23, 81, "Input"],
Cell[129230, 3601, 266, 5, 45, "Text"],
Cell[129499, 3608, 2149, 56, 149, "Input"],
Cell[131651, 3666, 218, 4, 45, "Text"],
Cell[131872, 3672, 1414, 37, 81, "Input"],
Cell[133289, 3711, 165, 3, 45, "Text"],
Cell[133457, 3716, 1376, 37, 81, "Input"],
Cell[134836, 3755, 539, 10, 45, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135412, 3770, 494, 13, 70, "Subsection"],
Cell[135909, 3785, 178, 4, 45, "Text"],
Cell[136090, 3791, 803, 21, 81, "Input"],
Cell[136896, 3814, 144, 1, 45, "Text"],
Cell[137043, 3817, 636, 17, 83, "Input"],
Cell[137682, 3836, 233, 5, 45, "Text"],
Cell[137918, 3843, 738, 19, 81, "Input"],
Cell[138659, 3864, 282, 6, 45, "Text"],
Cell[138944, 3872, 855, 24, 81, "Input"],
Cell[139802, 3898, 175, 4, 45, "Text"],
Cell[139980, 3904, 2129, 58, 174, "Input"],
Cell[142112, 3964, 165, 3, 45, "Text"],
Cell[142280, 3969, 1335, 36, 81, "Input"],
Cell[143618, 4007, 164, 3, 45, "Text"],
Cell[143785, 4012, 1448, 38, 81, "Input"],
Cell[145236, 4052, 534, 10, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145807, 4067, 270, 9, 87, "Subsection"],
Cell[146080, 4078, 178, 4, 66, "Text"],
Cell[146261, 4084, 876, 22, 103, "Input"],
Cell[147140, 4108, 187, 2, 66, "Text"],
Cell[147330, 4112, 584, 16, 103, "Input"],
Cell[147917, 4130, 179, 4, 66, "Text"],
Cell[148099, 4136, 850, 21, 103, "Input"],
Cell[148952, 4159, 233, 5, 66, "Text"],
Cell[149188, 4166, 917, 23, 103, "Input"],
Cell[150108, 4191, 162, 3, 66, "Text"],
Cell[150273, 4196, 1771, 50, 103, "Input"],
Cell[152047, 4248, 165, 3, 66, "Text"],
Cell[152215, 4253, 1284, 35, 103, "Input"],
Cell[153502, 4290, 164, 3, 66, "Text"],
Cell[153669, 4295, 1346, 37, 103, "Input"],
Cell[155018, 4334, 484, 9, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155539, 4348, 271, 9, 87, "Subsection"],
Cell[155813, 4359, 175, 4, 66, "Text"],
Cell[155991, 4365, 936, 24, 103, "Input"],
Cell[156930, 4391, 141, 1, 66, "Text"],
Cell[157074, 4394, 564, 16, 103, "Input"],
Cell[157641, 4412, 180, 4, 66, "Text"],
Cell[157824, 4418, 616, 17, 103, "Input"],
Cell[158443, 4437, 180, 4, 66, "Text"],
Cell[158626, 4443, 807, 23, 103, "Input"],
Cell[159436, 4468, 161, 3, 66, "Text"],
Cell[159600, 4473, 1973, 56, 103, "Input"],
Cell[161576, 4531, 165, 3, 66, "Text"],
Cell[161744, 4536, 1337, 36, 103, "Input"],
Cell[163084, 4574, 164, 3, 66, "Text"],
Cell[163251, 4579, 1397, 38, 103, "Input"],
Cell[164651, 4619, 438, 9, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165126, 4633, 112, 1, 84, "Subsection"],
Cell[165241, 4636, 796, 23, 103, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[166086, 4665, 293, 3, 72, "Section"],
Cell[166382, 4670, 236, 6, 45, "Input"],
Cell[166621, 4678, 468, 10, 45, "Input"],
Cell[167092, 4690, 139, 2, 45, "Text"],
Cell[167234, 4694, 607, 13, 45, "Input"],
Cell[CellGroupData[{
Cell[167866, 4711, 1974, 48, 539, "Input"],
Cell[169843, 4761, 499, 11, 70, "Message"],
Cell[170345, 4774, 527, 11, 70, "Message"]
}, Open  ]],
Cell[170887, 4788, 102, 1, 45, "Text"],
Cell[CellGroupData[{
Cell[171014, 4793, 3184, 75, 278, "Input"],
Cell[174201, 4870, 499, 11, 70, "Message"],
Cell[174703, 4883, 520, 11, 70, "Message"]
}, Open  ]],
Cell[175238, 4897, 101, 1, 66, "Text"],
Cell[175342, 4900, 458, 16, 69, "Input"],
Cell[CellGroupData[{
Cell[175825, 4920, 2159, 53, 340, "Input"],
Cell[177987, 4975, 532, 10, 70, "Message"],
Cell[178522, 4987, 534, 10, 70, "Message"],
Cell[179059, 4999, 532, 10, 70, "Message"],
Cell[179594, 5011, 532, 10, 70, "Message"],
Cell[180129, 5023, 501, 11, 70, "Message"],
Cell[180633, 5036, 521, 11, 70, "Message"]
}, Open  ]],
Cell[181169, 5050, 103, 1, 66, "Text"],
Cell[CellGroupData[{
Cell[181297, 5055, 1869, 44, 295, "Input"],
Cell[183169, 5101, 531, 10, 70, "Message"],
Cell[183703, 5113, 533, 10, 70, "Message"],
Cell[184239, 5125, 531, 10, 70, "Message"],
Cell[184773, 5137, 501, 11, 70, "Message"],
Cell[185277, 5150, 523, 11, 70, "Message"]
}, Open  ]],
Cell[185815, 5164, 95, 1, 66, "Text"],
Cell[CellGroupData[{
Cell[185935, 5169, 3114, 78, 655, "Input"],
Cell[189052, 5249, 499, 11, 70, "Message"],
Cell[189554, 5262, 520, 11, 70, "Message"],
Cell[190077, 5275, 501, 11, 70, "Message"],
Cell[190581, 5288, 523, 11, 70, "Message"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[191153, 5305, 300, 4, 72, "Section"],
Cell[191456, 5311, 236, 6, 45, "Input"],
Cell[191695, 5319, 521, 10, 45, "Input"],
Cell[192219, 5331, 139, 2, 45, "Text"],
Cell[192361, 5335, 991, 24, 45, "Input"],
Cell[193355, 5361, 2088, 50, 539, "Input"],
Cell[195446, 5413, 102, 1, 45, "Text"],
Cell[195551, 5416, 2209, 44, 133, "Input"],
Cell[197763, 5462, 101, 1, 45, "Text"],
Cell[197867, 5465, 458, 16, 45, "Input"],
Cell[198328, 5483, 2618, 56, 887, "Input"],
Cell[200949, 5541, 103, 1, 45, "Text"],
Cell[CellGroupData[{
Cell[201077, 5546, 1381, 28, 771, "Input"],
Cell[202461, 5576, 553, 10, 34, "Message"],
Cell[203017, 5588, 553, 10, 34, "Message"],
Cell[203573, 5600, 552, 10, 34, "Message"]
}, Open  ]],
Cell[204140, 5613, 95, 1, 45, "Text"],
Cell[204238, 5616, 3036, 75, 423, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207311, 5696, 354, 4, 119, "Section"],
Cell[207668, 5702, 236, 6, 45, "Input"],
Cell[207907, 5710, 571, 12, 45, "Input"],
Cell[208481, 5724, 139, 2, 45, "Text"],
Cell[208623, 5728, 1042, 24, 45, "Input"],
Cell[209668, 5754, 2073, 50, 539, "Input"],
Cell[211744, 5806, 102, 1, 45, "Text"],
Cell[211849, 5809, 2689, 59, 162, "Input"],
Cell[214541, 5870, 101, 1, 66, "Text"],
Cell[214645, 5873, 458, 16, 69, "Input"],
Cell[215106, 5891, 2256, 54, 340, "Input"],
Cell[217365, 5947, 103, 1, 66, "Text"],
Cell[217471, 5950, 1966, 45, 295, "Input"],
Cell[219440, 5997, 95, 1, 66, "Text"],
Cell[219538, 6000, 3054, 75, 655, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
