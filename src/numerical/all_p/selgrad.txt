double phh1tplus1=bound(phh(1) + 0.01*(f(0)*(-((1 - d)*err*md(0)*vd(0))/8. + ((1 - d)*err*rdd*md(0)*(-vd(0) + vd(1)))/8. + ((1 - d)*err*md(0)*(-vd(0) + vh(1)))/8. + ((1 - d)*err*md(0)*(-vd(0) + vd(1) + vh(1)))/8. + d*f(0)*md(0)*(-(err*vd(0))/4. + (err*vh(1))/4.) + (d*f(1)*mh(1)*(-(err*vd(0))/4. + (err*vh(1))/4.))/2. + (d*f(1)*md(1)*(-(err*vd(1))/4. + (err*vh(2))/4.))/2. + d*(1 - f(0) - f(1))*mh(2)*(-(err*vd(1))/4. + (err*vh(2))/4.)) + (1 - f(0) - f(1))*(d*f(0)*md(0)*(-(err*vd(0))/4. + (err*vh(1))/4.) + (d*f(1)*mh(1)*(-(err*vd(0))/4. + (err*vh(1))/4.))/2. - ((1 - d)*err*mh(2)*(vd(1) - vh(2)))/8. - ((1 - d)*err*rhh*mh(2)*(vh(1) - vh(2)))/8. - ((1 - d)*err*mh(2)*(vd(1) + vh(1) - vh(2)))/8. + ((1 - d)*err*mh(2)*vh(2))/8. + (d*f(1)*md(1)*(-(err*vd(1))/4. + (err*vh(2))/4.))/2. + d*(1 - f(0) - f(1))*mh(2)*(-(err*vd(1))/4. + (err*vh(2))/4.)) + (f(1)*(-((1 - d)*(1 - (3*err)/4.)*rhd*mh(1)*(vd(0) - vd(1)))/2. - ((1 - d)*err*mh(1)*(2*vd(0) - vd(1)))/8. + ((1 - d)*(-1 + (3*err)/4.)*md(1)*vd(1))/2. + ((1 - d)*(-1 + (3*err)/4.)*mh(1)*(vd(0) - vh(1)))/2. + ((1 - d)*err*mh(1)*vh(1))/8. + d*f(0)*md(0)*((-1 + (3*err)/4.)*vd(0) + (1 - (3*err)/4.)*vh(1)) + (d*f(1)*mh(1)*((-1 + (3*err)/4.)*vd(0) + (1 - (3*err)/4.)*vh(1)))/2. + d*f(0)*md(0)*(-(err*vd(0))/4. + (err*vh(1))/4.) + (d*f(1)*mh(1)*(-(err*vd(0))/4. + (err*vh(1))/4.))/2. + ((1 - d)*err*md(1)*(-vd(1) + vh(2)))/8. + ((1 - d)*err*rhd*md(1)*(-vh(1) + vh(2)))/8. + ((1 - d)*(1 - (3*err)/4.)*md(1)*(-vh(1) + 2*vh(2)))/2. + (d*f(1)*md(1)*((-1 + (3*err)/4.)*vd(1) + (1 - (3*err)/4.)*vh(2)))/2. + d*(1 - f(0) - f(1))*mh(2)*((-1 + (3*err)/4.)*vd(1) + (1 - (3*err)/4.)*vh(2)) + (d*f(1)*md(1)*(-(err*vd(1))/4. + (err*vh(2))/4.))/2. + d*(1 - f(0) - f(1))*mh(2)*(-(err*vd(1))/4. + (err*vh(2))/4.)))/2.));

double phh2tplus1=bound(phh(2) + 0.01*((1 - f(0) - f(1))*(d*f(0)*md(0)*((-1 + (3*err)/4.)*vd(0) + (1 - (3*err)/4.)*vh(1)) + (d*f(1)*mh(1)*((-1 + (3*err)/4.)*vd(0) + (1 - (3*err)/4.)*vh(1)))/2. + ((1 - d)*(-1 + (3*err)/4.)*mh(2)*(vd(1) - vh(2)))/2. - ((1 - d)*(1 - (3*err)/4.)*rhh*mh(2)*(vh(1) - vh(2)))/2. + ((1 - d)*(-1 + (3*err)/4.)*mh(2)*(vd(1) + vh(1) - vh(2)))/2. + ((1 - d)*(1 - (3*err)/4.)*mh(2)*vh(2))/2. + (d*f(1)*md(1)*((-1 + (3*err)/4.)*vd(1) + (1 - (3*err)/4.)*vh(2)))/2. + d*(1 - f(0) - f(1))*mh(2)*((-1 + (3*err)/4.)*vd(1) + (1 - (3*err)/4.)*vh(2))) + f(0)*(-((1 - d)*err*md(0)*vd(0))/8. + ((1 - d)*err*rdd*md(0)*(-vd(0) + vd(1)))/8. + ((1 - d)*err*md(0)*(-vd(0) + vh(1)))/8. + ((1 - d)*err*md(0)*(-vd(0) + vd(1) + vh(1)))/8. + d*f(0)*md(0)*(-(err*vd(0))/4. + (err*vh(1))/4.) + (d*f(1)*mh(1)*(-(err*vd(0))/4. + (err*vh(1))/4.))/2. + (d*f(1)*md(1)*(-(err*vd(1))/4. + (err*vh(2))/4.))/2. + d*(1 - f(0) - f(1))*mh(2)*(-(err*vd(1))/4. + (err*vh(2))/4.)) + (f(1)*(-((1 - d)*err*rhd*mh(1)*(vd(0) - vd(1)))/8. - ((1 - d)*err*mh(1)*(2*vd(0) - vd(1)))/8. - ((1 - d)*err*md(1)*vd(1))/8. - ((1 - d)*err*mh(1)*(vd(0) - vh(1)))/8. + ((1 - d)*err*mh(1)*vh(1))/8. + 2*d*f(0)*md(0)*(-(err*vd(0))/4. + (err*vh(1))/4.) + d*f(1)*mh(1)*(-(err*vd(0))/4. + (err*vh(1))/4.) + ((1 - d)*err*md(1)*(-vd(1) + vh(2)))/8. + ((1 - d)*err*rhd*md(1)*(-vh(1) + vh(2)))/8. + ((1 - d)*err*md(1)*(-vh(1) + 2*vh(2)))/8. + d*f(1)*md(1)*(-(err*vd(1))/4. + (err*vh(2))/4.) + 2*d*(1 - f(0) - f(1))*mh(2)*(-(err*vd(1))/4. + (err*vh(2))/4.)))/2.));

double pdh1tplus1=bound(pdh(1) + 0.01*(f(0)*(-((1 - d)*err*md(0)*vd(0))/8. + ((1 - d)*err*rdd*md(0)*(-vd(0) + vd(1)))/8. + ((1 - d)*err*md(0)*(-vd(0) + vh(1)))/8. + ((1 - d)*err*md(0)*(-vd(0) + vd(1) + vh(1)))/8. + d*f(0)*md(0)*(-(err*vd(0))/4. + (err*vh(1))/4.) + (d*f(1)*mh(1)*(-(err*vd(0))/4. + (err*vh(1))/4.))/2. + (d*f(1)*md(1)*(-(err*vd(1))/4. + (err*vh(2))/4.))/2. + d*(1 - f(0) - f(1))*mh(2)*(-(err*vd(1))/4. + (err*vh(2))/4.)) + (1 - f(0) - f(1))*(d*f(0)*md(0)*(-(err*vd(0))/4. + (err*vh(1))/4.) + (d*f(1)*mh(1)*(-(err*vd(0))/4. + (err*vh(1))/4.))/2. - ((1 - d)*err*mh(2)*(vd(1) - vh(2)))/8. - ((1 - d)*err*rhh*mh(2)*(vh(1) - vh(2)))/8. - ((1 - d)*err*mh(2)*(vd(1) + vh(1) - vh(2)))/8. + ((1 - d)*err*mh(2)*vh(2))/8. + (d*f(1)*md(1)*(-(err*vd(1))/4. + (err*vh(2))/4.))/2. + d*(1 - f(0) - f(1))*mh(2)*(-(err*vd(1))/4. + (err*vh(2))/4.)) + (f(1)*(-((1 - d)*err*rhd*mh(1)*(vd(0) - vd(1)))/8. + ((1 - d)*(-1 + (3*err)/4.)*mh(1)*(2*vd(0) - vd(1)))/2. - ((1 - d)*err*md(1)*vd(1))/8. - ((1 - d)*err*mh(1)*(vd(0) - vh(1)))/8. + ((1 - d)*(1 - (3*err)/4.)*mh(1)*vh(1))/2. + d*f(0)*md(0)*((-1 + (3*err)/4.)*vd(0) + (1 - (3*err)/4.)*vh(1)) + (d*f(1)*mh(1)*((-1 + (3*err)/4.)*vd(0) + (1 - (3*err)/4.)*vh(1)))/2. + d*f(0)*md(0)*(-(err*vd(0))/4. + (err*vh(1))/4.) + (d*f(1)*mh(1)*(-(err*vd(0))/4. + (err*vh(1))/4.))/2. + ((1 - d)*(1 - (3*err)/4.)*md(1)*(-vd(1) + vh(2)))/2. + ((1 - d)*(1 - (3*err)/4.)*rhd*md(1)*(-vh(1) + vh(2)))/2. + ((1 - d)*err*md(1)*(-vh(1) + 2*vh(2)))/8. + (d*f(1)*md(1)*((-1 + (3*err)/4.)*vd(1) + (1 - (3*err)/4.)*vh(2)))/2. + d*(1 - f(0) - f(1))*mh(2)*((-1 + (3*err)/4.)*vd(1) + (1 - (3*err)/4.)*vh(2)) + (d*f(1)*md(1)*(-(err*vd(1))/4. + (err*vh(2))/4.))/2. + d*(1 - f(0) - f(1))*mh(2)*(-(err*vd(1))/4. + (err*vh(2))/4.)))/2.));

double pdh0tplus1=bound(pdh(0) + 0.01*(f(0)*(((1 - d)*(-1 + (3*err)/4.)*md(0)*vd(0))/2. + ((1 - d)*(1 - (3*err)/4.)*rdd*md(0)*(-vd(0) + vd(1)))/2. + ((1 - d)*(1 - (3*err)/4.)*md(0)*(-vd(0) + vh(1)))/2. + ((1 - d)*(1 - (3*err)/4.)*md(0)*(-vd(0) + vd(1) + vh(1)))/2. + d*f(0)*md(0)*((-1 + (3*err)/4.)*vd(0) + (1 - (3*err)/4.)*vh(1)) + (d*f(1)*mh(1)*((-1 + (3*err)/4.)*vd(0) + (1 - (3*err)/4.)*vh(1)))/2. + (d*f(1)*md(1)*((-1 + (3*err)/4.)*vd(1) + (1 - (3*err)/4.)*vh(2)))/2. + d*(1 - f(0) - f(1))*mh(2)*((-1 + (3*err)/4.)*vd(1) + (1 - (3*err)/4.)*vh(2))) + (1 - f(0) - f(1))*(d*f(0)*md(0)*(-(err*vd(0))/4. + (err*vh(1))/4.) + (d*f(1)*mh(1)*(-(err*vd(0))/4. + (err*vh(1))/4.))/2. - ((1 - d)*err*mh(2)*(vd(1) - vh(2)))/8. - ((1 - d)*err*rhh*mh(2)*(vh(1) - vh(2)))/8. - ((1 - d)*err*mh(2)*(vd(1) + vh(1) - vh(2)))/8. + ((1 - d)*err*mh(2)*vh(2))/8. + (d*f(1)*md(1)*(-(err*vd(1))/4. + (err*vh(2))/4.))/2. + d*(1 - f(0) - f(1))*mh(2)*(-(err*vd(1))/4. + (err*vh(2))/4.)) + (f(1)*(-((1 - d)*err*rhd*mh(1)*(vd(0) - vd(1)))/8. - ((1 - d)*err*mh(1)*(2*vd(0) - vd(1)))/8. - ((1 - d)*err*md(1)*vd(1))/8. - ((1 - d)*err*mh(1)*(vd(0) - vh(1)))/8. + ((1 - d)*err*mh(1)*vh(1))/8. + 2*d*f(0)*md(0)*(-(err*vd(0))/4. + (err*vh(1))/4.) + d*f(1)*mh(1)*(-(err*vd(0))/4. + (err*vh(1))/4.) + ((1 - d)*err*md(1)*(-vd(1) + vh(2)))/8. + ((1 - d)*err*rhd*md(1)*(-vh(1) + vh(2)))/8. + ((1 - d)*err*md(1)*(-vh(1) + 2*vh(2)))/8. + d*f(1)*md(1)*(-(err*vd(1))/4. + (err*vh(2))/4.) + 2*d*(1 - f(0) - f(1))*mh(2)*(-(err*vd(1))/4. + (err*vh(2))/4.)))/2.));

gsl_vector_set(f,0, phh1tplus1);

gsl_vector_set(f,1, phh2tplus1);

gsl_vector_set(f,2, pdh1tplus1);

gsl_vector_set(f,3, pdh0tplus1);