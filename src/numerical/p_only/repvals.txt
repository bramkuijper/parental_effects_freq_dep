double vh_1_tplus1 = -((-(((2*(1 - f(0) - f(1))*(2*(-1 + p)*(1 + c/2. - v/2.) + 2*d*(-1 + p)*(1 + c/2. - v/2.)*(-f(0) - f(1)) + d*(-1 + p)*f(1)) - f(1)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - (2*(1 - f(0) - f(1))*(2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(-1 + p)*(1 - v)*f(1)) - 2*f(0)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.)))*(2*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - 2*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))) + (-2*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)*(2*(1 - f(0) - f(1))*(2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(-1 + p)*(1 - v)*f(1)) - 2*f(0)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1))) + 2*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)))*((-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))*(-(f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))) + 2*(1 - f(0) - f(1))*(1 + p - (-2 + 2*p)*(1 - v) - 2*d*(-1 + p)*(1 - v)*f(0) + d*(-1 + p)*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)) + d*(1 - v)*(-2 + 2*p - 2*(-1 + p)*(1 - f(0) - f(1)) - (-2 + 2*p)*f(1)))) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1))))))/(-(((2*(1 - f(0) - f(1))*(2*(-1 + p)*(1 + c/2. - v/2.) + 2*d*(-1 + p)*(1 + c/2. - v/2.)*(-f(0) - f(1)) + d*(-1 + p)*f(1)) - f(1)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - (2*(1 - f(0) - f(1))*(2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(-1 + p)*(1 - v)*f(1)) - 2*f(0)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.)))*((2*(-(p*(1 - v)) - 2*d*p*(1 - v/2.)*f(0) - d*p*(1 - v)*(-1 + f(1)))*(1 - f(0) - f(1)) - f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + (d*p*(1 - v)*f(1))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))) + (-((-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + (d*p*(1 - v)*f(1))/2.))*(2*(1 - f(0) - f(1))*(2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(-1 + p)*(1 - v)*f(1)) - 2*f(0)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))) + (-(f(1)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1))) + 2*(1 - f(0) - f(1))*(2*(-1 + p)*(1 + c/2. - v/2.) - 2*d*p*(1 - v/2.)*f(0) + 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(-1 + p)*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*(1 - v)*f(1) + d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)))*((-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))*(-(f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))) + 2*(1 - f(0) - f(1))*(1 + p - (-2 + 2*p)*(1 - v) - 2*d*(-1 + p)*(1 - v)*f(0) + d*(-1 + p)*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)) + d*(1 - v)*(-2 + 2*p - 2*(-1 + p)*(1 - f(0) - f(1)) - (-2 + 2*p)*f(1)))) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))));

double vh_2_tplus1 = 1/(1 - f(0) - f(1)) + (2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.))/((1 - f(0) - f(1))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))) + ((f(1)/(2.*(1 - f(0) - f(1))) - (f(0)*(-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.)))/((1 - f(0) - f(1))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))))*(2*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - 2*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1))))))/((-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))*(-(f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))) + 2*(1 - f(0) - f(1))*(1 + p - (-2 + 2*p)*(1 - v) - 2*d*(-1 + p)*(1 - v)*f(0) + d*(-1 + p)*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)) + d*(1 - v)*(-2 + 2*p - 2*(-1 + p)*(1 - f(0) - f(1)) - (-2 + 2*p)*f(1)))) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1))))) + ((f(1)/(2.*(1 - f(0) - f(1))) - (f(0)*(-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + (d*p*(1 - v)*f(1))/2.)))/((1 - f(0) - f(1))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))) - ((f(1)/(2.*(1 - f(0) - f(1))) - (f(0)*(-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.)))/((1 - f(0) - f(1))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))))*((2*(-(p*(1 - v)) - 2*d*p*(1 - v/2.)*f(0) - d*p*(1 - v)*(-1 + f(1)))*(1 - f(0) - f(1)) - f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + (d*p*(1 - v)*f(1))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1))))))/((-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))*(-(f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))) + 2*(1 - f(0) - f(1))*(1 + p - (-2 + 2*p)*(1 - v) - 2*d*(-1 + p)*(1 - v)*f(0) + d*(-1 + p)*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)) + d*(1 - v)*(-2 + 2*p - 2*(-1 + p)*(1 - f(0) - f(1)) - (-2 + 2*p)*f(1)))) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1))))))*(-(((2*(1 - f(0) - f(1))*(2*(-1 + p)*(1 + c/2. - v/2.) + 2*d*(-1 + p)*(1 + c/2. - v/2.)*(-f(0) - f(1)) + d*(-1 + p)*f(1)) - f(1)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - (2*(1 - f(0) - f(1))*(2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(-1 + p)*(1 - v)*f(1)) - 2*f(0)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.)))*(2*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - 2*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))) + (-2*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)*(2*(1 - f(0) - f(1))*(2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(-1 + p)*(1 - v)*f(1)) - 2*f(0)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1))) + 2*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)))*((-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))*(-(f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))) + 2*(1 - f(0) - f(1))*(1 + p - (-2 + 2*p)*(1 - v) - 2*d*(-1 + p)*(1 - v)*f(0) + d*(-1 + p)*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)) + d*(1 - v)*(-2 + 2*p - 2*(-1 + p)*(1 - f(0) - f(1)) - (-2 + 2*p)*f(1)))) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))))/(-(((2*(1 - f(0) - f(1))*(2*(-1 + p)*(1 + c/2. - v/2.) + 2*d*(-1 + p)*(1 + c/2. - v/2.)*(-f(0) - f(1)) + d*(-1 + p)*f(1)) - f(1)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - (2*(1 - f(0) - f(1))*(2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(-1 + p)*(1 - v)*f(1)) - 2*f(0)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.)))*((2*(-(p*(1 - v)) - 2*d*p*(1 - v/2.)*f(0) - d*p*(1 - v)*(-1 + f(1)))*(1 - f(0) - f(1)) - f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + (d*p*(1 - v)*f(1))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))) + (-((-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + (d*p*(1 - v)*f(1))/2.))*(2*(1 - f(0) - f(1))*(2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(-1 + p)*(1 - v)*f(1)) - 2*f(0)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))) + (-(f(1)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1))) + 2*(1 - f(0) - f(1))*(2*(-1 + p)*(1 + c/2. - v/2.) - 2*d*p*(1 - v/2.)*f(0) + 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(-1 + p)*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*(1 - v)*f(1) + d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)))*((-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))*(-(f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))) + 2*(1 - f(0) - f(1))*(1 + p - (-2 + 2*p)*(1 - v) - 2*d*(-1 + p)*(1 - v)*f(0) + d*(-1 + p)*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)) + d*(1 - v)*(-2 + 2*p - 2*(-1 + p)*(1 - f(0) - f(1)) - (-2 + 2*p)*f(1)))) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1))))));

double vd_0_tplus1 = (-2*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.))/(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) + ((-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.))*(2*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - 2*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1))))))/((-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))*((-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))*(-(f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))) + 2*(1 - f(0) - f(1))*(1 + p - (-2 + 2*p)*(1 - v) - 2*d*(-1 + p)*(1 - v)*f(0) + d*(-1 + p)*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)) + d*(1 - v)*(-2 + 2*p - 2*(-1 + p)*(1 - f(0) - f(1)) - (-2 + 2*p)*f(1)))) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))) + (((-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + (d*p*(1 - v)*f(1))/2.))/(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - ((-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.))*((2*(-(p*(1 - v)) - 2*d*p*(1 - v/2.)*f(0) - d*p*(1 - v)*(-1 + f(1)))*(1 - f(0) - f(1)) - f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + (d*p*(1 - v)*f(1))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1))))))/((-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))*((-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))*(-(f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))) + 2*(1 - f(0) - f(1))*(1 + p - (-2 + 2*p)*(1 - v) - 2*d*(-1 + p)*(1 - v)*f(0) + d*(-1 + p)*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)) + d*(1 - v)*(-2 + 2*p - 2*(-1 + p)*(1 - f(0) - f(1)) - (-2 + 2*p)*f(1)))) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))))*(-(((2*(1 - f(0) - f(1))*(2*(-1 + p)*(1 + c/2. - v/2.) + 2*d*(-1 + p)*(1 + c/2. - v/2.)*(-f(0) - f(1)) + d*(-1 + p)*f(1)) - f(1)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - (2*(1 - f(0) - f(1))*(2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(-1 + p)*(1 - v)*f(1)) - 2*f(0)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.)))*(2*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - 2*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))) + (-2*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)*(2*(1 - f(0) - f(1))*(2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(-1 + p)*(1 - v)*f(1)) - 2*f(0)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1))) + 2*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)))*((-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))*(-(f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))) + 2*(1 - f(0) - f(1))*(1 + p - (-2 + 2*p)*(1 - v) - 2*d*(-1 + p)*(1 - v)*f(0) + d*(-1 + p)*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)) + d*(1 - v)*(-2 + 2*p - 2*(-1 + p)*(1 - f(0) - f(1)) - (-2 + 2*p)*f(1)))) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))))/(-(((2*(1 - f(0) - f(1))*(2*(-1 + p)*(1 + c/2. - v/2.) + 2*d*(-1 + p)*(1 + c/2. - v/2.)*(-f(0) - f(1)) + d*(-1 + p)*f(1)) - f(1)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - (2*(1 - f(0) - f(1))*(2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(-1 + p)*(1 - v)*f(1)) - 2*f(0)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.)))*((2*(-(p*(1 - v)) - 2*d*p*(1 - v/2.)*f(0) - d*p*(1 - v)*(-1 + f(1)))*(1 - f(0) - f(1)) - f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + (d*p*(1 - v)*f(1))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))) + (-((-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + (d*p*(1 - v)*f(1))/2.))*(2*(1 - f(0) - f(1))*(2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(-1 + p)*(1 - v)*f(1)) - 2*f(0)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))) + (-(f(1)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1))) + 2*(1 - f(0) - f(1))*(2*(-1 + p)*(1 + c/2. - v/2.) - 2*d*p*(1 - v/2.)*f(0) + 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(-1 + p)*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*(1 - v)*f(1) + d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)))*((-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))*(-(f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))) + 2*(1 - f(0) - f(1))*(1 + p - (-2 + 2*p)*(1 - v) - 2*d*(-1 + p)*(1 - v)*f(0) + d*(-1 + p)*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)) + d*(1 - v)*(-2 + 2*p - 2*(-1 + p)*(1 - f(0) - f(1)) - (-2 + 2*p)*f(1)))) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1))))));

double vd_1_tplus1 = -((2*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - 2*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))/((-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))*(-(f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))) + 2*(1 - f(0) - f(1))*(1 + p - (-2 + 2*p)*(1 - v) - 2*d*(-1 + p)*(1 - v)*f(0) + d*(-1 + p)*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)) + d*(1 - v)*(-2 + 2*p - 2*(-1 + p)*(1 - f(0) - f(1)) - (-2 + 2*p)*f(1)))) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))) + (((2*(-(p*(1 - v)) - 2*d*p*(1 - v/2.)*f(0) - d*p*(1 - v)*(-1 + f(1)))*(1 - f(0) - f(1)) - f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + (d*p*(1 - v)*f(1))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))*(-(((2*(1 - f(0) - f(1))*(2*(-1 + p)*(1 + c/2. - v/2.) + 2*d*(-1 + p)*(1 + c/2. - v/2.)*(-f(0) - f(1)) + d*(-1 + p)*f(1)) - f(1)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - (2*(1 - f(0) - f(1))*(2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(-1 + p)*(1 - v)*f(1)) - 2*f(0)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.)))*(2*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - 2*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))) + (-2*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)*(2*(1 - f(0) - f(1))*(2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(-1 + p)*(1 - v)*f(1)) - 2*f(0)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1))) + 2*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)))*((-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))*(-(f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))) + 2*(1 - f(0) - f(1))*(1 + p - (-2 + 2*p)*(1 - v) - 2*d*(-1 + p)*(1 - v)*f(0) + d*(-1 + p)*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)) + d*(1 - v)*(-2 + 2*p - 2*(-1 + p)*(1 - f(0) - f(1)) - (-2 + 2*p)*f(1)))) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))))/(((-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))*(-(f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))) + 2*(1 - f(0) - f(1))*(1 + p - (-2 + 2*p)*(1 - v) - 2*d*(-1 + p)*(1 - v)*f(0) + d*(-1 + p)*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)) + d*(1 - v)*(-2 + 2*p - 2*(-1 + p)*(1 - f(0) - f(1)) - (-2 + 2*p)*f(1)))) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))*(-(((2*(1 - f(0) - f(1))*(2*(-1 + p)*(1 + c/2. - v/2.) + 2*d*(-1 + p)*(1 + c/2. - v/2.)*(-f(0) - f(1)) + d*(-1 + p)*f(1)) - f(1)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - (2*(1 - f(0) - f(1))*(2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(-1 + p)*(1 - v)*f(1)) - 2*f(0)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.)))*((2*(-(p*(1 - v)) - 2*d*p*(1 - v/2.)*f(0) - d*p*(1 - v)*(-1 + f(1)))*(1 - f(0) - f(1)) - f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + (d*p*(1 - v)*f(1))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))) + (-((-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + (d*p*(1 - v)*f(1))/2.))*(2*(1 - f(0) - f(1))*(2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(-1 + p)*(1 - v)*f(1)) - 2*f(0)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))) + (-(f(1)*(-4*(-1 + p)*(1 + c/2. - v/2.) - 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(1 + c/2. - v/2.)*(-f(0) - f(1)) - 4*d*p*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*f(1) - d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1))) + 2*(1 - f(0) - f(1))*(2*(-1 + p)*(1 + c/2. - v/2.) - 2*d*p*(1 - v/2.)*f(0) + 2*d*(-1 + p)*(1 + c/2. - v/2.)*f(0) + 2*d*(-1 + p)*(1 + c/2. - v/2.)*(-f(0) - f(1)) - d*p*(1 - v)*f(1) + d*(-2 + 2*p)*(1 + c/2. - v/2.)*f(1)))*(-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.)))*((-2*f(0)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.) + 2*(1 - f(0) - f(1))*(-2*p*(1 - v/2.) + (d*(1 - v)*f(1))/2. - (d*p*(1 - v)*f(1))/2. + (d*(1 - v/2.)*(-2 + 4*p - (-2 + 4*p)*f(0) - 2*p*(1 - f(0) - f(1)) - 2*p*f(1)))/2.))*(-(f(1)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)))) + 2*(1 - f(0) - f(1))*(1 + p - (-2 + 2*p)*(1 - v) - 2*d*(-1 + p)*(1 - v)*f(0) + d*(-1 + p)*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1)) + d*(1 - v)*(-2 + 2*p - 2*(-1 + p)*(1 - f(0) - f(1)) - (-2 + 2*p)*f(1)))) - (-(f(1)*(d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*p*f(1))/2.)) + 2*(1 - f(0) - f(1))*(p*(1 - v/2.) + d*p*(1 - v/2.)*(-1 + f(0)) + d*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) - d*p*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + (d*f(1))/2. - (d*p*f(1))/2. + (d*(1 - v/2.)*(2*p*(1 - f(0) - f(1)) + 2*p*f(1)))/2.))*(-2*f(0)*(-p - d*p*(-1 + 2*(1 + c/2. - v/2.)*(1 - f(0) - f(1)) + f(1))) + 2*(1 - f(0) - f(1))*((-3 + 3*p)*(1 - v) + 2*d*(-1 + p)*(1 - v)*f(0) + 2*d*(-1 + p)*(1 - v/2.)*f(0) + d*(1 - v)*(3 - 3*p + 2*(-1 + p)*(1 - f(0) - f(1)) + (-3 + 3*p)*f(1)))))));

gsl_vector_set(f, 0, vh_1_tplus1);
gsl_vector_set(f, 1, vh_2_tplus1);
gsl_vector_set(f, 2, vd_0_tplus1);
gsl_vector_set(f, 3, vd_1_tplus1);